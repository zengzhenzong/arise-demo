---
collection_products:
  limit: {{ multiply section.settings.products_num 1 }}
all_collections:
  need_first_product: false
---
{{#if request.document_direction '===' 'rtl'}}
  {{ combine_asset_tag 'stage/featured-collection/index.rtl.css' inline=true}}
{{else}}
  {{ combine_asset_tag 'stage/featured-collection/index.css' inline=true}}
{{/if}}
<!-- stage/featured-collection/index.js -->
  {{#if request.document_direction '===' 'rtl'}}
    {{ combine_asset_tag 'vendors/@yy_sl-theme-shared.min.rtl.css' inline=true }}
    {{ combine_asset_tag 'vendors/swiper.min.rtl.css' inline=true }}
    {{ combine_asset_tag 'vendors/@sl_cart.min.rtl.css' inline=true }}
  {{else}}
    {{ combine_asset_tag 'vendors/@yy_sl-theme-shared.min.css' inline=true }}
    {{ combine_asset_tag 'vendors/swiper.min.css' inline=true }}
    {{ combine_asset_tag 'vendors/@sl_cart.min.css' inline=true }}
  {{/if}}
  {{ combine_asset_tag 
    'vendors/eventemitter3.min.js'
    'vendors/uuid.min.js'
    'vendors/lodash.min.js'
    'vendors/@sl_currency-tools-core.min.js'
    'vendors/@yy_sl-theme-shared.min.js'
    'vendors/url.min.js'
    'vendors/query-string.min.js'
    'vendors/swiper.min.js'
    'vendors/photoswipe.min.js'
    'vendors/yt-player.min.js'
    'vendors/scroll-lock.min.js'
    'vendors/debug.min.js'
    'vendors/axios.min.js'
    'vendors/js-cookie.min.js'
    'vendors/@sl_pay-button.min.js'
    'vendors/@yy_sl-ec-tracker.min.js'
    'vendors/@sl_cart.min.js'
    'vendors/@funnyecho_hamon.min.js'
    'vendors/@yy_sl-mc.min.js'
    'vendors/querystring.min.js'
    type="text/javascript"
    defer=true
  }}
  {{ combine_asset_tag 
    'theme-shared/utils/sectionsLoad/index.js'
    'commons/utils/isMobile.js'
    'theme-shared/utils/event-bus.js'
    'theme-shared/utils/parsePathToArray.js'
    'theme-shared/utils/state-selector.js'
    'theme-shared/utils/report/page.js'
    'theme-shared/utils/report/tool.js'
    'theme-shared/report/common/baseReport.js'
    'theme-shared/report/product/utils/index.js'
    'theme-shared/utils/newCurrency/CurrencyConvert.js'
    'theme-shared/utils/newCurrency/index.js'
    'theme-shared/utils/currency/getCurrencyCode.js'
    'theme-shared/report/stage/const.js'
    'theme-shared/utils/syntax-patch.js'
    'theme-shared/report/product/product-item.js'
    'theme-shared/utils/i18n.js'
    'theme-shared/utils/report/pageMapping.js'
    'theme-shared/events/utils/api-logger.js'
    'theme-shared/events/product/quickView-click/index.js'
    'theme-shared/utils/img-size.js'
    'theme-shared/components/hbs/productImages/js/product-photoSwipeHtml.js'
    'theme-shared/components/hbs/shared/utils/imgUrl.js'
    'theme-shared/components/hbs/shared/utils/getYouTubeCover.js'
    'theme-shared/utils/lozad/util.js'
    'theme-shared/utils/lozad/plugins/normal.js'
    'theme-shared/utils/lozad/plugins/image-gif-poster.js'
    'theme-shared/components/hbs/productImages/js/index.js'
    'theme-shared/components/hbs/shared/utils/bem.js'
    'theme-shared/components/hbs/shared/components/modal/common.js'
    'theme-shared/components/hbs/shared/components/modal/lite.js'
    'commons/components/modal/lite.js'
    'theme-shared/components/hbs/shared/base/BaseClass.js'
    'theme-shared/components/hbs/shared/components/modal/full.js'
    'commons/components/modal/full.js'
    'commons/components/modal/index.js'
    'theme-shared/components/hbs/shared/components/toast/toast.js'
    'commons/components/toast/toast.js'
    'theme-shared/components/hbs/shared/components/toast/loading.js'
    'commons/components/toast/loading.js'
    'commons/components/toast/index.js'
    'theme-shared/utils/sku/DataWatcher.js'
    'theme-shared/events/product/sku-change/index.js'
    'theme-shared/events/product/sku-changed/index.js'
    'theme-shared/events/product/preview-init/index.js'
    'theme-shared/components/hbs/shared/components/toast/index.js'
    'theme-shared/components/hbs/flashSale/index.js'
    'product/commons/js/sku-stepper.js'
    'commons/utils/convertPrice.js'
    'product/detail/js/product-quantity.js'
    'theme-shared/utils/get-env.js'
    'theme-shared/utils/createLogger.js'
    'theme-shared/utils/request.js'
    'theme-shared/utils/retryRequest.js'
    'theme-shared/utils/url-adaptor.js'
    'theme-shared/utils/report/const.js'
    'theme-shared/utils/dataReport/tool.js'
    'theme-shared/utils/dataReport/ga.js'
    'theme-shared/utils/dataReport/gad.js'
    'theme-shared/utils/dataReport/fb.js'
    'theme-shared/utils/tradeReport/index.js'
    'theme-shared/components/smart-payment/constants.js'
    'theme-shared/const/preload-state-fields.js'
    'theme-shared/components/smart-payment/utils.js'
    'theme-shared/utils/tradeReport/const.js'
    'theme-shared/utils/dataAccessor.js'
    'theme-shared/utils/url.js'
    'theme-shared/utils/constant.js'
    'theme-shared/utils/checkout.js'
    'theme-shared/components/hbs/products/checkedEvent/index.js'
    'theme-shared/components/smart-payment/services.js'
    'theme-shared/components/smart-payment/reporter/constants.js'
    'theme-shared/components/smart-payment/reporter/CheckoutHiidoReportV2.js'
    'theme-shared/components/smart-payment/reporter/ThirdPartReport.js'
    'theme-shared/components/locales/index.js'
    'theme-shared/components/smart-payment/index.js'
    'theme-shared/components/payment-button/constants.js'
    'theme-shared/components/payment-button/utils.js'
    'theme-shared/components/payment-button/express_checkout.js'
    'theme-shared/components/smart-payment/payments.js'
    'theme-shared/events/product/paypal-fallback/index.js'
    'theme-shared/components/pay-button/constants.js'
    'theme-shared/components/pay-button/utils.js'
    'theme-shared/components/pay-button/payment-button/utils.js'
    'theme-shared/components/pay-button/payment-button/constants.js'
    'theme-shared/components/pay-button/payment-button/index.js'
    'theme-shared/events/trade/interior-event/index.js'
    'theme-shared/events/trade/enum/index.js'
    'theme-shared/events/trade/developer-api/cart-sidebar-render/index.js'
    'theme-shared/utils/tradeReport/hdReportV2.js'
    'theme-shared/utils/tradeReport/eventListen.js'
    'theme-shared/components/hbs/shared/components/topDrawer/const.js'
    'theme-shared/components/hbs/shared/components/drawer/const.js'
    'commons/logger/index.js'
    'commons/utils/throttle.js'
    'commons/utils/main.js'
    'commons/utils/helper.js'
    'commons/utils/index.js'
    'cart/script/biz/sticky-cart/helper.js'
    'cart/script/report/cartReport.js'
    'cart/script/biz/sticky-cart/index.js'
    'cart/script/domain/adapter/svc/internal/config.js'
    'cart/script/domain/adapter/svc/internal/transport.js'
    'cart/script/domain/adapter/svc/index.js'
    'cart/script/domain/adapter/storage/constant.js'
    'cart/script/domain/adapter/storage/index.js'
    'cart/script/utils/event-bus/index.js'
    'cart/script/domain/adapter/svc/internal/constant.js'
    'cart/script/domain/adapter/svc/cart.js'
    'cart/script/domain/adapter/svc/voucher.js'
    'cart/script/domain/adapter/svc/coupon.js'
    'cart/script/domain/model/helpers.js'
    'cart/script/domain/adapter/svc/order.js'
    'cart/script/constant/responseCode.js'
    'cart/script/constant/cartQuantity.js'
    'cart/script/domain/model/cart.js'
    'cart/script/constant/stockType.js'
    'cart/script/domain/vo/productStock.js'
    'cart/script/constant/priceType.js'
    'cart/script/domain/vo/productPriceType.js'
    'cart/script/utils/object.js'
    'cart/script/domain/model/cartItem.js'
    'cart/script/domain/vo/responseCode.js'
    'cart/script/domain/model/response.js'
    'cart/script/domain/model/promotionCode.js'
    'theme-shared/biz-com/trade/optimize-modal/constant.js'
    'theme-shared/biz-com/trade/optimize-modal/cartChangeItem.js'
    'cart/script/domain/vo/productVerifyType.js'
    'cart/script/domain/model/cartVerifyItem.js'
    'cart/script/service/cart/hooks.js'
    'cart/script/service/cart/service.js'
    'cart/script/service/cart/index.js'
    'cart/script/service/index.js'
    'commons/utils/dynamicImportMiniCart.js'
    'commons/cart/errorCode.js'
    'commons/cart/handleAddToCartErrorCodeToast.js'
    'commons/cart/globalEvent.js'
    'commons/utils/debounce.js'
    'theme-shared/components/payment-button/shopby_fast_checkout.js'
    'theme-shared/components/payment-button/index.js'
    'product/detail/js/payment_button.js'
    'theme-shared/report/product/add-to-cart.js'
    'product/detail/js/product-button-report.js'
    'product/detail/js/float-button.js'
    'product/detail/js/product-button.js'
    'product/commons/js/product-info.js'
    'product/detail/js/product-swiper.js'
    'product/detail/js/layout.js'
    'product/utils/sku/skuUtil.js'
    'product/utils/sku/skuFilter.js'
    'product/commons/js/sku-trade/base-sku-trade.js'
    'product/commons/js/sku-trade/sku-trade-flatten.js'
    'theme-shared/components/hbs/productImages/js/modal.js'
    'commons/components/modal/common.js'
    'product/commons/js/sku-trade/sku-trade-select.js'
    'product/detail/js/sku-trade.js'
    'theme-shared/utils/form/form.js'
    'theme-shared/utils/form/index.js'
    'theme-shared/utils/sku/firstAvailableSku.js'
    'theme-shared/report/customArgs/index.js'
    'theme-shared/report/product/detail/inquiry-modal-report.js'
    'commons/base/BaseClass.js'
    'product/detail/inquiry-price-modal.js'
    'product/commons/js/createShadowDom.js'
    'product/detail/js/tabs.js'
    'product/detail/js/product-collapse.js'
    'theme-shared/components/hbs/thirdPartyShare/js/index.js'
    'commons/thirdPartyShare/index.js'
    'commons/utils/url.js'
    'theme-shared/report/product/product-preview.js'
    'product/utils/nullishCoalescingOperator.js'
    'product/detail/js/product-preview.js'
    'product/commons/js/preview-modal/preview-modal.js'
    'product/commons/js/preview-modal/index.js'
    'theme-shared/report/product/product-quickAddCart.js'
    'product/commons/js/quick-add-modal.js'
    'product/commons/js/product-item.js'
    'stage/featured-collection/index.js'
    type="text/javascript"
    defer=true
  }}


{{ assign 'prefix' 'stage-featured-collection' }}

{{ assign 'productList' (get 'list' (get section.settings.product_categories collection_products)) }}
{{#if (boolean (isTruthy section.settings.product_categories) '&&' (boolean (length productList) '!=' 0))}}
  {{ assign 'categoryDetail' (get section.settings.product_categories all_collections) }}
  {{ assign 'forbiddenBtn' false }}
{{else}}
  {{ assign 'productList' (product_mock_data section.settings.products_num 1) }}
  {{ assign 'forbiddenBtn' true }}
{{/if}}


{{ assign 'real_product_img_width' (divide 1200 1) }}
{{#if request.is_mobile}}
  {{ assign 'real_product_img_width' 300 }}
{{/if}}

{{ assign 'settings' section.settings }}
{{ assign 'button_text' settings.button_text }}
{{ assign 'title' settings.title }}
{{ assign 'full_width' settings.full_width }}
{{ assign 'slice_in_pc' section.settings.slice_in_pc }}
{{ assign 'slice_in_mobile' settings.slice_in_mobile }}
{{ assign 'product_categories' settings.product_categories }}
{{ assign 'categoryDetail' (JSONparse '{}') }}
{{#if product_categories}}
  {{ assign 'categoryDetail' (get product_categories all_collections) }}
{{/if}}
{{ assign 'products_num' settings.products_num }}
{{ assign 'list' (sliceListByGrid productList settings.products_num 1) }}
{{ assign 'listLength' (length list) }}
{{ assign 'first_product' (get '0' list) }}
{{ assign 'sortationCoverImg' (get 'sortationCoverImg' categoryDetail) }}
{{ assign 'cover_img' (default (get 'image' first_product) '') }}
{{#if sortationCoverImg}}
  {{ assign 'cover_img' sortationCoverImg }}
{{/if}}
{{ assign 'showButton' (and (isTruthy button_text) (boolean listLength '>=' products_num)) }}
{{ assign 'url_cellections' (append '/collections/' (default categoryDetail.uniqueKey categoryDetail.sortationId)) }}

<script type="text/json" id="featuredCollection-data-{{ section.id }}">{{{ stringify section.settings }}}</script>

<div
  data-section-type="featured-collection"
  data-section-id="{{ section.id }}"
  class="__sl-custom-track-stage-featuredCollection {{ prefix }} {{ prefix }}-{{ section.id }}"
  data-slice_in_pc="{{ section.settings.slice_in_pc }}"
  data-slice_in_mobile="{{ section.settings.slice_in_mobile }}">
  <div class="{{#if (isFalsey full_width)}}container{{else}}container-sm container-pc-padding{{/if}} {{ prefix }}--container">
    {{#if title}}
      <h2 class="section-title title4 {{ prefix }}__title text-{{ section.settings.title_align }}">
        {{ title }}
      </h2>
    {{/if}}

    <div class="{{ prefix }}__list featured-collection-swiper-{{ section.id }} {{ prefix }}__swiper-box swiper-container">
      <div class="swiper-wrapper row row-cols-{{ section.settings.md_cols }} row-cols-md-{{ section.settings.pc_cols }} {{ prefix }}__list-container {{#if slice_in_mobile}} slice_in_mobile{{/if}}">
        {{#each list}}
          <div class="{{ ../prefix }}__item-wrap featured-collection-item-slide product-slide" {{{ this.shopline_attributes }}}>
            {{#if ../forbiddenBtn}}
              {{ snippet 'product/commons/product-item' moduleType='featured-collection' section=../section hoverZIndex=9 forbiddenBtn=../forbiddenBtn imgRealWidth=../real_product_img_width backgroundColor='#f3f3f3' }}
            {{else}}
              {{ snippet 'product/commons/product-item' moduleType='featured-collection' section=../section hoverZIndex=9 forbiddenBtn=../forbiddenBtn imgRealWidth=../real_product_img_width }}
            {{/if}}
          </div>
        {{/each}}
        {{#and slice_in_mobile section.settings.button_follow_endof_list showButton}}
          <li class="{{ prefix }}__item-wrap featured-collection-item-slide product-slide d-md-none">
            <a
              href="{{ url_cellections }}"
              class="{{ prefix }}__mb-view-all">
              <span class="mb-view-all__icon">
                {{ snippet 'icons/icon_strong_arrow_r' }}
              </span>
              <span class="mb-view-all__text body3 fw-bold">
                {{ button_text }}
              </span>
            </a>
          </li>
        {{/and}}
      </div>
      {{#if slice_in_pc}}
        <div id="swiper-button-prev-{{ section.id }}" class="{{ prefix }}__arrow {{ prefix }}__arrow--left d-none d-md-flex">
          {{ snippet 'icons/icon_strong_arrow_r' class='mobile-nav__icon' }}
        </div>
        <div id="swiper-button-next-{{ section.id }}" class="{{ prefix }}__arrow {{ prefix }}__arrow--right d-none d-md-flex">
          {{ snippet 'icons/icon_strong_arrow_r' class='mobile-nav__icon' }}
        </div>
      {{/if}}
    </div>
  </div>
  {{#if showButton}}
    <div class="{{ prefix }}__action-wrap {{#and slice_in_mobile section.settings.button_follow_endof_list}}d-none d-md-flex{{/and}}">
      <a class="btn btn-primary" href="{{ redirect_to url_cellections }}">
        {{ button_text }}
      </a>
    </div>
  {{/if}}
</div>
{{#schema}}
{
  "name": "t:sections.featured-collection.name",
  "limit": 10,
  "class": "section-gap",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "t:sections.featured-collection.settings.title.label",
      "default": "Featured collection"
    },
    {
      "id": "title_align",
      "type": "text_align",
      "label": "t:sections.featured-collection.settings.title_align.label",
      "default": "center"
    },
    {
      "type": "switch",
      "id": "full_width",
      "label": "t:sections.featured-collection.settings.full_width.label",
      "default": false
    },
    {
      "id": "product_categories",
      "type": "collection_picker",
      "label": "t:sections.featured-collection.settings.product_categories.label",
      "default": ""
    },
    {
      "type": "group_header",
      "label": "t:sections.featured-collection.settings.group_header__0.label"
    },
    {
      "id": "products_num",
      "type": "range",
      "label": "t:sections.featured-collection.settings.products_num.label",
      "min": 2,
      "max": 24,
      "step": 1,
      "default": 4
    },
    {
      "id": "pc_cols",
      "type": "range",
      "label": "t:sections.featured-collection.settings.pc_cols.label",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 4
    },
    {
      "id": "md_cols",
      "type": "select",
      "label": "t:sections.featured-collection.settings.md_cols.label",
      "options": [
        {
          "value": 1,
          "label": "t:sections.featured-collection.settings.md_cols.options__0.label"
        },
        {
          "value": 2,
          "label": "t:sections.featured-collection.settings.md_cols.options__1.label"
        }
      ],
      "default": 2
    },
    {
      "type": "switch",
      "id": "slice_in_pc",
      "label": "t:sections.featured-collection.settings.slice_in_pc.label",
      "default": false
    },
    {
      "id": "slice_in_mobile",
      "type": "switch",
      "label": "t:sections.featured-collection.settings.slice_in_mobile.label",
      "default": true
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "t:sections.featured-collection.settings.button_text.label",
      "info": "t:sections.featured-collection.settings.button_text.info",
      "default": "View all"
    },
    {
      "type": "switch",
      "id": "button_follow_endof_list",
      "label": "t:sections.featured-collection.settings.button_follow_endof_list.label",
      "default": false
    },
    {
      "type": "group_header",
      "label": "t:sections.featured-collection.settings.group_header__1.label"
    },
    {
      "id": "product_image_ratio",
      "type": "select",
      "label": "t:sections.featured-collection.settings.product_image_ratio.label",
      "options": [
        {
          "value": "0",
          "label": "t:sections.featured-collection.settings.product_image_ratio.options__0.label"
        },
        {
          "value": "100",
          "label": "t:sections.featured-collection.settings.product_image_ratio.options__1.label"
        },
        {
          "value": "133.33",
          "label": "3:4"
        },
        {
          "value": "75",
          "label": "t:sections.featured-collection.settings.product_image_ratio.options__3.label"
        },
        {
          "value": "150",
          "label": "t:sections.featured-collection.settings.product_image_ratio.options__4.label"
        }
      ],
      "default": "0"
    },
    {
      "id": "product_fill_type",
      "type": "select",
      "label": "t:sections.featured-collection.settings.product_fill_type.label",
      "options": [
        {
          "value": "contain",
          "label": "t:sections.featured-collection.settings.product_fill_type.options__0.label"
        },
        {
          "value": "cover",
          "label": "t:sections.featured-collection.settings.product_fill_type.options__1.label"
        }
      ],
      "default": "contain"
    },
    {
      "id": "product_hover_show_next",
      "type": "switch",
      "label": "t:sections.featured-collection.settings.product_hover_show_next.label",
      "default": false
    }
  ],
  "presets": [
    {
      "name": "t:sections.featured-collection.presets.presets__0.name",
      "category_index": 1,
      "category": "t:sections.featured-collection.presets.presets__0.category",
      "settings": {
        "title": "Featured collection",
        "title_align": "center",
        "full_width": false,
        "product_categories": "",
        "products_num": 4,
        "pc_cols": 4,
        "md_cols": 2,
        "slice_in_pc": false,
        "slice_in_mobile": true,
        "button_text": "View all",
        "product_image_ratio": "0",
        "product_fill_type": "contain",
        "product_hover_show_next": false
      }
    }
  ]
}
{{/schema}}

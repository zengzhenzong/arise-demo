!function(){"use strict";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var e,t,i={exports:{}};e=function(){n="/* FIXME: 命名空间 */\n#__previewImage-container {\n  -ms-touch-action: none;\n  touch-action: none;\n  -webkit-touch-action: none;\n  background: rgba(0, 0, 0, 0.5);\n  height: 100%;\n  width: 100%;\n  position: fixed;\n  overflow: hidden;\n  top: 0;\n  left: 0;\n  user-select: none;\n}\n#__previewImage-container .previewImage-controlBox {\n  position: absolute;\n  width: 0;\n  height: 0;\n  left: 50%;\n  bottom: 90px;\n  z-index: 100;\n}\n#__previewImage-container .previewImage-controlBox img {\n  width: 10px;\n}\n\n#__previewImage-container .previewImage-controlClose,\n#__previewImage-container .previewImage-controlPrev,\n#__previewImage-container .previewImage-controlNext {\n  position: absolute;\n  transform: translate(-50%, -50%);\n\n  border-radius: 50%;\n  background: #ffffff;\n  border: 1.2px solid #e8e8e1;\n  box-sizing: border-box;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n#__previewImage-container .previewImage-controlClose {\n  width: 60px;\n  height: 60px;\n}\n#__previewImage-container .previewImage-controlPrev,\n#__previewImage-container .previewImage-controlNext {\n  width: 50px;\n  height: 50px;\n}\n#__previewImage-container .previewImage-controlPrev {\n  margin-left: -75px;\n}\n#__previewImage-container .previewImage-controlNext {\n  margin-left: 75px;\n}\n\n#__previewImage-container .previewImage-text {\n  position: absolute;\n  top: 0.6em;\n  text-align: center;\n  font-size: 18px;\n  line-height: 25px;\n  color: #fff;\n  z-index: 10;\n  padding: 0.2em 0.4em;\n  background-color: rgba(255, 255, 255, 0.4);\n  border-radius: 50%;\n  letter-spacing: 0;\n  right: 0.8em;\n}\n#__previewImage-container .previewImage-text .previewImage-text-index {\n  font-size: 24px;\n}\n#__previewImage-container .previewImage-box {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  cursor: grab;\n}\n#__previewImage-container .previewImage-box .previewImage-item {\n  height: 100%;\n  /* FIXME:可配置 */\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-shrink: 0;\n  /* FIXME: 添加过渡？ */\n  /* FIXME:背景可配置 */\n}\n",r=(a=void 0===a?{}:a).insertAt,n&&"undefined"!=typeof document&&(o=document.head||document.getElementsByTagName("head")[0],(a=document.createElement("style")).type="text/css","top"===r&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=n:a.appendChild(document.createTextNode(n)));var e={};function t(e,t){e.style.bottom=t<600?"75px":"90px"}function i(e,t,i){var n,a,o,r,s;i&&t||console.error("非法的viewportHeight或viewportWidth"),e&&(r=n=e.naturalWidth,s=a=e.naturalHeight,(o=n/a)<t/i?i<a&&(r=o*(s=i)):t<n&&(s=(r=t)/o),e.style.width=r+"px",e.style.height=s+"px")}e.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)},e.all=function(e,t){var e=(t||document).querySelectorAll(e);return e&&0<e.length?Array.prototype.slice.call(e):[]},e.delegate=function(t,i,n,a,o){t&&t.addEventListener(i,function(i){o(i);var r=e.all(n,t);if(r)for(var s=0;s<r.length;s++)for(var h=i.target;h;){if(h==r[s]){a.call(h,i);break}if((h=h.parentNode)==t)break}},!1)};var n,a,o,r,s,h=function(){var n;function a(){var e,t;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,a),t=function(e,t){return e=Math.sqrt(Math.pow(e.x1-e.x0,2)+Math.pow(e.y1-e.y0,2)),Math.sqrt(Math.pow(t.x1-t.x0,2)+Math.pow(t.y1-t.y0,2))/e},(e="getScale")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t,this.winw=window.innerWidth,this.winh=window.innerHeight,this.marginRight=0,this.imageChageMoveX=this.marginRight+this.winw,this.imageChageNeedX=Math.floor(.5*this.winw),this.cssprefix=["","webkit","Moz","ms","o"],this.scale=1,this.maxScale=4,this.maxOverScale=6,this.openTime=0,this.slipTime=.5,this.maxOverWidthPercent=.5,this.$box,this.isPreview=!1,this.zIndex="10000",this.$container=document.createElement("div"),this.$container.id="__previewImage-container",this.$container.style.display="none",document.body.appendChild(this.$container),this.bind()}return n=[{key:"bind",value:function(){function t(e){r.touchEndFun.call(r,e)}function i(e){r.stopPropagation&&e.stopPropagation()}var n,a=this,o=this.$container,r=this;window.addEventListener("resize",function(){a.isPreview&&(a.swiping=!0,a.trackStyle(),a.winw=a.$container.offsetWidth,a.winh=a.$container.offsetHeight,a.imageChageMoveX=a.marginRight+a.winw,a.move({pace:0}),a.fixImgs(a.winw,a.winh),n&&clearTimeout(n),n=setTimeout(function(){a.swiping=!1,a.trackStyle()},100))}),e.delegate(o,"click",".previewImage-item",function(e){r.closePreview.call(r,e)},i),e.delegate(o,"touchstart",".previewImage-item",function(e){r.touchStartFun.call(r,e)},i),e.delegate(o,"touchmove",".previewImage-item",function(e){r.touchMoveFun.call(r,e)},i),e.delegate(o,"touchend",".previewImage-item",t,i),e.delegate(o,"touchcancel",".previewImage-item",t,i)}},{key:"fixImgs",value:function(e,n){var a=this;this.imgStatusCache.forEach(function(o){var r;(r=o.swiperItemEl)&&(r.style.width=e+"px",r.style.height=n+"px"),i(o.$img,e,n),t(a.$controlBox,e)})}},{key:"start",value:function(t){this.$container.innerHTML="",this.$container.style.display="block",this.winw=this.$container.offsetWidth,this.winh=this.$container.offsetHeight,this.imageChageMoveX=this.winw+this.marginRight,this.stopPropagation=void 0===t.stopPropagation||t.stopPropagation,this.$container.style.zIndex=this.zIndex=String(("number"==typeof t.zIndex?t:this).zIndex),this.container={elem:this.$container};var i=t.urls,t=t.current;if(!i||!e.isArray(i)||0==i.length)throw Error("urls must be a Array and the minimum length more than zero");t?((t=i.indexOf(t))<0&&(t=0,console.warn("current isnot on urls,it will be the first value of urls!")),this.index=t):(this.index=0,console.warn("current is empty,it will be the first value of urls!")),this.urls=i,this.maxLen=i.length,this.maxIndexLen=i.length-1,this.imgStatusCache=[],i=this.renderControl(),this.$container.appendChild(i),this.render()}},{key:"renderControl",value:function(){var e=this,i=this.urls.length,n=document.createElement("div");n.className+="previewImage-controlBox";var a=document.createElement("div");a.className+="previewImage-controlClose",a.addEventListener("click",function(){e.closePreview()});var o,r=document.createElement("img");return r.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACmSURBVHgBzdVbCsMwDETRoSvVTjw7TykkUAxK9RiFXvCPMTofwTHwB9m5Hp3/2TjOtaBvfc03D1bja5tt+wEO4DtK7yCFeBhV4mlUgZfRDt5GK7gMzeByNIKPoXf4OOrhj6B3OJHshXxHcE/a/k2rP5kWSsw8LD/RqzE8cmWoxjP3lCo8g8rwCtrGO2gZV6BpXImGcRtAPdw8mNBHD75ww1yG2fmx3jmDwkeCOnZAAAAAAElFTkSuQmCC",a.appendChild(r),1<i&&((o=document.createElement("div")).className+="previewImage-controlPrev",o.addEventListener("click",function(){console.log("controlPrev"),e.changeIndex(-1)}),(r=document.createElement("img")).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACASURBVHgB7di7DYRAEATRuovoMj0yoDPlI4HA2EWDgRqjSxpn13kac+DZftu8onGZaZs/5s6YfWybamFsoB5mwFAPIwwFE0wwwQQTjAvzvfj7dN4njIn2lkaMiaBqiaBqiaBqiaBqiaBqiaBqiTbKeicSLwOtDRwYy/Wj1e2T3gxVNsVHiu6XtwAAAABJRU5ErkJggg==",o.appendChild(r),(i=document.createElement("div")).className+="previewImage-controlNext",i.addEventListener("click",function(){console.log("controlNext"),e.changeIndex(1)}),(r=document.createElement("img")).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAB5SURBVHgB7dhLCoAwEATR0hPlpnoD+6Z+QBHBwLgIE6QLepPVI8uBb5VzXTTtW89NJFe4MdcWEnsDpaOEUbGEUbGEUbGEUbGEUbGEUbHEH1AjbVsr7wMJHb/w9jsiIWOMMcYYY4zhef1Ix5SeMDWQSG6mI8xV85PeBqVTxUftS/kNAAAAAElFTkSuQmCC",i.appendChild(r),n.appendChild(o),n.appendChild(i)),n.appendChild(a),t(n,this.winw),this.$controlBox=n}},{key:"render",value:function(){var e=this;this.$box=null,this.box=null;var t=document.createElement("div");t.className+="previewImage-box",t.style.width=this.maxLen*this.winw+"px",this.$box=t,this.box={elem:this.$box,x:0,y:0,m:0,my:0,scale:1,scalem:1},this.urls.forEach(function(t,i){var n=document.createElement("div");n.style.width=e.winw+"px",n.style.marginRight=e.marginRight+"px",e.imgStatusCache[i]={index:i,hash:t,x:0,m:0,y:0,my:0,scale:e.scale,scalem:1,$img:null,isLoad:!1,swiperItemEl:n,setOffset:function(e){this.swiperItemEl.style.transform="translateX(".concat(e,"px)")}},n.className+=" previewImage-item",e.$box.appendChild(n)}),t=this.getVImgByIndex(this.fixIndex(this.index)),this.reachImg(t),this.$container.appendChild(this.$box),this.boxTransform=-this.imageChageMoveX*this.index,this.move({pace:0}),this.trackStyle(),this.isPreview=!0}},{key:"onImgLoad",value:function(e){e.isLoad=!0,i(e.$img,this.winw,this.winh)}},{key:"getVImgByIndex",value:function(e){return e=null==e?this.index:e,this.imgStatusCache[e]}},{key:"closePreview",value:function(){var e=this;setTimeout(function(){e.$container.style.display="none"},0),e.isPreview=!1}},{key:"trackStyle",value:function(){var e=this,t={transitionDuration:"".concat(this.swiping?0:300,"ms"),transform:"translateX(".concat(this.boxTransform,"px)")};return Object.keys(t).forEach(function(i){e.box.elem.style[i]=t[i]}),t}},{key:"correctPosition",value:function(){this.swiping=!0,this.trackStyle(),this.index<0?this.move({pace:this.maxLen}):this.index>this.maxIndexLen&&this.move({pace:-this.maxLen})}},{key:"fixIndex",value:function(e){return -1===e?this.maxIndexLen:e===this.maxIndexLen+1?0:e}},{key:"move",value:function(e){var t=e.pace,i=e.offset,n=void 0===i?0:i,i=e.emitChange;this.index,e=this.getTargetActive(void 0===t?0:t),t=this.getTargetOffset(e,n),this.imgStatusCache[0]&&(n=t<this.minOffset(),this.imgStatusCache[0].setOffset(n?this.trackSize():0)),this.imgStatusCache[this.maxIndexLen]&&this.imgStatusCache[this.maxIndexLen].setOffset(0<t?-this.trackSize():0),i&&this.reachImg(this.imgStatusCache[this.fixIndex(e)]),this.index=e,this.boxTransform=t,this.trackStyle()}},{key:"minOffset",value:function(){return this.winw-this.imageChageMoveX*this.maxLen}},{key:"trackSize",value:function(){return this.imageChageMoveX*this.maxLen}},{key:"getTargetOffset",value:function(e){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:0)-e*this.imageChageMoveX}},{key:"getTargetActive",value:function(e){var t=this.index;return e?Math.min(Math.max(t+e,-1),e=this.maxIndexLen+1):t}},{key:"touchStartFun",value:function(e){this.startX=e.touches[0].clientX,this.startY=e.touches[0].clientY,this.touchStartTime=Date.now(),this.correctPosition()}},{key:"touchMoveFun",value:function(e){var t,i;this.swiping&&(t=e.touches[0],this.deltaX=t.clientX<0?0:t.clientX-this.startX,this.deltaY=t.clientY-this.startY,this.offsetX=Math.abs(this.deltaX),this.offsetY=Math.abs(this.deltaY),this.direction||(this.direction=(t=this.offsetX,(i=this.offsetY)<t&&10<t?"horizontal":t<i&&10<i?"vertical":"")),"horizontal"===this.direction&&(i=e,e=this.stopPropagation,("boolean"!=typeof i.cancelable||i.cancelable)&&i.preventDefault(),e&&i.stopPropagation(),this.move({offset:this.deltaX})))}},{key:"getSlowlyNum",value:function(e,t){return t=t||this.winw*this.maxOverWidthPercent,e<0?-(1-(e=-e)/(t+e))*e:(1-e/(t+e))*e}},{key:"touchEndFun",value:function(e){var t;this.swiping&&(t=Date.now()-this.touchStartTime,(.25<Math.abs(t=this.deltaX/t)||Math.abs(this.deltaX)>this.imageChageMoveX/2)&&"horizontal"===this.direction?(t=(t=0)<this.offsetX?0<this.deltaX?-1:1:0,this.move({pace:t,emitChange:!0})):this.deltaX&&this.move({pace:0}),this.swiping=!1,this.trackStyle())}},{key:"changeIndex",value:function(e){var t=this;this.correctPosition(),this.move({pace:e,emitChange:!0}),setTimeout(function(){t.swiping=!1,t.trackStyle()},0)}},{key:"reachImg",value:function(e){this.loadImg(e);var t=e.index+1>this.maxIndexLen?0:e.index+1;t!==e.index&&(i=this.imgStatusCache[t],this.loadImg(i));var i=e.index-1<0?this.maxIndexLen:e.index-1;i!==e.index&&t!==i&&(i=this.imgStatusCache[i],this.loadImg(i))}},{key:"loadImg",value:function(e){var t,i=this;e.isLoad||(e.isLoad=!0,(t=new Image).className+="previewImage-image",(e.$img=t).onload=function(){i.onImgLoad.call(i,e)},t.src=e.hash,e.swiperItemEl.appendChild(t))}}],function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(a.prototype,n),a}();return function(e){(s||(s=new h)).start(e)}},i.exports=e();var n=(t=i.exports)&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;window["@yy/sl-pod-preview-image"]={default:n}}();

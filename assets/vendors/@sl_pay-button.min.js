!function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function t(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}function n(n){return function(t){if(Array.isArray(t))return e(t)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||t(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],s=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,n)||t(e,n)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function c(e){o(i,r,a,c,s,"next",e)}function s(e){o(i,r,a,c,s,"throw",e)}c(void 0)})}}function i(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===c(t)?t:String(t)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p,f,h,y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},m={exports:{}},g={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(g),function(e){var t=g.exports.default;function n(){e.exports=n=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var r={},o=Object.prototype,a=o.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var o,a,c=Object.create((t&&t.prototype instanceof y?t:y).prototype);return i(c,"_invoke",{value:(o=new k(r||[]),a="suspendedStart",function(t,r){if("executing"===a)throw Error("Generator is already running");if("completed"===a){if("throw"===t)throw r;return E()}for(o.method=t,o.arg=r;;){var i=o.delegate;if(i){var c=function e(t,n){var r=n.method,o=t.iterator[r];if(void 0===o)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=void 0,e(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+r+"' method")),h;var a=f(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,h):i:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,h)}(i,o);if(c){if(c===h)continue;return c}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===a)throw a="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);a="executing";var s=f(e,n,o);if("normal"===s.type){if(a=o.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:o.done}}"throw"===s.type&&(a="completed",o.method="throw",o.arg=s.arg)}})}),c}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=p;var h={};function y(){}function m(){}function g(){}var v={};d(v,s,function(){return this});var b=Object.getPrototypeOf,C=b&&b(b(I([])));C&&C!==o&&a.call(C,s)&&(v=C);var w=g.prototype=y.prototype=Object.create(v);function O(e){["next","throw","return"].forEach(function(t){d(e,t,function(e){return this._invoke(t,e)})})}function _(e,n){var r;i(this,"_invoke",{value:function(o,i){function c(){return new n(function(r,c){(function r(o,i,c,s){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==t(d)&&a.call(d,"__await")?n.resolve(d.__await).then(function(e){r("next",e,c,s)},function(e){r("throw",e,c,s)}):n.resolve(d).then(function(e){l.value=e,c(l)},function(e){return r("throw",e,c,s)})}s(u.arg)})(o,i,r,c)})}return r=r?r.then(c,c):c()}})}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:E}}function E(){return{value:void 0,done:!0}}return m.prototype=g,i(w,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:m,configurable:!0}),m.displayName=d(g,l,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,d(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},r.awrap=function(e){return{__await:e}},O(_.prototype),d(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,t,n,o,a){void 0===a&&(a=Promise);var i=new _(p(e,t,n,o),a);return r.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},O(w),d(w,l,"Generator"),d(w,s,function(){return this}),d(w,"toString",function(){return"[object Generator]"}),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},r.values=I,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),s=a.call(o,"finallyLoc");if(c&&s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},r}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(m);var v=m.exports();try{regeneratorRuntime=v}catch(e){"object"===("undefined"==typeof globalThis?"undefined":c(globalThis))?globalThis.regeneratorRuntime=v:Function("r","regeneratorRuntime = r")(v)}function b(e){return(b="function"==typeof Symbol&&"symbol"==c(Symbol.iterator)?function(e){return c(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":c(e)})(e)}var C,w,O,_=function(){return(_=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function S(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i}function P(e,t,n){if(n||2==arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}(k=C||(C={})).P0="P0",k.P1="P1",k.P2="P2",(I=w||(w={})).Start="Start",I.Success="Success",I.Failure="Failure",(E=O||(O={})).Info="info",E.Log="log",E.Warn="warn",E.Error="error";var k,I,E,x,T=function(e){return function(t,n,r){var o=r.value;r.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return o.apply(this,t)}catch(t){return window[window.__sl_console__?"__sl_console__":"console"].error("logger: ".concat(n,"方法执行出错"),t),e}}}},A=function(e){return e.reduce(function(e,t){var n={};try{n=t()}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("计算列表结果出错",e)}return _(_({},e),n)},{})},L=function(){function e(e){var t=this;this.options={owner:"",action:"",tags:{},getTagsFn:[],data:{},getDataFn:[],transports:[]},this.report=function(e,n,r){var o,a=A(t.options.getTagsFn),i=A(t.options.getDataFn),c=(null==r?void 0:r.errorLevel)&&r.errorLevel||null,s=_(_({level:e,owner:t.options.owner,action:t.options.action},r),{tags:_(_(_({},t.options.tags),a),{errorLevel:c}),data:_(_({},t.options.data),i),message:n});o=null==r?void 0:r.data,"[object Object]"===Object.prototype.toString.call(o)?s.data=_(_({},s.data),null==r?void 0:r.data):s.data=_(_({},s.data),{custom_data:null==r?void 0:r.data}),(null==r?void 0:r.tags)&&(s.tags=_(_({},s.tags),r.tags)),function(e,t){var n=e;t.forEach(function(e){var t=e(n);t&&(n=t)})}(s,t.options.transports)},this.options=_(_({},this.options),e)}return e.prototype.withOwner=function(t){return new e(_(_({},this.options),{owner:t}))},e.prototype.pipeOwner=function(t){var n;return t?(n=this.options.owner?"".concat(this.options.owner,".").concat(t):t,new e(_(_({},this.options),{owner:n}))):this},e.prototype.withAction=function(t){return new e(_(_({},this.options),{action:t}))},e.prototype.pipeTags=function(t){return t?new e(_(_({},this.options),"function"==typeof t?{getTagsFn:P(P([],this.options.getTagsFn,!0),[t],!1)}:{tags:_(_({},this.options.tags),t)})):this},e.prototype.pipeData=function(t){return t?new e(_(_({},this.options),"function"==typeof t?{getDataFn:P(P([],this.options.getDataFn,!0),[t],!1)}:{data:_(_({},this.options.data),t)})):this},e.prototype.pipeTransport=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.options.transports.concat(t);return new e(_(_({},this.options),{transports:r}))},e.prototype.info=function(e,t){this.report(O.Info,e,t)},e.prototype.log=function(e,t){this.report(O.Log,e,t)},e.prototype.warn=function(e,t){this.report(O.Warn,e,t)},e.prototype.error=function(e,t){this.report(O.Error,e,t)},S([T(new e)],e.prototype,"withOwner",null),S([T(new e)],e.prototype,"pipeOwner",null),S([T(new e)],e.prototype,"withAction",null),S([T(new e)],e.prototype,"pipeTags",null),S([T(new e)],e.prototype,"pipeData",null),S([T(new e)],e.prototype,"pipeTransport",null),S([T(new e)],e.prototype,"info",null),S([T(new e)],e.prototype,"log",null),S([T(new e)],e.prototype,"warn",null),S([T(new e)],e.prototype,"error",null),e}();Object.defineProperty(new L,"options",{writable:!1,configurable:!1});for(var D=new Uint8Array(16),j=[],N=0;N<256;++N)j.push((N+256).toString(16).slice(1));var B={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function R(e,t,n){if(B.randomUUID&&!t&&!e)return B.randomUUID();var r=(e=e||{}).random||(e.rng||function(){if(!x&&!(x="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return x(D)})();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(j[e[t+0]]+j[e[t+1]]+j[e[t+2]]+j[e[t+3]]+"-"+j[e[t+4]]+j[e[t+5]]+"-"+j[e[t+6]]+j[e[t+7]]+"-"+j[e[t+8]]+j[e[t+9]]+"-"+j[e[t+10]]+j[e[t+11]]+j[e[t+12]]+j[e[t+13]]+j[e[t+14]]+j[e[t+15]]).toLowerCase()}(r)}new(function(){function e(){this.fnList=[],this.get()}return e.prototype.get=function(){var e,t,n=sessionStorage.getItem("SL_LOGGER_SESSION_ID"),r=(e=document.cookie.split("; "),t={},e.forEach(function(e){var n=e.split("="),r=n[0],o=n[1];r&&(t[r]=o||"")}),t.log_session_id||"");if(n)return n!==r&&this.updateId(n),n;var o=R();return this.updateId(o),o},e.prototype.set=function(e){return!!e&&(this.updateId(e),this.fnList.forEach(function(t){return t(e)}),!0)},e.prototype.refresh=function(){var e=R();return this.updateId(e),this.fnList.forEach(function(t){return t(e)}),!0},e.prototype.onChange=function(e){this.fnList.push(e)},e.prototype.updateId=function(e){var t,n;sessionStorage.setItem("SL_LOGGER_SESSION_ID",e),void 0===t&&(t="/"),n="".concat("log_session_id","=").concat(e),t&&(n+="; path=".concat(t)),document.cookie=n},S([T("")],e.prototype,"get",null),S([T(!1)],e.prototype,"set",null),S([T(!1)],e.prototype,"refresh",null),S([T()],e.prototype,"onChange",null),S([T()],e.prototype,"updateId",null),e}());var M=new L,F={get:function(){return M},set:function(e){e&&(M=e)}};function U(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function H(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){U(a,r,o,i,c,"next",e)}function c(e){U(a,r,o,i,c,"throw",e)}i(void 0)})}}function Y(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function V(e){var t=function(e,t){if("object"!==b(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==b(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===b(t)?t:String(t)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,V(r.key),r)}}function G(e,t,n){return t&&q(e.prototype,t),n&&q(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function W(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z(e,t){return(z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function K(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}function $(e,t){if(t&&("object"===b(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return W(e)}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Z(e,t,n){return(t=V(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X={exports:{}},Q={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==c(Symbol.iterator)?function(e){return c(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":c(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(Q),function(e){var t=Q.exports.default;function n(){e.exports=n=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var r={},o=Object.prototype,a=o.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var o,a,c=Object.create((t&&t.prototype instanceof y?t:y).prototype);return i(c,"_invoke",{value:(o=new k(r||[]),a="suspendedStart",function(t,r){if("executing"===a)throw Error("Generator is already running");if("completed"===a){if("throw"===t)throw r;return{value:void 0,done:!0}}for(o.method=t,o.arg=r;;){var i=o.delegate;if(i){var c=function e(t,n){var r=n.method,o=t.iterator[r];if(void 0===o)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=void 0,e(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+r+"' method")),h;var a=f(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,h):i:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,h)}(i,o);if(c){if(c===h)continue;return c}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===a)throw a="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);a="executing";var s=f(e,n,o);if("normal"===s.type){if(a=o.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:o.done}}"throw"===s.type&&(a="completed",o.method="throw",o.arg=s.arg)}})}),c}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=p;var h={};function y(){}function m(){}function g(){}var v={};d(v,s,function(){return this});var b=Object.getPrototypeOf,C=b&&b(b(I([])));C&&C!==o&&a.call(C,s)&&(v=C);var w=g.prototype=y.prototype=Object.create(v);function O(e){["next","throw","return"].forEach(function(t){d(e,t,function(e){return this._invoke(t,e)})})}function _(e,n){var r;i(this,"_invoke",{value:function(o,i){function c(){return new n(function(r,c){(function r(o,i,c,s){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==t(d)&&a.call(d,"__await")?n.resolve(d.__await).then(function(e){r("next",e,c,s)},function(e){r("throw",e,c,s)}):n.resolve(d).then(function(e){l.value=e,c(l)},function(e){return r("throw",e,c,s)})}s(u.arg)})(o,i,r,c)})}return r=r?r.then(c,c):c()}})}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:E}}function E(){return{value:void 0,done:!0}}return m.prototype=g,i(w,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:m,configurable:!0}),m.displayName=d(g,l,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,d(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},r.awrap=function(e){return{__await:e}},O(_.prototype),d(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,t,n,o,a){void 0===a&&(a=Promise);var i=new _(p(e,t,n,o),a);return r.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},O(w),d(w,l,"Generator"),d(w,s,function(){return this}),d(w,"toString",function(){return"[object Generator]"}),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},r.values=I,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),s=a.call(o,"finallyLoc");if(c&&s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},r}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(X);var ee=X.exports();try{regeneratorRuntime=ee}catch(e){"object"===("undefined"==typeof globalThis?"undefined":b(globalThis))?globalThis.regeneratorRuntime=ee:Function("r","regeneratorRuntime = r")(ee)}var et={exports:{}};et.exports=function(){var e=function(){},t={},n={},r={};function o(e,t){if(e){var o=r[e];if(n[e]=t,o)for(;o.length;)o[0](e,t),o.splice(0,1)}}function a(t,n){t.call&&(t={success:t}),n.length?(t.error||e)(n):(t.success||e)(t)}function i(n,r,i){var c,s;if(r&&r.trim&&(c=r),s=(c?i:r)||{},c){if(c in t)throw"LoadJS";t[c]=!0}function u(t,r){!function(t,n,r){var o,a,i=(t=t.push?t:[t]).length,c=i,s=[];for(o=function(e,t,r){if("e"==t&&s.push(e),"b"==t){if(!r)return;s.push(e)}--i||n(s)},a=0;a<c;a++)!function t(n,r,o,a){var i,c,s=document,u=o.async,l=(o.numRetries||0)+1,d=o.before||e,p=n.replace(/[\?|#].*$/,""),f=n.replace(/^(css|img)!/,"");a=a||0,/(^css!|\.css$)/.test(p)?((c=s.createElement("link")).rel="stylesheet",c.href=f,(i="hideFocus"in c)&&c.relList&&(i=0,c.rel="preload",c.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(p)?(c=s.createElement("img")).src=f:((c=s.createElement("script")).src=n,c.async=void 0===u||u),c.onload=c.onerror=c.onbeforeload=function(e){var s=e.type[0];if(i)try{c.sheet.cssText.length||(s="e")}catch(e){18!=e.code&&(s="e")}if("e"==s){if((a+=1)<l)return t(n,r,o,a)}else if("preload"==c.rel&&"style"==c.as)return c.rel="stylesheet";r(n,s,e.defaultPrevented)},!1!==d(n,c)&&s.head.appendChild(c)}(t[a],o,r)}(n,function(e){a(s,e),t&&a({success:t,error:r},e),o(c,e)},s)}if(s.returnPromise)return new Promise(u);u()}return i.ready=function(e,t){return function(e,t){e=e.push?e:[e];var o,a,i,c=[],s=e.length,u=s;for(o=function(e,n){n.length&&c.push(e),--u||t(c)};s--;)(i=n[a=e[s]])?o(a,i):(r[a]=r[a]||[]).push(o)}(e,function(e){a(t,e)}),i},i.done=function(e){o(e,[])},i.reset=function(){t={},n={},r={}},i.isDefined=function(e){return e in t},i}();var en,er,eo,ea,ei,ec,es,eu,el,ed,ep,ef,eh,ey,em=et.exports;(ew=en||(en={})).Init="init",ew.PullUpChannel="pullUpChannel",ew.CreateOrder="createOrder",ew.Pay="pay",ew.Hooks="Hooks",ew.CreateExpected="createExpected",ew.ReRender="rerender",(eO=er||(er={})).Continue="continue",eO.PayNow="pay_now",eO.All="all",(e_=eo||(eo={})).Paypal="Paypal",e_.SLpayments="SLpayments",e_.StripeOther="StripeOther",(eS=ea||(ea={})).Paypal="Paypal",eS.GooglePay="GooglePay",eS.ApplePay="ApplePay",(ei||(ei={})).StandardEC="standard_ec",(ec||(ec={})).Prod="prod",(eP=es||(es={})).Done="done",eP.Pending="pending",eP.Await="await",eP.Fail="fail",(ek=eu||(eu={}))[ek.Fail=0]="Fail",ek[ek.Success=1]="Success",(eI=el||(el={})).Ordinary="ordinary",eI.ChangeAddress="change_address",eI.ChangeDeliveryMethod="change_delivery_method",eI.UseDiscountCode="use_discount_code",(eE=ed||(ed={})).RedirectOrPopup="RedirectOrPopup",eE.Redirect="Redirect",eE.ChannelInfoUpdate="ChannelInfoUpdate",eE.ChannelConfirm="ChannelConfirm",eE.OpenIframe="OpenIframe",(ex=ep||(ep={})).GET="GET",ex.POST="POST",(eT=ef||(ef={})).PAY_AND_BIND="PAY_AND_BIND",eT.PAY_NORMAL="PAY_NORMAL",(eA=eh||(eh={})).Hidden="Hidden",eA.Visible="Visible",(eL=ey||(ey={})).Confirm="Confirm",eL.Init="Init",eL.I18n="I18n",eL.SaveAbandonOrder="SaveAbandonOrder",eL.ExpressFirstLoad="ExpressFirstLoad",eL.ExpressUpdateDetail="ExpressUpdateDetail";var eg="rememberedCb",ev={props:{payMode:er.Continue,timeout:{switch:!1,delay:5e3},styleOptions:{layout:"horizontal",color:"gold",shape:"rect",label:"paypal",tagline:!1,height:55},timing:!1,currency:"USD"}};function eb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eb(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eb(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ew,eO,e_,eS,eP,ek,eI,eE,ex,eT,eA,eL,eD,ej=function(){var e;function t(e){var n;Y(this,t),Z(this,"initialData",void 0),Z(this,"paypalInstanceName",void 0),this.initialData=e,this.paypalInstanceName=(null==e||null===(n=e.scriptParams)||void 0===n?void 0:n["data-namespace"])||"paypal",window.__PAYPALSPB_LOADJS||(window.__PAYPALSPB_LOADJS=em,window.__PAYPALSPB_LOADJS.ids={})}return G(t,[{key:"render",value:(e=H(ee.mark(function e(){var t,n,r,o,a,i,c,s=this;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://www.paypal.com/sdk/js",null!==(t=this.initialData)&&void 0!==t&&t.queryParams&&(r+="".concat(this.initialData.queryParams)),o=r,a={},null!==(n=this.initialData)&&void 0!==n&&n.scriptParams&&(c=(null===(i=this.initialData)||void 0===i?void 0:i.scriptParams)||{},a.before=function(e,t){Object.keys(c).forEach(function(e){var n=c[e];n&&t.setAttribute(e,n)})},null!=c&&c["data-namespace"]&&(this.paypalInstanceName=c["data-namespace"]),Object.keys(c).forEach(function(e){var t=c[e];o+="".concat(e,"&").concat(t)})),window.__PAYPALSPB_LOADJS.ids[o]||(window.__PAYPALSPB_LOADJS.ids[o]=window.__PAYPALSPB_LOADJS([r],eC(eC({},a),{},{returnPromise:!0}))),e.abrupt("return",window.__PAYPALSPB_LOADJS.ids[o].then(function(){s.initPaypal()}).catch(function(e){throw window.__PAYPALSPB_LOADJS.ids[o]=!1,e}));case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"initPaypal",value:function(){var e,t=null===(e=this.initialData.style)||void 0===e?void 0:e["border-radius"],n=eC({},this.initialData);n.style||(n.style={}),n.style.shape=t>=10?"pill":"rect";var r=document.querySelector("#".concat(this.initialData.domId," .").concat("paypal-buttons"));r&&r.remove(),window[this.paypalInstanceName].Buttons(this.initialData).render("#".concat(this.initialData.domId))}}]),t}(),eN=function(){function e(){Y(this,e),Z(this,"handlers",[])}return G(e,[{key:"use",value:function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1}},{key:"eject",value:function(e){this.handlers[e]&&(this.handlers[e]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(e){this.handlers.forEach(function(t){null!==t&&e(t)})}}]),e}();function eB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eB(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eB(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eM={maxCount:3,interval:1e3},eF={};function eU(e,t){if(!e)return null;var n=eF[e]||{};return n=eR(eR(eR(eR({},n),eM),t),{},{retryCount:n.retryCount||0}),eF[e]=n,n}var eH=function(e){return e.useRetry&&e.action},eY=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"xhr";return JSON.parse(JSON.stringify(e,function(e,n){if(e!==t)return n}))};function eV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eq(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eV(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eV(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eG=new(function(){function e(t){Y(this,e),Z(this,"options",{}),Z(this,"interceptors",{}),Z(this,"getLogData",function(e){return{readyState:e.readyState,status:e.status,statusText:e.statusText,timeout:e.timeout,withCredentials:e.withCredentials}}),Z(this,"serialize",function(e){var t=Object.prototype.toString.call(e);return e&&"[object Object]"===t?Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&"):""}),this.options=t||{},this.interceptors={request:new eN,response:new eN}}return G(e,[{key:"logger",get:function(){return F.get().pipeOwner("payment-common.request")}},{key:"setOptions",value:function(e){this.options=e}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=this.buildUrl(e,null==t?void 0:t.params),this.http(e,eq(eq(eq({method:"GET"},this.options),t),{},{headers:eq(eq({},{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"}),t.headers)}))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={Accept:"application/json"},o=t||n.data||null;return"form"===n.requestType?(r["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",o=this.serialize(o)):(r["Content-Type"]="application/json;charset=UTF-8",o=o?JSON.stringify(o):null),this.http(e,eq(eq(eq({method:"POST",body:o},this.options),n),{},{headers:eq(eq({},r),n.headers)}))}},{key:"dispatchRequest",value:function(e,t){var n=this;return new Promise(function(r,o){var a=new window.XMLHttpRequest,i=!1,c=t.body,s=n.options.baseUrl&&!/^(https?:)?(\/\/)/.test(e)?"".concat(n.options.baseUrl).concat(e):e;a.open(t.method||"",s),t.headers&&Object.keys(t.headers).forEach(function(e){var n;a.setRequestHeader(e,(null===(n=t.headers)||void 0===n?void 0:n[e])||"")});var u={options:t,url:s};if(a.onreadystatechange=function(){if(4===a.readyState){u.statusCode=a.status;var e="";try{e=JSON.parse(a.responseText)}catch(t){e=a.responseText}if(/^(2|3)\d{2}$/.test(a.status.toString())){try{r(eq({data:e},u))}catch(t){r(eq({data:e},u))}return}o(eq({data:e},u))}},a.send(c),a.onabort=function(t){i=!0,n.logger.error("xhr_onabort",{data:eq(eq({},n.getLogData(a)),{},{url:e})}),u.statusCode=a.status,o(eq({error:t=eY(t)},u))},a.onerror=function(t){n.logger.error("xhr_onerror",{data:eq(eq({},n.getLogData(a)),{},{url:e})}),u.statusCode=a.status,o(eq({error:t=eY(t)},u))},a.ontimeout=function(){n.logger.error("xhr_ontimeout",{data:eq(eq({},n.getLogData(a)),{},{url:e,withCredentials:a.withCredentials})})},t.timeout){if(i)return;setTimeout(function(){a.abort();var t=Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",n.logger.error("xhr_timeout",{data:{url:e}}),u.statusCode=a.status,o(eq({error:t},u))},t.timeout)}})}},{key:"http",value:function(e,t){var n,r,o,a,i=[];null===(n=this.interceptors)||void 0===n||null===(r=n.request)||void 0===r||r.forEach(function(e){i.unshift(e.fulfilled,e.rejected)});var c,s=[];null===(o=this.interceptors)||void 0===o||null===(a=o.response)||void 0===a||a.forEach(function(e){s.push(e.fulfilled,e.rejected)});for(var u=t;i.length;){var l=i.shift(),d=i.shift();try{l&&(u=l(u))}catch(e){d&&d(e);break}}try{c=this.dispatchRequest(e,u)}catch(e){return Promise.reject(e)}for(;s.length;){var p=s.shift(),f=s.shift();c=c.then(p,f)}return c}},{key:"buildUrl",value:function(e,t){var n=Object.prototype.toString.call(t);if(!t||"[object Object]"!==n)return e;var r=Object.keys(t);return(e=decodeURIComponent(e).indexOf("?")>-1?"".concat(e,"&"):"".concat(e,"?"))+r.map(function(e){return"".concat(e,"=").concat(t[e])}).join("&")}}]),e}());function eW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ez(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function eK(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],s=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ez(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ez(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}null==eG||null===(ta=eG.interceptors)||void 0===ta||null===(ti=ta.request)||void 0===ti||ti.use(function(e){eD||(eD=F.get().pipeOwner("payment-common.retry"));var t=eU(e.action);return eH(e)&&t&&(t.lastRequestTime=Date.now()),e}),null==eG||null===(tc=eG.interceptors)||void 0===tc||null===(ts=tc.response)||void 0===ts||ts.use(null,function(e){var t=e.options,n=e.url;if(!t)return Promise.reject(e);var r=eU(t.action,t.retryOptions);if(!eH(t)||!r)return Promise.reject(e);if(function(e,t,n){if(!e||!function(e,t){switch(e){case ey.Init:case ey.SaveAbandonOrder:case ey.ExpressFirstLoad:case ey.ExpressUpdateDetail:return!!t&&400!==t.statusCode;case ey.I18n:return!0;default:return!1}}(e,n))return!1;var r,o,a=t.retryCount<(null==t?void 0:t.maxCount),i=n.statusCode,c={action:e,statusCode:i,url:n.url};return a?null===(r=eD)||void 0===r||r.log("start_retry",{data:eR(eR({},c),{},{retryCount:t.retryCount})}):(null===(o=eD)||void 0===o||o.error("retry_max_times",{data:c,errorLevel:0===i?C.P2:C.P1}),t.retryCount=0),a}(t.action,r,e)){if(r.retryCount+=1,t.timeout&&r.lastRequestTime){var o=Date.now()-r.lastRequestTime;t.timeout=Math.max(t.timeout-o-r.interval,1)}return new Promise(function(e){return setTimeout(function(){e(eG.http(n,t))},r.interval)})}return Promise.reject(e)});var e$=function(e){return"function"==typeof e};function eJ(e){return"[object Object]"===Object.prototype.toString.call(e)}function eZ(e){return!e||e.nodeType||"object"!==b(e)?e:JSON.parse(JSON.stringify(e))}function eX(e,t){if(null==t)return eZ(e);if(!eJ(t)||!eJ(e))return eZ(t);var n={};return Object.keys(e).map(function(r){n[r]=eX(e[r],t[r])}),Object.keys(t).map(function(e){n[e]||(n[e]=eZ(t[e]))}),n}var eQ=window.performance&&"function"==typeof window.performance.now?window.performance:Date,e1=function e(t){t instanceof Array?t.forEach(function(t){return e(t)}):"object"===b(t)&&null!==t&&Object.entries(t).forEach(function(n){var r=eK(n,2),o=r[0],a=r[1];null===a?delete t[o]:a instanceof Array?a.forEach(function(t){return e(t)}):"object"===b(a)&&e(a)})},e0=F.get();function e2(e){var t=e.prototype,n={validate:t.validate,handleError:t.handleError,handleDynamicNotify:t.handleDynamicNotify,dynamicJsonpCallback:t.dynamicJsonpCallback,handleDynamic:t.handleDynamic,handleRenderTimeout:t.handleRenderTimeout,beforeInit:t.beforeInit,beforeCreateOrder:t.beforeCreateOrder,afterCreateOrder:t.afterCreateOrder,removeSkeleton:t.removeSkeleton};Object.keys(n).forEach(function(t){e.prototype[t]=H(ee.mark(function e(){var r,o,a,i,c=arguments;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r="【".concat(t,"】"),e.prev=1,e0.info("".concat(r,"[开始执行]")),a=Array(o=c.length),i=0;i<o;i++)a[i]=c[i];return e.abrupt("return",n[t].apply(this,a));case 7:throw e.prev=7,e.t0=e.catch(1),e0.error("".concat(r,"[执行失败]"),{error:e.t0}),e.t0;case 11:case"end":return e.stop()}},e,this,[[1,7]])}))})}var e3="smart-payment-hide",e4="smart-payment-button-disabled",e5="smart-payment-button-loading",e6="express_common_style_id",e9=function(e){e.styleOptions;var t,n=e.domId,r=document.getElementById(n),o=document.getElementById(e6);if(r&&!o){var a=document.createElement("style");a.setAttribute("id",e6);var i="\n    .".concat(e3," {\n      display: none !important;\n    }\n    .").concat(e4,"::before {\n      width: 0 !important;\n    }\n    .").concat(e4,"::after {\n      content: '';\n      display: block;\n      z-index: 100;\n      width: 100% !important;\n      height: 100% !important;\n      border-radius: 4px;\n      cursor: not-allowed;\n      position: absolute;\n      top: 0;\n      left: 0 !important;\n      background: transparent !important;\n    }\n    .").concat(e4," {\n      opacity: 0.3;\n    }\n\n    @keyframes rotate {\n      from {\n        transform: rotate(0deg);\n      }\n      to {\n        transform: rotate(359deg);\n      }\n    }\n\n    .").concat(e5,"::before {\n      content: '';\n      display: inline-block;\n      background-color: black;\n      width: 100%;\n      height: 100%;\n      border-radius: 0px;\n    }\n\n    .").concat(e5,"::after {\n      content: '';\n      display: inline-block;\n      position: absolute;\n      border: 2px solid white;\n      top: calc(50% - 8px);\n      left: calc(50% - 8px);\n      width: 16px;\n      height: 16px;\n      border-radius: 16px;\n      clip-path: polygon(0% 0%, 100% 0%, 100% 70%, 0% 70%);\n      animation: rotate 1s linear infinite;\n    }\n  ");a.innerHTML="".concat(i),null===(t=r.parentElement)||void 0===t||t.insertBefore(a,r)}},e8=function(e){var t,n=e.styleOptions,r=e.domId,o=document.getElementById(r);if(o){var a=document.createElement("style"),i="\n    #".concat(r," .express-payment-button-common-item {\n      min-height: ").concat((null==n?void 0:n.height)||48,"px;\n      width: 100%;\n    }\n  ");void 0===(null==n?void 0:n["border-radius"])&&(i+="\n      #".concat(r," .").concat(e5,"::before {\n        border-radius: 4px;\n      }\n\n      [data-button_style=square] #").concat(r," .").concat(e5,"::before {\n        border-radius: 0;\n      }\n\n      [data-button_style=rounded] #").concat(r," .").concat(e5,"::before {\n        border-radius: 9999px;\n      }\n    ")),a.innerHTML="".concat(i),null===(t=o.parentElement)||void 0===t||t.insertBefore(a,o)}},e7=G(function e(t){var n=this;Y(this,e),Z(this,"config",void 0),Z(this,"isVisible",!0),Z(this,"showButton",function(){var e=document.getElementById(n.config.paymentInfo.currentDomId);null==e||e.classList.remove(e3),n.isVisible=!0}),Z(this,"hideButton",function(){var e=document.getElementById(n.config.paymentInfo.currentDomId);null==e||e.classList.add(e3),n.isVisible=!1}),this.config=t}),te=function(e,t){var n=[];return Object.keys(t).forEach(function(e){return t[e]&&n.push("".concat(e,"=").concat(t[e]))}),-1===e.search(/\?/)?e+="?".concat(n.join("&")):e+="&".concat(n.join("&")),e},tt=function(){function e(t){var n=this;Y(this,e),Z(this,"type",void 0),Z(this,"domId",void 0),Z(this,"logger",F.get().pipeOwner("payment-common.3DS")),Z(this,"handlePostmessage",function(e){var t=e.data,r=e.origin;if(!1!==/^https:\/\/([^.]+)?\.myshopline([^.]+)?\.com$/.test(r)){n.logger.log("3DS_handlePostmessage",{data:{data:t,origin:r,domId:n.domId}});var o=t.success,a=t.nextAction||{},i=t.nextAction||{},c=i.url,s=i.type;if(o){if(s===ed.Redirect&&c){if(window.removeEventListener("message",n.handlePostmessage,!1),n.domId){var u=document.getElementById(n.domId);u&&u.parentElement&&u.parentElement.removeChild(u)}tr(a)}s===ed.OpenIframe&&n.openIframe(t.nextAction)}}}),this.type=t}return G(e,[{key:"handleIframe",value:function(e){var t,n,r,o=e.type,a=e.iframeType,i=e.url,c=void 0===i?"":i,s="".concat(o,"Iframe-").concat(Date.now());return this.domId=s,a===eh.Hidden?((t=document.createElement("iframe")).src=c,t.name=s,t.style.width="1px",t.style.height="1px",t.style.display="none",t.style.border="none",document.body.appendChild(t),r=t):a===eh.Visible&&((n=document.createElement("iframe")).src=c,n.name=s,n.style.width="100%",n.style.height="100%",n.style.display="block",n.style.border="none",n.style.zIndex="1000",n.style.position="fixed",n.style.top="0",n.style.left="0",n.style.background="#fff",document.body.appendChild(n),r=n),r}},{key:"openIframe",value:function(e){this.logger.log("3DS_openIframe_start",{data:{nextAction:e,domId:this.domId}});var t,n=e.url,r=e.type,o=e.header,a=null!=o&&null!==(t=o.openIframeOptions)&&void 0!==t&&t.hidden?eh.Hidden:eh.Visible;this.handleIframe({type:r,iframeType:a,url:n}),window.removeEventListener("message",this.handlePostmessage,!1),window.addEventListener("message",this.handlePostmessage,!1)}}]),e}();function tn(){return(tn=H(ee.mark(function e(t){var n,r,o,a,i,c;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=void 0===(r=t.method)?"GET":r,a=t.url,i=t.data,o!==ep.GET){e.next=7;break}return e.next=4,eG.get(a);case 4:c=e.sent,e.next=11;break;case 7:if(o!==ep.POST){e.next=11;break}return e.next=10,eG.post(a,i||{});case 10:c=e.sent;case 11:return e.abrupt("return",null===(n=c)||void 0===n?void 0:n.data);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function tr(e){return to.apply(this,arguments)}function to(){return(to=H(ee.mark(function e(t){var n,r,o,a;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=void 0===(n=t.method)?"GET":n,o=t.url,a=t.data,"POST"===r?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"post",r=arguments.length>3?arguments[3]:void 0,o=document.createElement("form");for(var a in o.style.display="none",o.method=n,o.action=e,r&&(o.target=r),t){var i=document.createElement("input");i.name=a,i.value=t[a]||"",o.appendChild(i)}document.body.appendChild(o),o.submit()}(o,a):"GET"===r&&window.location.assign(o);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ta,ti,tc,ts,tu,tl,td,tp,tf,th,ty=(tu=H(ee.mark(function e(t,n){var r,o,a,i;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t.type)!==ed.Redirect){e.next=5;break}tr(t),e.next=22;break;case 5:if(r!==ed.ChannelInfoUpdate){e.next=14;break}return e.next=8,function(e){return tn.apply(this,arguments)}(t);case 8:if(null==(o=e.sent)||!o.nextAction){e.next=12;break}return e.next=12,ty(o.nextAction,n);case 12:case 19:e.next=22;break;case 14:if(r!==ed.ChannelConfirm){e.next=21;break}if(null==(i=null==n||null===(a=n.payOptions)||void 0===a?void 0:a.hooks)||!i.channelConfirm){e.next=19;break}return e.next=19,i.channelConfirm(t);case 21:r===ed.OpenIframe&&new tt(t.type).openIframe(t);case 22:case"end":return e.stop()}},e)})),function(e,t){return tu.apply(this,arguments)});(tm=td||(td={})).TEST="TEST",tm.PRODUCTION="PRODUCTION",(tg=tp||(tp={})).INITIALIZE="INITIALIZE",tg.SHIPPING_ADDRESS="SHIPPING_ADDRESS",tg.SHIPPING_OPTION="SHIPPING_OPTION",tg.OFFER="OFFER",(tv=tf||(tf={})).NOT_CURRENTLY_KNOWN="NOT_CURRENTLY_KNOWN",tv.ESTIMATED="ESTIMATED",tv.FINAL="FINAL",(tb=th||(th={})).DEFAULT="DEFAULT",tb.COMPLETE_IMMEDIATE_PURCHASE="COMPLETE_IMMEDIATE_PURCHASE";var tm,tg,tv,tb,tC,tw,tO,t_=(Z(tl={},tp.INITIALIZE,el.Ordinary),Z(tl,tp.SHIPPING_ADDRESS,el.ChangeAddress),Z(tl,tp.SHIPPING_OPTION,el.ChangeDeliveryMethod),Z(tl,tp.OFFER,el.UseDiscountCode),tl);(tM=tC||(tC={})).OFFER_INVALID="OFFER_INVALID",tM.PAYMENT_DATA_INVALID="PAYMENT_DATA_INVALID",tM.SHIPPING_ADDRESS_INVALID="SHIPPING_ADDRESS_INVALID",tM.SHIPPING_ADDRESS_UNSERVICEABLE="SHIPPING_ADDRESS_UNSERVICEABLE",tM.SHIPPING_OPTION_INVALID="SHIPPING_OPTION_INVALID",tM.OTHER_ERROR="OTHER_ERROR",(tF=tw||(tw={}))[tF.TimeoutToLoadPaymentData=18]="TimeoutToLoadPaymentData",tF[tF.UserCancel=20]="UserCancel",(tO||(tO={})).CANCELED="CANCELED";var tS=function(){function e(t,n,r){var o=this;Y(this,e),Z(this,"container",void 0),Z(this,"button",void 0),Z(this,"options",void 0),Z(this,"insertStyle",function(){var e=document.createElement("style"),t="\n      .gpay-card-info-container {\n        border-radius: 0;\n        min-width: 140px;\n        min-height: 36px;\n      }\n\n      .".concat(e5," .gpay-card-info-container-fill {\n        display: none;\n      }\n    ");void 0===o.options["border-radius"]&&(t+="\n        #".concat(o.container.id," .gpay-card-info-container {\n          border-radius: 4px;\n        }\n\n        [data-button_style=square] #").concat(o.container.id," .gpay-card-info-container {\n          border-radius: 0;\n        }\n\n        [data-button_style=rounded] #").concat(o.container.id," .gpay-card-info-container {\n          border-radius: 9999px;\n        }\n      ")),e.innerHTML=t;var n=48;o.options.height&&(n=o.options.height),o.container.style.height="".concat(n,"px"),o.container.appendChild(e)}),Z(this,"insertButton",function(){o.container.appendChild(o.button)}),this.container=t,this.button=n,this.options=r,this.insertStyle(),this.insertButton()}return G(e,[{key:"setDisabled",value:function(e){e?this.container.classList.add(e4):this.container.classList.remove(e4)}},{key:"setLoading",value:function(e){e?this.container.classList.add(e5):this.container.classList.remove(e5)}}]),e}(),tP=function(){if(/iphone|ipod|ipad/i.test(navigator.userAgent.toLowerCase()))return!1;var e,t=navigator.userAgent.match(/Chrome\/(\d+)/),n=t&&t[1]&&Number(t[1])>=61;return(!!(e=window.navigator.userAgent).match("CriOS")||/Chrome/.test(e)&&/Google Inc./.test(window.navigator.vendor)&&!!window.chrome)&&n};function tk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tk(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var tE=function(e){K(a,e7);var t,n,r,o=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=J(a);return e=t?Reflect.construct(n,arguments,J(this).constructor):n.apply(this,arguments),$(this,e)});function a(e){var t,n,r,i;return Y(this,a),Z(W(r=o.call(this,e)),"name","GOOGLE_PAY"),Z(W(r),"config",void 0),Z(W(r),"paymentsClient",null),Z(W(r),"buttonElement",null),Z(W(r),"disabled",!1),Z(W(r),"loading",!1),Z(W(r),"initSuccess",!0),Z(W(r),"loadResourceFail",!1),Z(W(r),"initTime",0),Z(W(r),"logger",void 0),Z(W(r),"onPaymentDataChanged",(i=H(ee.mark(function e(t){var n,o,a,i,c,s;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.callbackTrigger,e.next=3,null===(n=(o=r.config).onFormDataChange)||void 0===n?void 0:n.call(o,t,t_[a]).catch(function(){r.handleError(Error("Failed to update abandonedOrder info"),en.Pay)});case 3:if(i=e.sent,r.logger.info("订单信息变更，从业务方获取的更新后的数据",{data:tI({},i)}),i&&!i.error){e.next=7;break}return e.abrupt("return",{error:{reason:tC.OTHER_ERROR,intent:a===tp.OFFER?tp.INITIALIZE:a,message:(null==i||null===(c=i.error)||void 0===c?void 0:c.message)||"update error"}});case 7:return e1(s={newOfferInfo:i.newOfferInfo,newTransactionInfo:i.newTransactionInfo,newShippingOptionParameters:i.newShippingOptionParameters}),r.logger.log("订单信息变更，返回给渠道的数据",{data:tI({},s)}),e.abrupt("return",s);case 12:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)})),Z(W(r),"onPaymentAuthorized",function(e){return new Promise(function(t,n){var o,a;(null===(o=(a=r.config).createOrder)||void 0===o?void 0:o.call(a,r.config.paymentInfo,{payChannelData:e,token:e})).then(function(e){if(!e||e.error)throw e.error;r.afterCreateOrder(eu.Success),t({transactionState:"SUCCESS"}),ty(e.nextAction)}).catch(function(e){r.afterCreateOrder(eu.Fail),n({reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_AUTHORIZATION",message:e.message||"pay error"})})})}),Z(W(r),"onGooglePaymentButtonClicked",H(ee.mark(function e(){var t,n,o,a;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.paymentsClient&&!r.loading&&!r.disabled){e.next=2;break}return e.abrupt("return");case 2:return r.setLoading(!0),e.next=5,r.beforeCreateOrder().catch(function(){return{valid:!1}});case 5:if(n=e.sent,r.setLoading(!1),!1!==(null==n?void 0:n.valid)){e.next=9;break}return e.abrupt("return");case 9:if(o=null==n||null===(t=n.paymentConfig)||void 0===t?void 0:t.payChannelData){e.next=12;break}return e.abrupt("return");case 12:e1(o),a=setTimeout(function(){r.onChannelModalSuccess()},1e3),r.logger.log("用户点击GP按钮，拉起支付弹窗",{data:tI({},o)}),r.paymentsClient.loadPaymentData(o).catch(function(e){clearTimeout(a),e.statusCode!==tO.CANCELED||e.code!==tw.TimeoutToLoadPaymentData?e.statusCode!==tO.CANCELED?r.handleError(Error("pay failed"),en.Pay,{error:e}):r.logger.log("loadPaymentData return cancel error",{data:{error:e}}):r.handleError(Error("Failed to pull up the channel"),en.PullUpChannel,{error:e})});case 16:case"end":return e.stop()}},e)}))),r.config=e,F.set(null===(t=(n=r.config).loggerFn)||void 0===t?void 0:t.call(n)),r.logger=F.get().pipeOwner("payment-common.SLP-GooglePay").pipeData({domId:"".concat(r.config.props.domId)}),r}return G(a,[{key:"render",value:(r=H(ee.mark(function e(){return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(tP()){e.next=3;break}return this.handleError(Error("The current browser does not support Google Pay"),en.Init),e.abrupt("return");case 3:return this.beforeInit(),e.next=6,this.loadChannelJs();case 6:if(e.sent){e.next=9;break}return e.abrupt("return");case 9:if(this.createClient()){e.next=12;break}return e.abrupt("return");case 12:this.renderButton(),this.afterInit();case 14:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"beforeInit",value:function(){this.initTime=eQ.now(),e$(this.config.beforeInit)&&this.config.beforeInit()}},{key:"afterInit",value:function(){this.initSuccess=!0,this.showButton();var e=eQ.now()-this.initTime;this.logger.log("afterInit",{data:{duration:e}}),e$(this.config.afterInit)&&this.config.afterInit()}},{key:"onChannelModalSuccess",value:function(){e$(this.config.onChannelModalSuccess)&&this.config.onChannelModalSuccess(this.config.paymentInfo)}},{key:"beforeCreateOrder",value:(n=H(ee.mark(function e(){var t,n,r,o,a;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e$(this.config.beforeCreateOrder)){e.next=2;break}return e.abrupt("return");case 2:return n=(t=this.config.paymentInfo).channelCode,r=t.methodCode,o=t.paymentId,e.next=5,this.config.beforeCreateOrder({channelCode:n,methodCode:r,paymentId:o});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"afterCreateOrder",value:function(e){e$(this.config.afterCreateOrder)&&this.config.afterCreateOrder(e,{channelCode:eo.SLpayments,methodCode:ea.GooglePay})}},{key:"setDisabled",value:function(e){var t;this.disabled=e,null===(t=this.buttonElement)||void 0===t||t.setDisabled(e)}},{key:"setLoading",value:function(e){var t;this.loading=e,null===(t=this.buttonElement)||void 0===t||t.setLoading(e)}},{key:"loadChannelJs",value:function(){var e=this;return new Promise(function(t){em("https://pay.google.com/gp/p/js/pay.js",{returnPromise:!0}).then(function(){e.loadResourceFail=!1,t(!0)}).catch(function(n){e.loadResourceFail=!0,e.handleError(Error("Failed to load channel js resource:".concat(n)),en.Init),t(!1)})})}},{key:"createClient",value:function(){var e=this.config.paymentInfo.sdkEnv===ec.Prod?td.PRODUCTION:td.TEST;try{return this.paymentsClient=new window.google.payments.api.PaymentsClient({environment:e,paymentDataCallbacks:{onPaymentDataChanged:this.onPaymentDataChanged,onPaymentAuthorized:this.onPaymentAuthorized}}),this.paymentsClient}catch(e){this.handleError(Error("Failed to create channel instance"),en.Init,{channelMsg:e.message})}}},{key:"renderButton",value:function(){if(this.paymentsClient)try{var e,t,n=this.paymentsClient.createButton({onClick:this.onGooglePaymentButtonClicked,buttonSizeMode:"fill"}),r=document.getElementById(this.config.paymentInfo.currentDomId);if(!r)throw Error("Container not found: #".concat(this.config.paymentInfo.currentDomId));this.buttonElement=new tS(r,n,{height:null===(e=this.config.props.styleOptions)||void 0===e?void 0:e.height,"border-radius":null===(t=this.config.props.styleOptions)||void 0===t?void 0:t["border-radius"]})}catch(e){this.handleError(Error("Failed to render button"),en.Init,{channelMsg:e.message})}}},{key:"handleError",value:function(e,t,n){window[window.__sl_console__?"__sl_console__":"console"].error("GP 统一错误处理: ",{error:e,type:t,extData:n}),t!==en.CreateExpected&&this.logger.error("handleError",{action:t,error:e,data:tI({},n)}),t===en.Init&&(this.initSuccess=!1,this.hideButton()),e$(this.config.onError)&&this.config.onError(e,t,n)}}]),a}();function tx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tx(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tx(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var tA=function(e){if(null!=e&&e.paymentInfo){var t=e.paymentInfo.configData;e.props=tT(tT({},e.props),t)}return e};function tL(e){return"object"===("undefined"==typeof Node?"undefined":b(Node))?e instanceof Node:e&&"object"===b(e)&&"number"==typeof e.nodeType}function tD(){var e=[];return{watch:e.push.bind(e),trigger:function(t,n){for(var r=!0,o={detail:n,preventDefault:function(){r=!1}},a=0;a<e.length;a++)e[a](t,o);return r}}}function tj(e){return"none"===window.getComputedStyle(e).display}function tN(e){this.elem=e}tN.make=function(e,t){"string"==typeof e&&(e=document.querySelector(e));var n=document.createElement(t||"div");return(e||document.body).appendChild(n),new tN(n)},tN.prototype={child:function(e){return tN.make(this.elem,e)},stylize:function(e){for(var t in void 0!==(e=e||{}).opacity&&(e.filter="alpha(opacity="+100*e.opacity+")"),e)e.hasOwnProperty(t)&&(this.elem.style[t]=e[t]);return this},clazz:function(e){return this.elem.className+=" "+e,this},html:function(e){return tL(e)?this.elem.appendChild(e):this.elem.innerHTML=e,this},onClick:function(e){return this.elem.addEventListener("click",e),this},destroy:function(){this.elem.parentNode.removeChild(this.elem)},hide:function(){this.elem.style.display="none"},show:function(){this.elem.style.display="block"},attr:function(e,t){return void 0!==t&&this.elem.setAttribute(e,t),this},anyAncestor:function(e){for(var t=this.elem;t;){if(e(new tN(t)))return!0;t=t.parentNode}return!1},isVisible:function(){return!tj(this.elem)}};var tB=1;function tR(e){return function(){return e().elem}}var tM,tF,tU,tH,tY,tV,tq,tG=tD(),tW=tD();document.documentElement.addEventListener("keydown",function(e){var t=e.which||e.keyCode;27===t?tG.trigger():9===t&&tW.trigger(e)}),(tz=tU||(tU={})).Validatemerchant="validatemerchant",tz.Paymentmethodselected="paymentmethodselected",tz.Cancel="cancel",tz.Shippingcontactselected="shippingcontactselected",tz.Authorize="Authorize",tz.Create="create",tz.Couponcodechanged="couponcodechanged",tz.Shippingmethodselected="shippingmethodselected",tz.Paymentauthorized="paymentauthorized",(tK=tH||(tH={})).ShippingContactInvalid="shippingContactInvalid",tK.BillingContactInvalid="billingContactInvalid",tK.AddressUnserviceable="addressUnserviceable",tK.CouponCodeInvalid="couponCodeInvalid",tK.CouponCodeExpired="couponCodeExpired",tK.Unknown="unknown",(tY||(tY={})).Credit="credit",(tV||(tV={})).Unknown="unknown";var tz,tK,t$,tJ,tZ="applepay-confirm-modal",tX='<svg width="59" height="24" viewBox="0 0 59 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M10.6871 3.0942C10.002 3.90485 8.90594 4.54424 7.80985 4.4529C7.67283 3.3568 8.20947 2.1922 8.83744 1.47288C9.5225 0.639391 10.7214 0.0456708 11.6919 0C11.806 1.14177 11.3608 2.2607 10.6871 3.0942ZM11.6804 4.66984C10.0934 4.5785 8.73468 5.57184 7.98111 5.57184C7.21613 5.57184 6.06294 4.71551 4.80699 4.73834C3.17426 4.76118 1.65571 5.68601 0.822213 7.1589C-0.890442 10.1047 0.376923 14.4662 2.03249 16.8639C2.84315 18.0514 3.81365 19.353 5.09243 19.3073C6.30271 19.2617 6.78225 18.5195 8.24372 18.5195C9.7166 18.5195 10.1391 19.3073 11.4178 19.2845C12.7423 19.2617 13.5758 18.0971 14.3864 16.9096C15.3113 15.5623 15.6881 14.2493 15.7109 14.1808C15.6881 14.1579 13.1533 13.1874 13.1305 10.2645C13.1077 7.82112 15.1286 6.65652 15.2199 6.58801C14.0782 4.89819 12.297 4.71551 11.6804 4.66984ZM20.8489 1.35871V19.1589H23.6119V13.0733H27.4369C30.9307 13.0733 33.3855 10.6755 33.3855 7.20457C33.3855 3.73359 30.9764 1.35871 27.5282 1.35871H20.8489ZM23.6119 3.68792H26.7975C29.1952 3.68792 30.5653 4.9667 30.5653 7.21598C30.5653 9.46527 29.1952 10.7555 26.7861 10.7555H23.6119V3.68792ZM38.4321 19.2959C40.1676 19.2959 41.7775 18.4167 42.5082 17.0238H42.5653V19.1589H45.1229V10.2988C45.1229 7.72978 43.0677 6.07421 39.905 6.07421C36.9706 6.07421 34.8013 7.75262 34.7214 10.059H37.2104C37.4159 8.96289 38.4321 8.24358 39.8251 8.24358C41.5149 8.24358 42.4626 9.0314 42.4626 10.4814V11.4634L39.0144 11.6689C35.806 11.863 34.0706 13.176 34.0706 15.4596C34.0706 17.7659 35.8631 19.2959 38.4321 19.2959ZM39.1743 17.1836C37.7014 17.1836 36.7651 16.4757 36.7651 15.3911C36.7651 14.2721 37.6671 13.6213 39.3912 13.5186L42.4626 13.3245V14.3292C42.4626 15.9962 41.0468 17.1836 39.1743 17.1836ZM48.5368 24C51.2314 24 52.4987 22.9724 53.6062 19.8554L58.4588 6.24548H55.65L52.396 16.7612H52.3389L49.0848 6.24548H46.1962L50.8774 19.2046L50.6262 19.9924C50.2038 21.3283 49.5187 21.8421 48.297 21.8421C48.0801 21.8421 47.6576 21.8192 47.4864 21.7964V23.9315C47.6462 23.9772 48.3313 24 48.5368 24Z" fill="currentColor"/>\n</svg>',tQ={props:{payMode:er.Continue,timeout:{switch:!1,delay:5e3},timing:!1}},t1=(Z(tq={},tU.Paymentmethodselected,el.Ordinary),Z(tq,tU.Shippingcontactselected,el.ChangeAddress),Z(tq,tU.Cancel,el.Ordinary),Z(tq,tU.Validatemerchant,el.Ordinary),Z(tq,tU.Authorize,el.Ordinary),Z(tq,tU.Create,el.Ordinary),Z(tq,tU.Couponcodechanged,el.UseDiscountCode),Z(tq,tU.Shippingmethodselected,el.ChangeDeliveryMethod),Z(tq,tU.Paymentauthorized,el.Ordinary),tq),t0=(t$=H(ee.mark(function e(t){var n,r,o,a,i;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={useRetry:!0,action:ey.I18n,retryOptions:{maxCount:3,interval:1e3}},r=t.project,o=t.env,a=t.lang,e.next=4,eG.get("https://cdn.myshopline.com/t/i18n/".concat(r,"/").concat(o,"/").concat(a,".raw.tree.json"),n);case 4:return i=e.sent,e.abrupt("return",i.data);case 6:case"end":return e.stop()}},e)})),function(e){return t$.apply(this,arguments)});(t2=tJ||(tJ={})).Dev="develop",t2.Stg="staging",t2.Prev="preview",t2.Prod="product";var t2,t3,t4="pay-button";(nf=t3||(t3={})).Stg="stg",nf.Prev="prev",nf.Prod="prod";var t5=function(e,t){var n=t.split(".").reduce(function(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:{}},e);return"[object Object]"===Object.prototype.toString.call(n)?"":n},t6=function(e){var t;return(Z(t={},tJ.Dev,t3.Stg),Z(t,tJ.Stg,t3.Stg),Z(t,tJ.Prev,t3.Prev),Z(t,tJ.Prod,t3.Prod),t)[e]},t9={applepay:{cancel:"Cancel",enquire:"Continue to place the order with Apple Pay?",paywith:"Pay with"},cart:{cart:{buy_now:"Buy now"},checkout:{max_amount_limit:"You exceeded the maximum amount for checkout"},couponCode:{existCode:"Discount code already exists"},error:{default:"Failed to load resource",noshipping:"No available shipping rate plans",order:"Unable to place order",renew:"Failed to update data"}},general:{abandon:{Order:{risk:"You have sent too many requests"}}},product_detail:{link_preview_does_not_support:"The link preview does not support this action"},products:{product_details:{more_payment_options:"More payment options"},product_list:{select_product_all_options:"Please select all options of this product"}},sdk:{button:{show:"More"}},transaction:{discount:{code_error:"Enter a valid discount code"}},unvisiable:{shopby:{button:{show:"Secured and Faster"}}}},t8=new(G(function e(){var t,n=this;Y(this,e),Z(this,"locale",t9),Z(this,"envLocal",window.__I18N__),Z(this,"language",""),Z(this,"setLanguage",(t=H(ee.mark(function e(t){var r,o,a;return ee.wrap(function(e){for(var i;;)switch(e.prev=e.next){case 0:if(n.language!==t){e.next=2;break}return e.abrupt("return");case 2:return n.language=t,r=t6((null===(i=window.__ENV__)||void 0===i?void 0:i.APP_ENV)||tJ.Prod),o=t9,a=F.get().withOwner("I18n"),e.prev=7,a.info("get i18n json",{data:{project:t4,env:r,lang:t}}),e.next=11,t0({project:t4,env:r,lang:t});case 11:o=e.sent,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),a.error("get i18n json error",{error:e.t0});case 17:n.locale=o;case 18:case"end":return e.stop()}},e,null,[[7,14]])})),function(e){return t.apply(this,arguments)})),Z(this,"useI18n",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,r){var o=t5(n.envLocal||{},e?[e,t].join("."):t)||"";return o||(o=t5(n.locale||{},e?[e,t].join("."):t)||""),r&&Object.entries(r).forEach(function(e){var t=eK(e,2),n=t[0],r=t[1];return o=o.replace(RegExp("{".concat(n,"}"),"ig"),r)}),o}})})),t7=t8.useI18n,ne=t8.setLanguage,nt=t7(),nn=(nh=H(ee.mark(function e(t){var n,r,o,a,i;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ok,r=t.cancel,o="".concat(tZ,"-action-ok"),a="".concat(tZ,"-action-cancel"),i=(function(e){("string"==typeof e||tL(e))&&(e={content:e});var t,n,r,o,a=tD(),i=tD(),c=tD(),s=tD(),u=tD();function l(t,n){var r=e[t];return"function"==typeof r&&(r=r(n)),void 0===r?n:r}var d,p,f=b.bind(window,"modal"),h=b.bind(window,"overlay"),y=b.bind(window,"close");function m(e){h().hide(),f().hide(),u.trigger(d,e)}function g(e){s.trigger(d,e)&&m(e)}function v(e){return function(){return e.apply(this,arguments),d}}function b(e,t){if(!p){var n,r,o=("number"==typeof(n=l("width","auto"))&&(n+="px"),r=l("modalId","pico-"+tB++),tN.make(l("parent")).clazz("pico-content").clazz(l("modalClass","")).stylize({display:"none",position:"fixed",zIndex:10001,left:"50%",top:"38.1966%",maxHeight:"90%",boxSizing:"border-box",width:n,"-ms-transform":"translate(-50%,-38.1966%)","-moz-transform":"translate(-50%,-38.1966%)","-webkit-transform":"translate(-50%,-38.1966%)","-o-transform":"translate(-50%,-38.1966%)",transform:"translate(-50%,-38.1966%)"}).stylize(l("modalStyles",{overflow:"auto",backgroundColor:"white",padding:"20px",borderRadius:"5px"})).html(l("content")).attr("id",r).attr("role","dialog").attr("aria-labelledby",l("ariaLabelledBy")).attr("aria-describedby",l("ariaDescribedBy",r)).onClick(function(e){new tN(e.target).anyAncestor(function(e){return/\bpico-close\b/.test(e.elem.className)})&&g()}));p={modal:o,overlay:tN.make(l("parent")).clazz("pico-overlay").clazz(l("overlayClass","")).stylize({display:"none",position:"fixed",top:"0px",left:"0px",height:"100%",width:"100%",zIndex:1e4}).stylize(l("overlayStyles",{opacity:.5,background:"#000"})).onClick(function(){l("overlayClose",!0)&&g()}),close:function(e,t){if(t("closeButton",!0))return e.child("button").html(t("closeHtml","&#xD7;")).clazz("pico-close").clazz(t("closeClass","")).stylize(t("closeStyles",{borderRadius:"2px",border:0,padding:0,cursor:"pointer",height:"15px",width:"15px",position:"absolute",top:"5px",right:"5px",fontSize:"16px",textAlign:"center",lineHeight:"15px",background:"#CCC"})).attr("aria-label",t("close-label","Close"))}(o,l)},a.trigger(d,t)}return p[e]}return function(e,t){var n;function r(e,t){return(e.msMatchesSelector||e.webkitMatchesSelector||e.matches).call(e,t)}function o(e){return!(tj(e)||r(e,":disabled")||e.hasAttribute("contenteditable"))&&(e.hasAttribute("tabindex")||r(e,"input,select,textarea,button,a[href],area[href],iframe"))}function a(e){for(var t=e.getElementsByTagName("*"),n=0;n<t.length;n++)if(o(t[n]))return t[n]}e.beforeShow(function(){n=document.activeElement}),e.afterShow(function(){if(t()){var n=a(e.modalElem());n&&n.focus()}}),e.afterClose(function(){t()&&n&&n.focus(),n=null}),tW.watch(function(n){if(t()&&e.isVisible()){var r=a(e.modalElem()),i=function(e){for(var t=e.getElementsByTagName("*"),n=t.length;n--;)if(o(t[n]))return t[n]}(e.modalElem());(n.shiftKey?r:i)===document.activeElement&&((n.shiftKey?i:r).focus(),n.preventDefault())}})}(d={modalElem:tR(f),closeElem:tR(y),overlayElem:tR(h),buildDom:v(b.bind(null,null)),isVisible:function(){return!!(p&&f&&f().isVisible())},show:function(e){return i.trigger(d,e)&&(h().show(),y(),f().show(),c.trigger(d,e)),this},close:v(g),forceClose:v(m),destroy:function(){f().destroy(),h().destroy(),h=f=y=void 0},options:function(t){Object.keys(t).map(function(n){e[n]=t[n]})},afterCreate:v(a.watch),beforeShow:v(i.watch),afterShow:v(c.watch),beforeClose:v(s.watch),afterClose:v(u.watch)},l.bind(null,"focus",!0)),t=d,n=l.bind(null,"bodyOverflow",!0),o=new tN(document.body),t.beforeShow(function(){r=o.elem.style.overflow,n()&&o.stylize({overflow:"hidden"})}),t.afterClose(function(){o.stylize({overflow:r})}),tG.watch(function(){l("escCloses",!0)&&d.isVisible()&&d.close()}),d})({content:'<div>\n        <div class="'.concat(tZ,'-header">').concat(tX,'</div>\n        <div class="').concat(tZ,'-content">').concat(nt("applepay.enquire"),'</div>\n        <div class="').concat(tZ,'-action">\n          <button class="').concat(o,'"><span>').concat(nt("applepay.paywith"),"</span> ").concat(tX,'</button>\n          <button class="').concat(a,'">').concat(nt("applepay.cancel"),"</button>\n        </div>\n      </div>"),modalStyles:function(e){return e.width="calc(100% - 32px)",e.maxWidth="397px",e.padding="24px",e.top="45%",e.borderRadius="8px",e.background="rgba(255, 255, 255, 1)",e.backdropFilter="blur(6px)",e},overlayStyles:function(e){return e.backgroundColor="rgba(0, 0, 0, 0.5)",e.opacity="1",e},modalClass:"sl-payment ".concat(tZ),closeButton:!1,overlayClose:!1,escCloses:!1}).afterCreate(function(e){var t,i,c=e.modalElem();if(!c)throw Error("picoModal instantiated object not found");null===(t=c.querySelector(".".concat(o)))||void 0===t||t.addEventListener("click",function(){e.close(),n(e)}),null===(i=c.querySelector(".".concat(a)))||void 0===i||i.addEventListener("click",function(){e.close(),null==r||r()})}),e.abrupt("return",i);case 5:case"end":return e.stop()}},e)})),function(e){return nh.apply(this,arguments)}),nr=function(e){var t,n=e.node,r=e.domId,o=e.height,a=e.wrapperClass,i=document.createElement("div");i.classList.add("applepay__bg");var c=document.createElement("style");if(no({styleTag:c,domId:r,height:o}),n)return a&&n.classList.add(a),null===(t=n.parentElement)||void 0===t||t.insertBefore(c,n),n.appendChild(i),i},no=function(e){var t=e.styleTag,n=e.domId,r=e.height;t.innerHTML="\n    #".concat(n," applepay__bg {\n        overflow: hidden;\n        text-align: center;\n        height: ").concat(r,"px;\n      }\n    ")};function na(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var ni=["paymentRequest","paymentOptions","paymentSession","version"],nc=["newTotal","newLineItems","newShippingMethods","version","paymentSession","paymentRequest","paymentOptions"];function ns(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ns(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ns(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var nl=function(){var e;function t(e,n){Y(this,t),Z(this,"payClient",null),Z(this,"config",void 0),Z(this,"logger",void 0),Z(this,"payChannelData",void 0),this.config=e,this.logger=n.logger}return G(t,[{key:"setPayChannelData",value:function(e){var t=e.payChannelData,n=t.paymentRequest,r=t.paymentOptions,o=t.paymentSession,a=t.version,i=na(t,ni);this.payChannelData={version:a,paymentRequest:n,paymentOptions:r,paymentSession:o,rest:nu({},i)},e1(this.payChannelData)}},{key:"beforePay",value:function(e){this.logger.info("beforePay",{data:nu({},e)}),this.setPayChannelData(e),this.payChannelData&&(this.payClient=new window.ApplePaySession(this.payChannelData.version,this.payChannelData.paymentRequest,this.payChannelData.paymentOptions))}},{key:"pay",value:(e=H(ee.mark(function e(t){var n=this;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setPayChannelData(t),this.logger.info("pay",{data:nu({},t)}),e.abrupt("return",new Promise(function(e,t){var r,o=tU.Create,a=function(e,t){o=e,n.logger.info("updateCurrentEvent",{data:{eventName:e,reportData:t}})},i=function(e,r){window[window.__sl_console__?"__sl_console__":"console"].error("AP 统一错误处理: ",{error:e,type:en.Pay,extData:r}),n.logger.error("handleError",{action:en.Pay,error:e,data:nu({},r)}),t(e),e$(n.config.onError)&&n.config.onError(e,en.Pay,r)},c=function(){var e=H(ee.mark(function e(t){var r,o,a,c,s,u,l,d,p,f,h,y,m,g,v,b,C,w,O,_,S,P,k,I;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.type,s=t.paymentMethod,u=t.shippingContact,l=t.couponCode,d=t.shippingMethod,p=nu(nu({},n.payChannelData),null===(r=n.payChannelData)||void 0===r?void 0:r.rest)){e.next=5;break}return i(Error("without payChannelData")),e.abrupt("return");case 5:f="unknown",e.t0=c,e.next=e.t0===tU.Paymentmethodselected?9:e.t0===tU.Shippingcontactselected?11:e.t0===tU.Couponcodechanged?14:e.t0===tU.Shippingmethodselected?17:19;break;case 9:return p.newPaymentMethod=s,e.abrupt("break",20);case 11:return p.newShippingContact=u,f="shippingContactInvalid",e.abrupt("break",20);case 14:return p.newCouponCode=l,f="couponCodeInvalid",e.abrupt("break",20);case 17:return p.newShippingMethod=d,e.abrupt("break",20);case 19:return e.abrupt("break",20);case 20:if(e$(n.config.onFormDataChange)){e.next=23;break}return i(Error("without onFormDataChange")),e.abrupt("return");case 23:return delete p.rest,e.next=26,null===(o=(a=n.config).onFormDataChange)||void 0===o?void 0:o.call(a,p,t1[c]).catch(function(e){window[window.__sl_console__?"__sl_console__":"console"].error("onPaymentDataChanged fetch error",e),i(Error("onPaymentDataChanged fetch error"))});case 26:if((h=e.sent)&&!h.error){e.next=29;break}return e.abrupt("return",{errors:[new window.ApplePayError(f,void 0,(null==h||null===(y=h.error)||void 0===y?void 0:y.message)||"update error")],newTotal:null===(m=n.payChannelData)||void 0===m?void 0:m.rest.newTotal,newLineItems:null===(g=n.payChannelData)||void 0===g?void 0:g.rest.newLineItems,newShippingMethods:null===(v=n.payChannelData)||void 0===v?void 0:v.rest.newShippingMethods});case 29:return b=h.newTotal,C=h.newLineItems,w=h.newShippingMethods,O=h.version,_=h.paymentSession,S=h.paymentRequest,P=h.paymentOptions,k=na(h,nc),n.payChannelData={version:O,paymentSession:_,paymentRequest:S,paymentOptions:P,rest:nu(nu({},k),{},{newTotal:b,newShippingMethods:w,newLineItems:C})},e1(n.payChannelData),I={newTotal:b,newLineItems:C,newShippingMethods:w},e.abrupt("return",I);case 34:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();if(!n.payChannelData||!n.payChannelData.paymentSession)return window[window.__sl_console__?"__sl_console__":"console"].error("without payChannelData"),void i(Error("without payChannelData"));try{var s=JSON.parse(window.atob(n.payChannelData.paymentSession)),u=n.payClient,l=n.logger;if(!u)throw Error("No payment instance found");u.onvalidatemerchant=function(){var e=H(ee.mark(function e(t){return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a(tU.Validatemerchant,{event:t,decodeMerchantSession:s}),u.completeMerchantValidation(s);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),u.onpaymentmethodselected=function(){var e=H(ee.mark(function e(t){var n;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a(tU.Paymentmethodselected,{event:t}),e.next=3,c(t);case 3:if(n=e.sent){e.next=6;break}throw Error("no update information");case 6:u.completePaymentMethodSelection(n);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),u.onshippingcontactselected=function(){var e=H(ee.mark(function e(t){var n;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a(tU.Shippingcontactselected,{event:t}),e.next=3,c(t);case 3:if(n=e.sent){e.next=6;break}throw Error("no update information");case 6:n.status=window.ApplePaySession.STATUS_SUCCESS,u.completeShippingContactSelection(n);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),u.onshippingmethodselected=function(){var e=H(ee.mark(function e(t){var n,r;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a(tU.Shippingmethodselected,{event:t}),e.next=3,c(t);case 3:n=e.sent,r=nu(nu({},n),{},{status:window.ApplePaySession.STATUS_SUCCESS}),u.completeShippingMethodSelection(r);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),u.oncouponcodechanged=function(){var e=H(ee.mark(function e(t){var n;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a(tU.Couponcodechanged,{event:t}),e.next=3,c(t);case 3:if(n=e.sent){e.next=6;break}throw Error("no update information");case 6:u.completeCouponCodeChange(n);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),u.onpaymentauthorized=function(){var t=H(ee.mark(function t(r){var o,c,s,d,p,f,h,y,m,g;return ee.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a(tU.Authorize,{event:r}),o=function(e){var t={status:e};l.info("支付",{data:{status:e}}),e===window.ApplePaySession.STATUS_SUCCESS&&u.completePayment(t)},t.prev=2,f=(p=r.payment).billingContact,h=p.shippingContact,y=p.token,e$(n.config.createOrder)){t.next=7;break}return i(Error("onPaymentAuthorized failed, createOrder not triggered")),t.abrupt("return");case 7:return null==(m=nu(nu(nu({},n.payChannelData),null===(c=n.payChannelData)||void 0===c?void 0:c.rest),{},{newShippingContact:h,newBillingContact:f}))||delete m.rest,t.next=11,null===(s=(d=n.config).createOrder)||void 0===s?void 0:s.call(d,n.config.paymentInfo,{payChannelData:m,token:{token:y}});case 11:if((g=t.sent)&&(null==g||!g.error)){t.next=15;break}throw o(window.ApplePaySession.STATUS_FAILURE),Error("Failed to place order");case 15:o(window.ApplePaySession.STATUS_SUCCESS),n.afterCreateOrder(eu.Success),e("onpaymentauthorized"),ty(g.nextAction),t.next=27;break;case 21:t.prev=21,t.t0=t.catch(2),o(window.ApplePaySession.STATUS_FAILURE),n.afterCreateOrder(eu.Fail),window[window.__sl_console__?"__sl_console__":"console"].error("pay failed",t.t0),i(Error("pay failed"));case 27:case"end":return t.stop()}},t,null,[[2,21]])}));return function(e){return t.apply(this,arguments)}}(),u.oncancel=function(){var t=H(ee.mark(function t(r){return ee.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o!==tU.Authorize){t.next=3;break}return window[window.__sl_console__?"__sl_console__":"console"].warn("拿到token后无法再取消支付"),t.abrupt("return");case 3:a(tU.Cancel,{preEvent:o}),e("oncancel"),e$(n.config.onCancel)&&n.config.onCancel(r.sessionError);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),r=setTimeout(function(){e$(n.config.onChannelModalSuccess)&&n.config.onChannelModalSuccess(n.config.paymentInfo)},1e3),u.begin(),n.logger.log("最终拉起Apple Pay的入参",{data:{payChannelData:n.payChannelData}})}catch(e){clearTimeout(r),i(e)}}));case 3:case"end":return e.stop()}},e,this)})),function(t){return e.apply(this,arguments)})},{key:"afterCreateOrder",value:function(e){e$(this.config.afterCreateOrder)&&this.config.afterCreateOrder(e,{channelCode:eo.SLpayments,methodCode:ea.ApplePay})}}]),t}();function nd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function np(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nd(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nd(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var nf,nh,ny,nm,ng,nv=function(e){K(c,e7);var t,n,r,o,a,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=J(c);return e=t?Reflect.construct(n,arguments,J(this).constructor):n.apply(this,arguments),$(this,e)});function c(e){var t,n,r;return Y(this,c),Z(W(r=i.call(this,e)),"name","APPLE_PAY"),Z(W(r),"config",void 0),Z(W(r),"initTime",0),Z(W(r),"element",void 0),Z(W(r),"domId",void 0),Z(W(r),"client",void 0),Z(W(r),"skeleton",void 0),Z(W(r),"disabled",void 0),Z(W(r),"orderData",void 0),Z(W(r),"loading",void 0),Z(W(r),"initSuccess",!0),Z(W(r),"loadResourceFail",!1),Z(W(r),"logger",void 0),r.validate(),r.config=tA(eX(tQ,e)),F.set(null===(t=(n=r.config).loggerFn)||void 0===t?void 0:t.call(n)),r.logger=F.get().pipeOwner("payment-common.SLP-ApplePay").pipeData({domId:"".concat(r.config.props.domId)}),r}return G(c,[{key:"channelSdkInitConfig",get:function(){var e;return JSON.parse((null===(e=this.config.paymentInfo)||void 0===e?void 0:e.channelSdkInitConfig)||"{}")}},{key:"validate",value:function(){return!0}},{key:"handleError",value:function(e,t,n){t!==en.CreateExpected&&this.logger.error("handleError",{action:t,data:{type:t},error:e}),t===en.Init&&(this.initSuccess=!1,this.hideButton()),e$(this.config.onError)&&this.config.onError(e,t,n)}},{key:"beforeInit",value:function(){this.initTime=eQ.now(),e$(this.config.beforeInit)&&this.config.beforeInit()}},{key:"afterInit",value:function(e){try{this.initSuccess=!0,this.showButton();var t=eQ.now()-this.initTime;this.logger.log("afterInit",{data:{data:e,duration:t}}),e$(this.config.afterInit)&&this.config.afterInit()}catch(e){this.handleError(e)}}},{key:"beforeCreateOrder",value:(a=H(ee.mark(function e(){var t,n,r,o,a;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e$(this.config.beforeCreateOrder)){e.next=2;break}return e.abrupt("return");case 2:return n=(t=this.config.paymentInfo).channelCode,r=t.methodCode,o=t.paymentId,e.next=5,this.config.beforeCreateOrder({channelCode:n,methodCode:r,paymentId:o});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},{key:"loadResource",value:function(){var e=this;return new Promise(function(t){em("https://applepay.cdn-apple.com/jsapi/v1/apple-pay-sdk.js",{returnPromise:!0}).then(function(){e.loadResourceFail=!1,t(!0)}).catch(function(n){e.loadResourceFail=!0,e.handleError(Error("Failed to load channel js resource:".concat(n)),en.Init),t(!1)})})}},{key:"canMakePayments",value:function(){var e,t,n=window.ApplePaySession;return!!(n&&n.canMakePayments()&&n.supportsVersion((null===(e=this.channelSdkInitConfig)||void 0===e||null===(t=e.payChannelData)||void 0===t?void 0:t.version)||4))}},{key:"renderButton",value:function(){var e,t,n,r,o,a,i,c,s,u,l;this.element&&this.domId?(o=(n={node:this.element,domId:this.domId,height:null===(e=this.config.props.styleOptions)||void 0===e?void 0:e.height,borderRadius:null===(t=this.config.props.styleOptions)||void 0===t?void 0:t["border-radius"]}).domId,a=n.node,i=n.height,c=n.borderRadius,s=document.createElement("style"),u=document.createElement("div"),a.style.height="".concat(i||43,"px"),u.innerHTML="<apple-pay-button id=".concat(o,' buttonstyle="black" type="plain" locale="en"></apple-pay-button>'),l="\n    #".concat(o," {\n      --apple-pay-button-width: 100%;\n      --apple-pay-button-height: ").concat(i||43,"px;\n      --apple-pay-button-border-radius: 0px;\n      --apple-pay-button-padding: 0px 0px;\n      --apple-pay-button-box-sizing: border-box;\n    }\n\n    .").concat(e5," apple-pay-button {\n      display: none;\n    }\n\n    ").concat("\n    .applepay-confirm-modal-header {\n      margin-bottom: 12px;\n    }\n\n    .applepay-confirm-modal-content {\n      font-family: 'Helvetica Neue';\n      font-style: normal;\n      font-weight: 400;\n      font-size: 16px;\n      line-height: 24px;\n      color: #2c2c2c;\n    }\n\n    .applepay-confirm-modal-action {\n      margin-top: 24px;\n      display: flex;\n      flex-direction: column;\n    }\n\n    .applepay-confirm-modal-action > button {\n      border: 0;\n      text-align: center;\n      border-radius: 4px;\n      cursor: pointer;\n      font-style: normal;\n      line-height: 24px;\n    }\n\n    .applepay-confirm-modal-action-ok {\n      padding: 9px 0;\n      color: #fff;\n      background: #000;\n      font-size: 19px;\n      font-weight: 500;\n    }\n\n    .applepay-confirm-modal-action-ok > span {\n      vertical-align: middle;\n      font-family: 'SF Pro', 'Helvetica Neue';\n    }\n\n    .applepay-confirm-modal-action-ok > svg {\n      vertical-align: middle;\n    }\n\n    .applepay-confirm-modal-action-cancel {\n      padding: 0;\n      margin-top: 24px;\n      color: rgba(44, 44, 44, 0.5);\n      background: transparent;\n      font-size: 16px;\n      font-weight: 500;\n      font-family: 'Helvetica Neue';\n    }\n  ","\n  "),void 0===c&&(l+="\n      #".concat(o," {\n        --apple-pay-button-border-radius: 4px;\n      }\n\n      [data-button_style=square] #").concat(o," {\n        --apple-pay-button-border-radius: 0px;\n      }\n  \n      [data-button_style=rounded] #").concat(o," {\n        --apple-pay-button-border-radius: 9999px;\n      }\n    ")),s.innerHTML=l,null===(r=a.parentElement)||void 0===r||r.insertBefore(s,a),a.appendChild(u),this.removeSkeleton(this.element)):window[window.__sl_console__?"__sl_console__":"console"].error("applepay没有节点")}},{key:"removeSkeleton",value:function(e){var t=this;setTimeout(function(){e&&t.skeleton&&e.removeChild(t.skeleton)},300)}},{key:"openModal",value:function(e){var t=this;nn({ok:function(n){t.beforePay(e),t.pay(e),null==n||n.close(),t.setLoading(!1)},cancel:function(){t.setLoading(!1),t.logger.info("用户取消了支付")}}).then(function(e){t.logger.info("弹窗拉起成功"),e.show()}).catch(function(e){window[window.__sl_console__?"__sl_console__":"console"].error("准备下单失败",e),t.handleError(e,en.Pay)})}},{key:"pay",value:function(e){var t,n=this;this.setLoading(!1),null===(t=this.client)||void 0===t||t.pay(e).then(function(e){n.logger.info("用户支付无异常",{data:{res:e}})}).catch(function(e){window[window.__sl_console__?"__sl_console__":"console"].error("用户支付异常",{error:e}),n.handleError(e,en.Pay)})}},{key:"beforePay",value:function(e){try{var t;null===(t=this.client)||void 0===t||t.beforePay(e)}catch(e){this.setLoading(!1),window[window.__sl_console__?"__sl_console__":"console"].error("准备下单失败",e),this.handleError(e,en.Pay)}}},{key:"getOrderData",value:(o=H(ee.mark(function e(){var t;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforeCreateOrder();case 2:if(t=e.sent,this.logger.log("请求接口获取下单数据",{data:{params:t}}),t){e.next=8;break}return window[window.__sl_console__?"__sl_console__":"console"].error("create order data not found"),this.handleError(Error("create order data not found"),en.Pay),e.abrupt("return");case 8:if(t.paymentConfig){e.next=13;break}return window[window.__sl_console__?"__sl_console__":"console"].error("没有支付信息"),this.handleError(Error("no payment information"),en.Pay),this.setLoading(!1),e.abrupt("return");case 13:return this.orderData=t,e.abrupt("return",t);case 15:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"handleClick",value:(r=H(ee.mark(function e(){var t,n,r,o,a;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.disabled&&!this.loading){e.next=3;break}return this.logger.warn("不可点击apple pay"),e.abrupt("return");case 3:return this.logger.log("applepay onClick"),this.setLoading(!0),(t=this.config.props.expressOptimizationSwitch)&&(n=this.channelSdkInitConfig,r={amount:"99.99",label:"Total",type:"pending"},o=np(np({},n),{},{payChannelData:np(np({},n.payChannelData),{},{paymentRequest:np(np({},n.payChannelData.paymentRequest),{},{total:r,lineItems:[r]})})}),this.beforePay(o)),e.next=9,this.getOrderData();case 9:if((a=e.sent)&&a.paymentConfig){e.next=12;break}return e.abrupt("return");case 12:t?this.pay(a.paymentConfig):this.openModal(a.paymentConfig);case 13:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"bindEvents",value:function(){var e,t=this,n=null===(e=this.element)||void 0===e?void 0:e.querySelector("#".concat(this.domId));n?null==n||n.addEventListener("click",function(){t.handleClick()}):window[window.__sl_console__?"__sl_console__":"console"].error("没有找到applepay节点")}},{key:"render",value:(n=H(ee.mark(function e(){var t,n,r,o,a,i;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this.config).props,o=n.paymentInfo,a=document.getElementById(o.currentDomId)){e.next=5;break}return this.handleError(Error("[onError][Init failed][Cannot find mounted DOM]"),en.Init),e.abrupt("return",null);case 5:return this.domId="".concat(o.currentDomId,"-contain"),this.element=a,this.logger.log("render start",{data:{config:this.config}}),e.next=10,this.loadResource();case 10:if(e.sent){e.next=13;break}return window[window.__sl_console__?"__sl_console__":"console"].error("load applePay resource failed"),e.abrupt("return");case 13:return e.next=15,this.canMakePayments();case 15:if(e.sent){e.next=20;break}return this.handleError(Error("Cannot use applePay"),en.Init),window[window.__sl_console__?"__sl_console__":"console"].error("Cannot use applePay"),e.abrupt("return");case 20:if(this.beforeInit(),i=nr({node:a,domId:this.domId,height:(null===(t=r.styleOptions)||void 0===t?void 0:t.height)||"",wrapperClass:r.wrapperClass,wrapperStyle:r.wrapperStyle}),this.skeleton=i,this.renderButton(),this.client=new nl(this.config,{logger:this.logger}),this.client){e.next=28;break}return window[window.__sl_console__?"__sl_console__":"console"].error("new Client失败"),e.abrupt("return");case 28:return this.afterInit(),this.bindEvents(),e.abrupt("return",this.client);case 31:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"setDisabled",value:function(e){if(this.element)try{if(this.disabled=e,e)return void this.element.classList.add(e4);this.element.classList.remove(e4)}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("此处报错不影响功能，无需关注",e)}}},{key:"setLoading",value:function(e){if(this.element)try{if(this.disabled=e,e)return void this.element.classList.add(e5);this.element.classList.remove(e5)}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("此处报错不影响功能，无需关注",e)}}}]),c}();(nH=ny||(ny={})).GooglePay="googlePay",nH.ApplePay="applePay",nH.Link="link",nH.BrowserCard="browserCard",(nY=nm||(nm={})).Default="default",nY.Square="square",nY.Rounded="rounded";var nb=[ny.ApplePay,ny.GooglePay,ny.Link,ny.BrowserCard],nC=(Z(ng={},nm.Default,4),Z(ng,nm.Rounded,9999),Z(ng,nm.Square,0),ng),nw=function(e,t,n){if(e){var r=e.contains(t);n&&!r?e.add(t):!n&&r&&e.remove(t)}},nO=function(){function e(t,n){var r=this;Y(this,e),Z(this,"container",void 0),Z(this,"insertStyle",function(e){if(r.container){var t=document.createElement("style");t.innerHTML="\n      .".concat(e5," .__PrivateStripeElement {\n        display: none !important;\n        visibility: hidden;\n      }\n    "),e.height&&(r.container.style.height="".concat(e.height,"px")),r.container.parentElement&&r.container.parentElement.insertBefore(t,r.container)}}),this.container=t,this.insertStyle(n)}return G(e,[{key:"setDisabled",value:function(e){nw(this.container.classList,e4,e)}},{key:"setLoading",value:function(e){nw(this.container.classList,e5,e)}}]),e}();function n_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?n_(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):n_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var nP=function(e){return(e||"").toLowerCase()},nk=function(e,t){return{label:"Total",amount:e,pending:t}},nI=function(e){return e===ny.ApplePay},nE=function(e){K(l,e7);var t,n,r,o,a,i,c,s,u=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=J(l);return e=t?Reflect.construct(n,arguments,J(this).constructor):n.apply(this,arguments),$(this,e)});function l(e){var t,n,r;return Y(this,l),Z(W(r=u.call(this,e)),"config",void 0),Z(W(r),"payChannelData",null),Z(W(r),"instance",null),Z(W(r),"paymentRequest",null),Z(W(r),"prButton",null),Z(W(r),"buttonElement",null),Z(W(r),"paymentMethod",null),Z(W(r),"confirmModalLoadState",null),Z(W(r),"disabled",!1),Z(W(r),"loading",!1),Z(W(r),"initSuccess",!0),Z(W(r),"loadResourceFail",!1),Z(W(r),"initTime",0),Z(W(r),"logger",void 0),r.config=e,F.set(null===(t=(n=r.config).loggerFn)||void 0===t?void 0:t.call(n)),r.logger=F.get().pipeOwner("payment-common.StripeOther").pipeData({domId:"".concat(r.config.props.domId)}),r}return G(l,[{key:"render",value:(s=H(ee.mark(function e(){return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.beforeInit(),e.next=3,this.init();case 3:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},{key:"init",value:(c=H(ee.mark(function e(){var t,n,r,o;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.paymentMethod=ny[this.config.paymentInfo.methodCode]||null,e.next=3,this.loadChannelJs();case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:if(this.createStripeInstance(),!this.paymentRequest){e.next=23;break}return t=eQ.now(),e.next=11,this.paymentRequest.canMakePayment();case 11:if(n=e.sent,r=eQ.now()-t,o={canMakePaymentResult:n,paymentMethod:this.paymentMethod,taken:r},this.logger.info("canMakePaymentResult",{data:{logInfo:o}}),window[window.__sl_console__?"__sl_console__":"console"].log("canMakePaymentResult:",o),!(this.paymentMethod&&n&&n[this.paymentMethod])){e.next=21;break}this.renderButton(),this.afterInit(),e.next=23;break;case 21:return this.handleError(Error("The current browser does not support this payment method"),en.Init,{canMakePaymentResult:n}),e.abrupt("return");case 23:case"end":return e.stop()}},e,this)})),function(){return c.apply(this,arguments)})},{key:"beforeInit",value:function(){this.initTime=eQ.now(),e$(this.config.beforeInit)&&this.config.beforeInit()}},{key:"afterInit",value:function(){this.initSuccess=!0,this.showButton();var e=eQ.now()-this.initTime;this.logger.log("afterInit",{data:{duration:e}}),e$(this.config.afterInit)&&this.config.afterInit()}},{key:"onChannelModalSuccess",value:function(){e$(this.config.onChannelModalSuccess)&&this.config.onChannelModalSuccess(this.config.paymentInfo)}},{key:"beforeCreateOrder",value:(i=H(ee.mark(function e(){var t,n,r,o,a;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e$(this.config.beforeCreateOrder)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.confirmModalLoadState;case 4:return n=(t=this.config.paymentInfo).channelCode,r=t.methodCode,o=t.paymentId,e.next=7,this.config.beforeCreateOrder({channelCode:n,methodCode:r,paymentId:o});case 7:return a=e.sent,e.abrupt("return",a);case 9:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"afterCreateOrder",value:function(e){e$(this.config.afterCreateOrder)&&this.config.afterCreateOrder(e,{channelCode:eo.StripeOther,methodCode:this.config.paymentInfo.methodCode})}},{key:"setDisabled",value:function(e){this.disabled=e,this.buttonElement&&this.buttonElement.setDisabled(e)}},{key:"setLoading",value:function(e){this.loading=e,this.buttonElement&&this.buttonElement.setLoading(e)}},{key:"loadChannelJs",value:function(){var e=this;return new Promise(function(t){em("https://js.stripe.com/v3/",{returnPromise:!0}).then(function(){e.loadResourceFail=!1,t(!0)}).catch(function(n){e.loadResourceFail=!0,e.handleError(Error("Failed to load channel js resource: ".concat(n)),en.Init),t(!1)})})}},{key:"createStripeInstance",value:function(){var e=this;try{var t=this.config.paymentInfo,n=t.configData,r=n.publicApiKey,o=n.stripeApiVersion,a=n.accountId,i=n.accountCountry,c=t.channelSdkInitConfig,s=this.config.paymentInfo.settleCurrency||"",u=nb.filter(function(t){return t!==e.paymentMethod}),l={};try{l=JSON.parse(c)}catch(e){this.logger.error("解析渠道配置JSON字符串失败",{error:e,data:{channelSdkInitConfig:c}})}this.instance=window.Stripe(void 0===r?"":r,{apiVersion:o,stripeAccount:a});var d=this.instance.paymentRequest(nS(nS({},l),{},{currency:nP(s),country:void 0===i?"":i,total:nk(9999,!0),disableWallets:u}));this.paymentRequest=d}catch(e){this.handleError(Error("Failed to create channel instance"),en.Init,{channelMsg:e.message})}}},{key:"onPaymentAuthorized",value:(a=H(ee.mark(function e(t){var n,r,o,a,i,c,s,u,l,d,p,f,h=this;return ee.wrap(function(e){for(var y;;)switch(e.prev=e.next){case 0:if(e$(n=this.config.createOrder)){e.next=3;break}return e.abrupt("return");case 3:return r=t.paymentMethod,o=t.shippingAddress,a=t.shippingOption,i=t.payerName,c=t.payerPhone,s=t.payerEmail,l=void 0===(u=r.id)?"":u,d=r.billing_details,p=nS(nS({},this.payChannelData),{},{paymentMethod:l,billing_details:d,shippingAddress:o,shippingOption:a,payerInfo:{name:i,phone:c,email:s}}),e.prev=6,e.next=9,n(this.config.paymentInfo,{payChannelData:p,token:p});case 9:if(!(y=f=e.sent)||!y.error){e.next=13;break}throw f.error;case 13:return e.next=15,ty(f.nextAction,{payOptions:{hooks:{channelConfirm:function(e){return h.channelConfirm(e,t)}}}});case 15:e.next=22;break;case 17:e.prev=17,e.t0=e.catch(6),t.complete("fail"),this.handleError(e.t0,en.Pay),this.afterCreateOrder(eu.Fail);case 22:case"end":return e.stop()}},e,this,[[6,17]])})),function(e){return a.apply(this,arguments)})},{key:"channelConfirm",value:(o=H(ee.mark(function e(t,n){var r,o,a;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(null===(r=t.data)||void 0===r?void 0:r.clientSecret)||"",this.instance){e.next=3;break}throw Error("stripe instance not found");case 3:if(o){e.next=9;break}if(!t.nextAction){e.next=8;break}return e.next=7,ty(t.nextAction);case 7:return e.abrupt("return");case 8:throw Error("The interface does not return clientSecret, and the sdk`s confirm cannot be called");case 9:return e.prev=9,e.next=12,this.instance.confirmCardPayment(o);case 12:(a=e.sent.error)?(n.complete("fail"),this.afterCreateOrder(eu.Fail),this.handleError(Error("confirm error"),en.Pay,{error:a,clientSecret:o})):(n.complete("success"),this.afterCreateOrder(eu.Success));case 15:if(e.prev=15,!t.nextAction){e.next=19;break}return e.next=19,ty(t.nextAction);case 19:return e.finish(15);case 20:case"end":return e.stop()}},e,this,[[9,,15,20]])})),function(e,t){return o.apply(this,arguments)})},{key:"renderButton",value:function(){if(this.instance&&this.paymentRequest)try{var e,t,n=document.getElementById(this.config.paymentInfo.currentDomId);if(!n)throw Error("Container not found: #".concat(this.config.paymentInfo.currentDomId));var r=this.instance.elements(),o=null===(e=this.config.props.styleOptions)||void 0===e?void 0:e.height;if(nI(this.paymentMethod)){var a,i=document.createElement("style");i.innerHTML="\n    .applepay-confirm-modal-header {\n      margin-bottom: 12px;\n    }\n\n    .applepay-confirm-modal-content {\n      font-family: 'Helvetica Neue';\n      font-style: normal;\n      font-weight: 400;\n      font-size: 16px;\n      line-height: 24px;\n      color: #2c2c2c;\n    }\n\n    .applepay-confirm-modal-action {\n      margin-top: 24px;\n      display: flex;\n      flex-direction: column;\n    }\n\n    .applepay-confirm-modal-action > button {\n      border: 0;\n      text-align: center;\n      border-radius: 4px;\n      cursor: pointer;\n      font-style: normal;\n      line-height: 24px;\n    }\n\n    .applepay-confirm-modal-action-ok {\n      padding: 9px 0;\n      color: #fff;\n      background: #000;\n      font-size: 19px;\n      font-weight: 500;\n    }\n\n    .applepay-confirm-modal-action-ok > span {\n      vertical-align: middle;\n      font-family: 'SF Pro', 'Helvetica Neue';\n    }\n\n    .applepay-confirm-modal-action-ok > svg {\n      vertical-align: middle;\n    }\n\n    .applepay-confirm-modal-action-cancel {\n      padding: 0;\n      margin-top: 24px;\n      color: rgba(44, 44, 44, 0.5);\n      background: transparent;\n      font-size: 16px;\n      font-weight: 500;\n      font-family: 'Helvetica Neue';\n    }\n  ",null===(a=n.parentElement)||void 0===a||a.insertBefore(i,n)}var c=null===(t=this.config.props.styleOptions)||void 0===t?void 0:t["border-radius"];if(void 0===c){var s,u=document.querySelector("[data-button_style]"),l=null==u?void 0:u.getAttribute("data-button_style");this.logger.info("buttonStyle",{data:{buttonStyle:l}}),c=null!==(s=nC[l])&&void 0!==s?s:nC.default}var d={height:o?"".concat(o,"px"):"",theme:"dark",borderRadius:"".concat(c,"px")},p=r.create("paymentRequestButton",{paymentRequest:this.paymentRequest,style:{paymentRequestButton:d}});this.prButton=p,this.initButtonListener(this.paymentRequest,this.prButton),this.buttonElement=new nO(n,{height:o}),this.prButton.mount(n);var f=n.querySelector(".__PrivateStripeElement");f&&(f.style.display="block")}catch(e){this.handleError(Error("Failed to render button"),en.Init,{channelMsg:e.message})}}},{key:"initButtonListener",value:function(e,t){var n,r=this;e.on("shippingaddresschange",function(e){var t=e.shippingAddress,n=e.updateWith;r.handleFormDataChange(el.ChangeAddress,{shippingAddress:t},n)}),e.on("shippingoptionchange",(n=H(ee.mark(function e(t){var n,o;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.shippingOption,o=t.updateWith,r.handleFormDataChange(el.ChangeDeliveryMethod,{shippingOption:n},o);case 2:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)})),e.on("cancel",function(){r.logger.info("用户关闭渠道支付弹窗")}),e.on("paymentmethod",this.onPaymentAuthorized.bind(this)),t.on("click",function(e){e.preventDefault(),r.handleStripeOtherButtonClick()})}},{key:"handleFormDataChange",value:(r=H(ee.mark(function e(t,n,r){var o,a,i,c,s,u,l,d;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.info("handleFormDataChange: ".concat(t),{data:{params:n}}),e$(o=this.config.onFormDataChange)){e.next=5;break}return r({status:"fail"}),e.abrupt("return");case 5:return e.prev=5,e.next=8,o(nS(nS({},this.payChannelData),n),t);case 8:if((a=e.sent)&&!a.error){e.next=11;break}throw Error(null==a||null===(i=a.error)||void 0===i?void 0:i.message);case 11:if(this.payChannelData=a,u=void 0===(s=(c=this.payChannelData).amount)?0:s,l=c.shippingOptions,d=c.displayItems,null!=l&&l.length){e.next=16;break}return r({status:"invalid_shipping_address"}),e.abrupt("return");case 16:r({status:"success",total:nk(u,!1),displayItems:d,shippingOptions:l}),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),r({status:"fail"}),this.handleError(Error("Failed to update abandonedOrder info"),en.Pay,{error:e.t0});case 23:case"end":return e.stop()}},e,this,[[5,19]])})),function(e,t,n){return r.apply(this,arguments)})},{key:"handleStripeOtherButtonClick",value:(n=H(ee.mark(function e(){var t,n,r,o,a,i,c,s,u=this;return ee.wrap(function(e){for(var l;;)switch(e.prev=e.next){case 0:if(this.instance&&this.paymentRequest&&!this.loading&&!this.disabled){e.next=2;break}return e.abrupt("return");case 2:return t=this.config.props.expressOptimizationSwitch,n=function(){var e=null;try{u.paymentRequest&&(e=setTimeout(function(){u.onChannelModalSuccess()},1e3),u.paymentRequest.show(),u.logger.info("弹窗拉起成功"))}catch(t){e&&(clearTimeout(e),e=null),u.handleError(Error("Failed to pull up the channel"),en.PullUpChannel,{error:t})}},this.setLoading(!0),nI(this.paymentMethod)&&t&&setTimeout(function(){n()}),e.next=8,this.beforeCreateOrder().catch(function(e){u.handleError(e,en.PullUpChannel)});case 8:if(r=e.sent,this.setLoading(!1),(l=r)&&!1!==l.valid&&r.paymentConfig&&r.paymentConfig.payChannelData){e.next=13;break}return e.abrupt("return");case 13:a=(o=r.paymentConfig.payChannelData).amount,i=o.currency,c=o.shippingOptions,s=o.displayItems,this.payChannelData=nS({},o),this.logger.info("更新渠道弹窗信息",{data:{amount:a,shippingOptions:c,displayItems:s}}),this.paymentRequest.update({currency:nP(i),total:nk(a,!1),shippingOptions:c,displayItems:s}),nI(this.paymentMethod)?t||nn({ok:n,cancel:function(){u.logger.info("用户取消了支付")}}).then(function(e){e.show()}).catch(function(e){u.handleError(e,en.Pay)}):setTimeout(function(){n()});case 19:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"handleError",value:function(e,t,n){window[window.__sl_console__?"__sl_console__":"console"].error("StripeOther 统一错误处理：",{error:e,type:t,extData:n}),t!==en.CreateExpected&&this.logger.error("handleError",{action:t,error:e,data:nS({},n)}),t===en.Init&&(this.initSuccess=!1,this.hideButton()),e$(this.config.onError)&&this.config.onError(e,t,n)}}]),l}(),nx=function(e){K(r,nE);var t,n=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=J(r);return e=t?Reflect.construct(n,arguments,J(this).constructor):n.apply(this,arguments),$(this,e)});function r(e){var t;return Y(this,r),Z(W(t=n.call(this,e)),"name","GOOGLE_PAY"),t}return G(r)}(),nT=function(e){K(r,nE);var t,n=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=J(r);return e=t?Reflect.construct(n,arguments,J(this).constructor):n.apply(this,arguments),$(this,e)});function r(e){var t;return Y(this,r),Z(W(t=n.call(this,e)),"name","APPLE_PAY"),t}return G(r)}();function nA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nA(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var nD=function(e){var t,n,r,o=e.paymentInfo,a=o.configData,i=o.channelSdkInitConfig,c=o.captureInfo.autoCapture,s=e.props.payMode===er.Continue,u=e.props.isSubscription,l=(t=JSON.parse(i),n="",r=function(e){var t=e.key,r=e.value,o=e.isCoverAll,a=e.whitelist,i=e.blacklist,c=(Shopline||{}).storeId;o?Array.isArray(i)&&!i.includes(c)&&(n=te(n,Z({},t,r))):Array.isArray(a)&&a.includes(c)&&(n=te(n,Z({},t,r)))},Array.isArray(t)&&(null==t||t.forEach(function(e){e.scope===er.All?r(e):(s&&e.scope===er.Continue&&r(e),s||e.scope!==er.PayNow||r(e))})),n);return te(l,nL(nL({},{currency:e.paymentInfo.settleCurrency||"USD",commit:!!s,"merchant-id":a.paypalMerchantId,"client-id":a.clientId}),u?{intent:"tokenize",vault:!0}:{intent:c?"capture":"authorize"}))},nj=function(e){if(null!=e&&e.paymentInfo){var t=e.paymentInfo.configData;e.props=nL(nL({},e.props),{},{queryParams:nD(e)},t)}return e},nN=function(e,t){var n,r=t.props.isSubscription;return{abandonedOrderInfo:e.abandonedOrderInfo,orderFrom:e.orderFrom||e.abandonedOrderInfo.orderFrom,channelCode:eo.Paypal,spbCurrencyCode:t.paymentInfo.settleCurrency,payInfo:{cancelUrl:window.location.href,returnUrl:e.returnUrl,captureInfo:null===(n=t.paymentInfo)||void 0===n?void 0:n.captureInfo,paymentScenes:r?ef.PAY_AND_BIND:ef.PAY_NORMAL},dataReportReq:e.dataReportReq}},nB=function(e){var t=Math.floor(e);return t>=5e3&&t<=1e4?"warn":t>1e4?"error":"info"};function nR(e){var t;return(Z(t={},"".concat(eo.Paypal,"-").concat(ea.Paypal),{validate:function(){return e.props&&eJ(e.props)?{result:!0}:{result:!1,errorTip:"props illegal"}},getConfig:function(){return e},component:nZ}),Z(t,"".concat(eo.SLpayments,"-").concat(ea.GooglePay),{validate:function(){return e.props&&eJ(e.props)?{result:!0}:{result:!1,errorTip:"props illegal"}},getConfig:function(){return e},component:tE}),Z(t,"".concat(eo.SLpayments,"-").concat(ea.ApplePay),{validate:function(){return e.props&&eJ(e.props)?{result:!0}:{result:!1,errorTip:"props illegal"}},getConfig:function(){return e},component:nv}),Z(t,"".concat(eo.StripeOther,"-").concat(ea.ApplePay),{validate:function(){return e.props&&eJ(e.props)?{result:!0}:{result:!1,errorTip:"props illegal"}},getConfig:function(){return e},component:nT}),Z(t,"".concat(eo.StripeOther,"-").concat(ea.GooglePay),{validate:function(){return e.props&&eJ(e.props)?{result:!0}:{result:!1,errorTip:"props illegal"}},getConfig:function(){return e},component:nx}),t)["".concat(e.channelCode,"-").concat(e.paymentInfo.methodCode)]}function nM(e){var t=!0;return e&&e.type||(t=!1),t}function nF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nU(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nF(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nF(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var nH,nY,nV,nq=function(e){var t,n=e.node,r=e.domId,o=e.height,a=e.isContinueMode,i=e.isVerticalLayout,c=e.wrapperClass,s=e.wrapperStyle,u=document.createElement("div");u.classList.add("paypal__skeleton--animated");var l=document.createElement("style");if(nG({styleTag:l,domId:r,height:o,isContinueMode:a,isVerticalLayout:i}),n){if(c&&n.classList.add(c),s){var d,p,f={},h=(null===(p=n.getAttribute("style"))||void 0===p?void 0:p.replace(/\s+/g,""))||"",y=function(e){var t={};return e.split(";").forEach(function(e){var n=eK(e.split(":"),2),r=n[0],o=n[1],a=null==r?void 0:r.replace(/-[^0-9]/g,function(e){return e.charAt(1).toUpperCase()});a&&(t[a]=o)}),t};"string"==typeof s?f=nU(nU({},y(h)),y(s)):"object"===b(s)&&(f=nU(nU({},y(h)),s)),n.style="object"!==b(d=f)?"":Object.entries(d).map(function(e){return e.join(":")}).join(";").replace(/[A-Z]/g,function(e){return"-".concat(e.charAt(0).toLowerCase())})}return null===(t=n.parentElement)||void 0===t||t.insertBefore(l,n),n.appendChild(u),u}},nG=function(e){var t=e.styleTag,n=e.domId,r=e.height,o=e.isContinueMode,a=e.isVerticalLayout;t.innerHTML=o&&!a?"\n        #".concat(n," {\n          overflow: hidden;\n          text-align: center;\n          height: ").concat(r,"px;\n          z-index: 1;\n        }\n        /** paypal background color */\n        #").concat(n,".paypal__bg::before,\n        #").concat(n,".paypal__bg::after {\n          content:'';\n          position: absolute;\n          top: 0;\n          bottom: 0;\n          left: 0;\n          width: calc(50% - 3px);\n          border-radius: 4px;\n          background-color: #ffc439;\n        }\n        #").concat(n,".paypal__bg::after {\n          left: unset;\n          right: 0;\n        }\n        [data-button_style=square] #").concat(n,".paypal__bg::before,\n        [data-button_style=square] #").concat(n,".paypal__bg::after{\n          border-radius: 0 !important;\n        }\n        [data-button_style=rounded] #").concat(n,".paypal__bg{\n          border-radius: 9999px !important;\n        }\n      "):"\n        #".concat(n," {\n          min-height: ").concat(r,"px;\n        }\n        "),t.innerHTML+="\n      #".concat(n," {\n        position: relative;\n        user-select: none;\n      }\n      #").concat(n," .paypal__skeleton--animated {\n        margin: 0 auto;\n        border-radius: 4px;\n        width: 100%;\n        height: ").concat(r,"px;\n        position: absolute;\n      }\n\n      .paypal__skeleton--animated {\n        background: linear-gradient(").concat("90deg, hsla(0, 0%, 74.5%, 0.2) 25%, hsla(0, 0%, 50.6%, 0.24) 37%, hsla(0, 0%, 74.5%, 0.2) 63%",");\n        background-size: 400% 100%;\n        animation: skeleton 2s linear infinite;\n      }\n\n      ").concat("\n            @keyframes skeleton {\n              0% {\n                background-position: 100% 50%;\n              }\n              100% {\n                background-position: 0 50%;\n              }\n            }\n          ","\n      ")};function nW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nz(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nW(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nW(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var nK,n$={loadingStatus:es.Await,info:{},promise:null},nJ=function(e){K(s,e7);var t,n,r,o,a,i,c=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=J(s);return e=t?Reflect.construct(n,arguments,J(this).constructor):n.apply(this,arguments),$(this,e)});function s(e){var t,n;return Y(this,s),Z(W(n=c.call(this,e)),"name","PAY_PAL"),Z(W(n),"config",void 0),Z(W(n),"payMode",void 0),Z(W(n),"isHidePayPalButton",void 0),Z(W(n),"isRendered",void 0),Z(W(n),"element",void 0),Z(W(n),"initTimer",void 0),Z(W(n),"initActions",void 0),Z(W(n),"createOrderParams",void 0),Z(W(n),"returnUrl",void 0),Z(W(n),"orderInfoMap",{}),Z(W(n),"initTime",0),Z(W(n),"skeleton",void 0),Z(W(n),"initSuccess",!0),Z(W(n),"loadResourceFail",!1),Z(W(n),"logger",void 0),Z(W(n),"dynamicJsonpCallback",function(e){n$=nz(nz({},n$),{},{info:e,loadingStatus:es.Done}),n.handleDynamicNotify(e)}),n.payMode=e.props.payMode||er.Continue,n.returnUrl="",F.set(null===(t=e.loggerFn)||void 0===t?void 0:t.call(e)),n.logger=F.get().pipeOwner("payment-common.PayPal").pipeData({domId:"".concat(e.props.domId)}),n.config=nj(eX(ev,e)),n.handleDomHeight(),n.validate(e)?n:$(n)}return G(s,[{key:"validate",value:function(e){var t=nR(e);if(!t)return!1;var n=t.validate(),r=n.result,o=n.errorTip;return!!r||(this.logger.error("constructor error ".concat(o)),!1)}},{key:"handleDomHeight",value:function(){var e,t=(null===(e=this.config.props.styleOptions)||void 0===e?void 0:e.height)||45;t>55&&(this.logger.warn("按钮高度传入异常",{data:{height:t}}),t=55),t<25&&(this.logger.warn("按钮高度传入异常",{data:{height:t}}),t=25),this.config.props.styleOptions=nz(nz({},this.config.props.styleOptions),{},{height:t})}},{key:"isContinueMode",get:function(){return this.payMode===er.Continue}},{key:"isVerticalLayout",get:function(){var e;return"vertical"===(null===(e=this.config.props.styleOptions)||void 0===e?void 0:e.layout)}},{key:"isSubscription",get:function(){return this.config.props.isSubscription}},{key:"handleError",value:function(e,t,n){this.initTimer&&clearTimeout(this.initTimer),t!==en.CreateExpected&&this.logger.error("handleError",{action:t,error:e,data:{type:t,extData:n},tags:null==n?void 0:n.tags}),t===en.Init&&(this.initSuccess=!1,this.hideButton()),e$(this.config.onError)&&this.config.onError(e,t,n)}},{key:"handleDynamicNotify",value:function(e){var t=(e||{}).paypal;this.isHidePayPalButton=!t,t||(e$(this.config.onDynamicNotify)&&this.config.onDynamicNotify(nz(nz({},e),{},{isHidePayPalButton:!0})),this.handleError(Error("Dynamic button loading failed"),en.Init))}},{key:"handleDynamic",value:(i=H(ee.mark(function e(){var t,n,r=this;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Z(t={},es.Done,function(){r.handleDynamicNotify(n$.info)}),Z(t,es.Fail,function(){}),Z(t,es.Pending,H(ee.mark(function e(){return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n$.promise;case 2:r.handleDynamicNotify(n$.info);case 3:case"end":return e.stop()}},e)}))),Z(t,es.Await,function(){return n$.loadingStatus=es.Pending,window[eg]=r.dynamicJsonpCallback,n$.promise=em(["https://www.paypal.com/checkoutnow/remembered?callback=".concat(eg)],{returnPromise:!0}).catch(function(){r.loadResourceFail=!0,r.handleError(Error("[Failed to load remember script]:".concat(eg)),en.Init)}),n$.promise}),n=t[n$.loadingStatus],e.abrupt("return",n());case 3:case"end":return e.stop()}},e)})),function(){return i.apply(this,arguments)})},{key:"handlePay",value:function(e){var t=e.nextAction,n=e.context,r=(void 0===n?{returnUrl:""}:n).returnUrl;if(this.returnUrl=r,this.isSubscription){var o=t.data.popupData.tokenId;return this.orderInfoMap[o||""]={returnUrl:r},o||""}var a=t.data.popupData.id;return this.orderInfoMap[a||""]={returnUrl:r},a||""}},{key:"continueMode",value:(a=H(ee.mark(function e(t,n){var r,o,a,i,c,s,u,l,d,p,f,h;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.createOrderParams&&!1!==this.createOrderParams.valid){e.next=2;break}return e.abrupt("return","");case 2:return e.prev=2,s=nN(this.createOrderParams,this.config),e.next=6,eG.post("/leproxy/api/trade/center/pay/fast-checkout/prepare-pay",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eW(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eW(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},s));case 6:if(null==(l=null===(r=(u=e.sent).data)||void 0===r?void 0:r.data)||!l.errorInfo){e.next=11;break}return this.handleError(Error("Place order failed"),en.CreateExpected,{errorInfo:null==l?void 0:l.errorInfo}),e.abrupt("return","");case 11:if(!(d=(null===(o=u.data)||void 0===o?void 0:o.code)||(null===(a=u.data)||void 0===a||null===(i=a.data)||void 0===i||null===(c=i.paymentError)||void 0===c?void 0:c.code))||"SUCCESS"===d){e.next=15;break}return this.handleError(Error("prepare-pay request failed"),en.Pay,{tags:{code:d},res:u.data}),e.abrupt("return","");case 15:if(nM(p=JSON.parse((null==l?void 0:l.nextAction)||"{}"))){e.next=19;break}return this.handleError(Error("prepare-pay response illegal"),en.Pay,{res:u.data}),e.abrupt("return","");case 19:return f={nextAction:p,context:null==l?void 0:l.context},this.logger.info("continueMode",{data:{data:l,payOptions:f,actions:n}}),e.next=23,this.handlePay(f);case 23:return(h=e.sent)&&e$(this.config.onChannelModalSuccess)&&this.config.onChannelModalSuccess(this.config.paymentInfo),e.abrupt("return",h);case 28:return e.prev=28,e.t0=e.catch(2),this.handleError(e.t0,en.Pay),e.abrupt("return","");case 32:case"end":return e.stop()}},e,this,[[2,28]])})),function(e,t){return a.apply(this,arguments)})},{key:"payNowMode",value:(o=H(ee.mark(function e(t,n){var r;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!e$(this.config.createOrder)){e.next=13;break}return e.next=4,this.config.createOrder(this.config.paymentInfo,t,n);case 4:if(r=e.sent,this.logger.info("payNowMode，createOrder 入参",{data:nz({},r)}),!1!==r.valid){e.next=9;break}return this.logger.log("业务方入参异常，中断流程",{data:nz({},r)}),e.abrupt("return","");case 9:if(nM(null==r?void 0:r.nextAction)){e.next=12;break}return this.handleError(Error("prepare-pay response illegal"),en.Pay,{res:r}),e.abrupt("return","");case 12:return e.abrupt("return",this.handlePay(r));case 13:return e.abrupt("return","");case 16:return e.prev=16,e.t0=e.catch(0),this.handleError(e.t0,en.Pay),e.abrupt("return","");case 20:case"end":return e.stop()}},e,this,[[0,16]])})),function(e,t){return o.apply(this,arguments)})},{key:"handleRenderTimeout",value:function(e){var t,n,r=this;nV&&(nV.disconnect(),nV=null),this.initTimer=setTimeout(function(){var t,n,o,a;r.element&&(r.element.innerHTML=""),nV=new(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)(function(e){e.forEach(function(){r.element&&(r.element.innerHTML="")})}),r.element&&nV.observe(r.element,{childList:!0,attributes:!1,subtree:!1}),setTimeout(function(){nV&&(nV.disconnect(),nV=null)},5e3),r.handleError(Error("[Init rendering failed][Call onInit timeout][Current timeout time: ".concat(null===(t=r.config.props)||void 0===t||null===(n=t.timeout)||void 0===n?void 0:n.delay,"ms]")),en.Init),e(Error("[Init rendering failed][Call onInit timeout][Current timeout time: ".concat(null===(o=r.config.props)||void 0===o||null===(a=o.timeout)||void 0===a?void 0:a.delay,"ms]")))},null===(t=this.config.props)||void 0===t||null===(n=t.timeout)||void 0===n?void 0:n.delay)}},{key:"setDisabled",value:function(e){if(this.element)try{if(e)return this.initActions&&this.initActions.disable(),void this.element.classList.add(e4);this.initActions&&this.initActions.enable(),this.element.classList.remove(e4)}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("此处报错不影响功能，无需关注",e)}}},{key:"beforeInit",value:function(){this.initTime=eQ.now(),e$(this.config.beforeInit)&&this.config.beforeInit()}},{key:"afterInit",value:function(e,t){try{this.initSuccess=!0,this.showButton();var n=eQ.now()-this.initTime;this.logger.info("afterInit",{data:{data:e,actions:t,duration:n,level:nB(n)}}),e$(this.config.afterInit)&&this.config.afterInit()}catch(e){this.handleError(e)}}},{key:"beforeCreateOrder",value:(r=H(ee.mark(function e(){var t,n,r,o,a;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e$(this.config.beforeCreateOrder)){e.next=2;break}return e.abrupt("return");case 2:return n=(t=this.config.paymentInfo).channelCode,r=t.methodCode,o=t.paymentId,e.next=5,this.config.beforeCreateOrder({channelCode:n,methodCode:r,paymentId:o});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"afterCreateOrder",value:function(e){e$(this.config.afterCreateOrder)&&this.config.afterCreateOrder(e,{channelCode:eo.Paypal,methodCode:ea.Paypal})}},{key:"removeSkeleton",value:function(e){var t=this;setTimeout(function(){e&&(t.skeleton&&e.removeChild(t.skeleton),t.isContinueMode&&e.classList.add("paypal__bg"))},300)}},{key:"specialParamsByScenes",get:function(){var e,t,n=this;return this.isSubscription?{actions:{createBillingAgreement:(e=H(ee.mark(function e(t,r){var o;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.logger.log("createBillingAgreement PayPal开始下单",{data:{data:t,actions:r}}),e.prev=1,!n.isContinueMode){e.next=8;break}return e.next=5,n.continueMode(t,r);case 5:e.t1=e.sent,e.next=11;break;case 8:return e.next=10,n.payNowMode(t,r);case 10:e.t1=e.sent;case 11:if(e.t0=e.t1,e.t0){e.next=14;break}e.t0="";case 14:return o=e.t0,n.afterCreateOrder(o?eu.Success:eu.Fail),e.abrupt("return",o);case 19:return e.prev=19,e.t2=e.catch(1),n.afterCreateOrder(eu.Fail),e.abrupt("return","");case 23:case"end":return e.stop()}},e,null,[[1,19]])})),function(t,n){return e.apply(this,arguments)})}}:{actions:{createOrder:(t=H(ee.mark(function e(t,r){var o;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.logger.log("createOrder PayPal开始下单",{data:{data:t,actions:r}}),e.prev=1,!n.isContinueMode){e.next=8;break}return e.next=5,n.continueMode(t,r);case 5:e.t1=e.sent,e.next=11;break;case 8:return e.next=10,n.payNowMode(t,r);case 10:e.t1=e.sent;case 11:if(e.t0=e.t1,e.t0){e.next=14;break}e.t0="";case 14:return o=e.t0,n.afterCreateOrder(o?eu.Success:eu.Fail),e.abrupt("return",o);case 19:return e.prev=19,e.t2=e.catch(1),n.afterCreateOrder(eu.Fail),e.abrupt("return","");case 23:case"end":return e.stop()}},e,null,[[1,19]])})),function(e,n){return t.apply(this,arguments)})}}}},{key:"render",value:(n=H(ee.mark(function e(){var t,n,r,o,a,i,c=this;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this.config).props,o=n.paymentInfo,a=document.getElementById(o.currentDomId),!r.dynamic){e.next=5;break}return e.next=5,this.handleDynamic();case 5:if(!this.isHidePayPalButton){e.next=7;break}return e.abrupt("return",null);case 7:if(!this.isRendered){e.next=9;break}return e.abrupt("return",null);case 9:if(a){e.next=12;break}return this.handleError(Error("[onError][Initialization failed][Could not find mounted DOM]"),en.Init,{domId:o.currentDomId}),e.abrupt("return",null);case 12:return this.element=a,i=nq({node:a,domId:o.currentDomId,height:(null===(t=r.styleOptions)||void 0===t?void 0:t.height)||"",isContinueMode:this.isContinueMode,isVerticalLayout:this.isVerticalLayout,wrapperClass:r.wrapperClass,wrapperStyle:r.wrapperStyle}),this.skeleton=i,this.logger.log("render start",{data:{config:this.config}}),this.beforeInit(),e.abrupt("return",new Promise(function(e,t){r.timeout&&r.timeout.switch&&c.handleRenderTimeout(t);var n,i,s,u=null;(u=new ej(nz({domId:o.currentDomId,clientId:r.clientId,currency:o.settleCurrency,queryParams:r.queryParams,scriptParams:r.scriptParams,style:nz(nz({},r.styleOptions),{},{disableMaxWidth:!0}),onInit:function(t,n){c.logger.info("onInit"),c.afterInit(t,n),c.initTimer&&clearTimeout(c.initTimer),c.initActions=n,e(u)},onClick:(s=H(ee.mark(function e(t,n){var r,o;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.beforeCreateOrder();case 2:if(o=e.sent,c.logger.log("onClick 用户点击了按钮",{data:{data:t,params:o,actions:n}}),o){e.next=6;break}return e.abrupt("return");case 6:if(!1!==o.valid){e.next=8;break}return e.abrupt("return",n.reject());case 8:null===(r=c.initActions)||void 0===r||r.enable(),c.isContinueMode&&(c.createOrderParams=o);case 10:case"end":return e.stop()}},e)})),function(e,t){return s.apply(this,arguments)}),onApprove:(i=H(ee.mark(function e(t,n){var r,o,a;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(o=null===(r=c.orderInfoMap[t.orderID])||void 0===r?void 0:r.returnUrl)!==c.returnUrl&&c.logger.error("前端记录map的returnUrl与this.returnUrl不匹配",{action:en.Pay,data:{orderId:t.orderID,map:c.orderInfoMap,url:c.returnUrl}}),a=o||c.returnUrl,c.logger.log("onApprove PayPal 下单成功，触发回调",{data:{data:t,returnUrl:a,actions:n}}),e$(c.config.onApprove)&&c.config.onApprove(t,n),window.location.href=a;case 6:case"end":return e.stop()}},e)})),function(e,t){return i.apply(this,arguments)}),onCancel:(n=H(ee.mark(function e(t,n){var r;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c.logger.log("用户取消了支付",{data:t}),!e$(null==n?void 0:n.redirect)||!e$(c.config.onCancel)){e.next=6;break}return e.next=4,c.config.onCancel(t);case 4:r=e.sent,null==n||n.redirect(r);case 6:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)}),onError:function(e,n,r){c.handleError(e,n,r),t(e)}},c.specialParamsByScenes.actions))).render().then(function(){c.loadResourceFail=!1}).catch(function(e){c.loadResourceFail=!0,c.handleError(Error("Load Paypal resource failed"),en.Init,{error:e}),t(e)}),u&&c.removeSkeleton(a)}));case 18:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})}]),s}(),nZ=nJ=function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i}([e2],nJ),nX={Android:["(?:(?:Orca-)?Android|Adr)[ /](?:[a-z]+ )?(\\d+[\\.\\d]*)","Android|Silk-Accelerated=[a-z]{4,5}","(?:TwitterAndroid).*[ /](?:[a-z]+ )?(\\d+[\\.\\d]*)","FB4A.*FBSV/(\\d+[\\.\\d]*);","BeyondPod|AntennaPod|Podkicker|DoggCatcher|Player FM|okhttp|Podcatcher Deluxe"],Linux:["Arch ?Linux(?:[ /\\-](\\d+[\\.\\d]+))?","VectorLinux(?: package)?(?:[ /\\-](\\d+[\\.\\d]+))?","Linux(?:OS)?[^a-z]"],iOS:["CFNetwork/889","CFNetwork/887","CFNetwork/811","CFNetwork/808\\.3","CFNetwork/808\\.2","CFNetwork/808\\.1","CFNetwork/808\\.0","CFNetwork/808","CFNetwork/758\\.4\\.3","CFNetwork/758\\.3\\.15","CFNetwork/758\\.2\\.[78]","CFNetwork/758\\.1\\.6","CFNetwork/758\\.0\\.2","CFNetwork/711\\.5\\.6","CFNetwork/711\\.4\\.6","CFNetwork/711\\.3\\.18","CFNetwork/711\\.2\\.23","CFNetwork/711\\.1\\.1[26]","CFNetwork/711\\.0\\.6","CFNetwork/672\\.1","CFNetwork/672\\.0","CFNetwork/609\\.1","CFNetwork/60[29]","CFNetwork/548\\.1","CFNetwork/548\\.0","CFNetwork/485\\.13","CFNetwork/485\\.12","CFNetwork/485\\.10","CFNetwork/485\\.2","CFNetwork/467\\.12","CFNetwork/459","(?:CPU OS|iPh(?:one)?[ _]OS|iOS)[ _/](\\d+(?:[_\\.]\\d+)*)","FBIOS.*FBSV/(\\d+[\\.\\d]*);","(?:Apple-)?(?:iPhone|iPad|iPod)(?:.*Mac OS X.*Version/(\\d+\\.\\d+)|; Opera)?","Podcasts/(?:[\\d\\.]+)|Instacast(?:HD)?/(?:\\d\\.[\\d\\.abc]+)|Pocket Casts, iOS|Overcast|Castro|Podcat|i[cC]atcher|RSSRadio/","iTunes-(iPod|iPad|iPhone)/(?:[\\d\\.]+)"],MacOS:["CFNetwork/887.*(x86_64)","CFNetwork/811.*(x86_64)","CFNetwork/807","CFNetwork/760","CFNetwork/720","CFNetwork/673","CFNetwork/596","CFNetwork/520","CFNetwork/454","CFNetwork/(?:438|422|339|330|221|220|217)","CFNetwork/12[89]","CFNetwork/1\\.2","CFNetwork/1\\.1","Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?","Mac (\\d+(?:[_\\.]\\d+)+)","Darwin|Macintosh|Mac_PowerPC|PPC|Mac PowerPC|iMac|MacBook"],Windows:["CYGWIN_NT-10.0|Windows NT 10.0|Windows 10","CYGWIN_NT-6.4|Windows NT 6.4|Windows 10","CYGWIN_NT-6.3|Windows NT 6.3|Windows 8.1","CYGWIN_NT-6.2|Windows NT 6.2|Windows 8","CYGWIN_NT-6.1|Windows NT 6.1|Windows 7","CYGWIN_NT-6.0|Windows NT 6.0|Windows Vista","CYGWIN_NT-5.2|Windows NT 5.2|Windows Server 2003 / XP x64","CYGWIN_NT-5.1|Windows NT 5.1|Windows XP","CYGWIN_NT-5.0|Windows NT 5.0|Windows 2000","CYGWIN_NT-4.0|Windows NT 4.0|WinNT|Windows NT","CYGWIN_ME-4.90|Win 9x 4.90|Windows ME","CYGWIN_98-4.10|Win98|Windows 98","CYGWIN_95-4.0|Win32|Win95|Windows 95|Windows_95","Windows 3.1","Windows"],HarmonyOS:[],Other:[]},nQ=(nK={},{set:function(e,t){nK[e]=t},get:function(e){if(Object.prototype.hasOwnProperty.call(nK,e))return nK[e]}}),n1=function(e,t){try{var n=(function(e){var t=nQ.get(e);if(t)return t.value;var n=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:".concat(e,")"),"i");return nQ.set(e,{value:n}),n})(e).exec(t);return n?n.slice(1):null}catch(e){return null}};function n0(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var n2=G(function e(){Y(this,e),Z(this,"parse",function(e){for(var t=null,n=0,r=Object.keys(nX);n<r.length;n++){var o=r[n];if(o&&Object.prototype.hasOwnProperty.call(nX,o)){var a,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return n0(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?n0(e,void 0):void 0}}(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}(nX[o]);try{for(i.s();!(a=i.n()).done;){var c=a.value;if(n1(c,e))return t=o}}catch(e){i.e(e)}finally{i.f()}}}return t}),Z(this,"getVersion",function(e,t){switch(t){case"MacOS":return e.replace(/^.*Mac OS X ([\d_]+).*$/,"$1").replace(/_/g,".");case"iOS":return e.replace(/^.*OS ([\d_]+) like.*$/,"$1").replace(/_/g,".");case"Windows":return e.replace(/^.*Windows NT ([\d.]+);.*$/,"$1");case"Android":return e.replace(/^.*Android ([\d.]+);.*$/,"$1")}return""})}),n3=function(){var e,t,n=window.navigator,r=n.userAgent,o=n.language,a=window.screen,i=a.colorDepth,c=a.width,s=a.height,u=window.navigator.javaEnabled().toString(),l=(t=(e=new n2).parse(navigator.userAgent)||"Other",e.getVersion(navigator.userAgent,t));return{transactionWebSite:window.location.href,javaEnabled:u,colorDepth:i.toString(),screenHeight:c.toString(),screenWidth:s.toString(),timeZoneOffset:(new Date).getTimezoneOffset().toString(),accept:"application/json",userAgent:r,language:o,javaScriptEnabled:"true",deviceOsVersion:l}};function n4(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function n5(e,t){return(n5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function n6(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n5(e,t)}function n9(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return n4(e)}function n8(e){return(n8=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n7,re,rt,rn,rr={BUY_NOW:"pay-button-buy-now",MORE_OPTIONS:"pay-button-more-options",CHECKOUT:"pay-button-checkout",PAY_PAL:"pay-button-Paypal",APPLE_PAY:"pay-button-ApplePay",GOOGLE_PAY:"pay-button-GooglePay",SHOP_BY_FAST_CHECKOUT:"pay-button-shop-by",COMMON_ITEM:"pay-button-common-item",COMMON_ITEM_EXPRESS:"pay-button-common-item-express",BUTTON_SUBSCRIPTION:"pay-button-subscription",BUTTON_CUSTOM:"pay-button-custom",BUTTON_LOADING:"pay-button-loading",BUTTON_DISABLED:"pay-button-disabled",BUTTON_HIDE:"pay-button-hide",BUTTON_MASK:"pay-button-mask",BUTTON_SKELETON:"pay-button-skeleton",BUTTON_COLLAPSE:"pay-button-collapse",PAY_PAL_BG_BEFORE:"pay-button-Paypal-bg-before",PAY_PAL_BG_AFTER:"pay-button-Paypal-bg-after"},ro={height:48,width:null,"border-radius":0},ra=t7(),ri=function(){function e(t){var n=this;i(this,e),d(this,"needRender",!1),d(this,"buttonElement",null),d(this,"isLoading",!1),d(this,"isDisabled",!1),d(this,"isVisible",!1),d(this,"disabledMessage",ra("products.product_list.select_product_all_options")),d(this,"setLoading",function(e){n.logger.info("setLoading",{data:{bool:e}}),n.isLoading=e;var t=n.buttonElement;e?null==t||t.classList.add(rr.BUTTON_LOADING):null==t||t.classList.remove(rr.BUTTON_LOADING)}),d(this,"setDisabled",function(e,t){if(n.logger.info("setDisabled",{data:{value:e,options:t}}),n.needRender){n.isDisabled=e,null!=t&&t.message&&(n.disabledMessage=t.message);var r=n.buttonElement;e?null==r||r.classList.add(rr.BUTTON_DISABLED):null==r||r.classList.remove(rr.BUTTON_DISABLED)}}),d(this,"setVisible",function(e){if(n.logger.info("setVisible",{data:{value:e}}),n.needRender){n.isVisible=e;var t=n.buttonElement;e?null==t||t.classList.remove(rr.BUTTON_HIDE):null==t||t.classList.add(rr.BUTTON_HIDE)}}),d(this,"renderedList",[]),this.config=t,this.container=document.getElementById(t.domId),this.logger=this.config.props.logger}return l(e,[{key:"getRenderedList",value:function(){return this.isVisible?this.renderedList:[]}}]),e}();(rc=re||(re={})).ProductDetail="productDetail",rc.Cart="cart",rc.Checkout="checkout",(rs=rt||(rt={})).Normal="normalButton",rs.Express="expressCheckoutButton",rs.Fast="fastCheckoutButton",(ru=rn||(rn={})).BUY_NOW="BUY_NOW",ru.MORE_OPTIONS="MORE_OPTIONS",ru.CHECKOUT="CHECKOUT",ru.PAY_PAL="PAY_PAL",ru.APPLE_PAY="APPLE_PAY",ru.GOOGLE_PAY="GOOGLE_PAY",ru.SHOP_BY_FAST_CHECKOUT="SHOP_BY_FAST_CHECKOUT";var rc,rs,ru,rl,rd=(d(n7={},ea.Paypal,rn.PAY_PAL),d(n7,ea.ApplePay,rn.APPLE_PAY),d(n7,ea.GooglePay,rn.GOOGLE_PAY),n7);(rp=rl||(rl={})).ButtonClick="buttonClick",rp.ModalOpen="modalOpen";var rp,rf,rh=[rn.PAY_PAL,rn.APPLE_PAY,rn.GOOGLE_PAY];(ry=rf||(rf={})).Column="column",ry.Row="row",ry.BuyNowRow="buyNowRow",ry.Checkout="checkout";var ry,rm,rg,rv,rb=function(e){return e.buttonTypeDataList.map(function(e){return e.buttonNameDataList}).flat().map(function(e){return e.buttonName})},rC=function(e){return e.isSystem},rw={exports:{}};!function(e){function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var n,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==y?y:"undefined"!=typeof self?self:{},o=1/0,a=NaN,i=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,l=/^0o[0-7]+$/i,d=parseInt,p="object"==c(r)&&r&&r.Object===Object&&r,f="object"==("undefined"==typeof self?"undefined":c(self))&&self&&self.Object===Object&&self,h=p||f||Function("return this")(),m=Object.prototype.toString,g=h.Symbol,v=Math.min,b=g?g.prototype:void 0,C=b?b.toString:void 0;function w(e){var t=c(e);return!!e&&("object"==t||"function"==t)}function O(e){return"symbol"==c(e)||!!e&&"object"==c(e)&&"[object Symbol]"==m.call(e)}function _(e){if("number"==typeof e)return e;if(O(e))return a;if(w(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=w(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=u.test(e);return n||l.test(e)?d(e.slice(2),n?2:8):s.test(e)?a:+e}function S(e){return null==e?"":function(e){if("string"==typeof e)return e;if(O(e))return C?C.call(e):"";var t=e+"";return"0"==t&&1/e==-o?"-0":t}(e)}var P,k,I,E,x,T,A=(P=Math.round,function(e,t){var n,r,a;if(e=_(e),t=v((a=(r=(n=t)?(n=_(n))===o||n===-o?(n<0?-1:1)*17976931348623157e292:n==n?n:0:0===n?n:0)%1,r==r?a?r-a:r:0),292)){var i=(S(e)+"e").split("e");return+((i=(S(P(i[0]+"e"+(+i[1]+t)))+"e").split("e"))[0]+"e"+(+i[1]-t))}return P(e)}),L={amount:{value:"amount",decimalSymbol:".",groupSymbol:",",format:"amount"},amount_no_decimals:{value:"amount_no_decimals",decimalSymbol:"",groupSymbol:",",format:"amount_no_decimals"},amount_with_comma_separator:{value:"amount_with_comma_separator",decimalSymbol:",",groupSymbol:".",format:"amount_with_comma_separator"},amount_no_decimals_with_comma_separator:{value:"amount_no_decimals_with_comma_separator",decimalSymbol:"",groupSymbol:".",format:"amount_no_decimals_with_comma_separator"},amount_with_apostrophe_separator:{value:"amount_with_apostrophe_separator",decimalSymbol:".",groupSymbol:"'",format:"amount_with_apostrophe_separator"},amount_no_decimals_with_space_separator:{value:"amount_no_decimals_with_space_separator",decimalSymbol:"",groupSymbol:" ",format:"amount_no_decimals_with_space_separator"},amount_with_space_separator:{value:"amount_with_space_separator",decimalSymbol:",",groupSymbol:" ",format:"amount_with_space_separator"}},D=/.*\{\{(.*)\}\}/,j=/(\{\{.*\}\})/,N="amount";(n=k||(k={})).PREFIX="prefix",n.SUFFIX="suffix";var B=Object.entries(L).map(function(e){return(function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,c=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),2!==a.length);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(c)throw o}}return a}}(e,2)||function(e,n){if(e){if("string"==typeof e)return t(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,2):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[1].value}),R=new Map,M=new Map,F=new Map,U=new Map,H=new Map,Y=new Map,V=new Map,q=new Map,G=new Map,W=function(){R.clear(),M.clear(),F.clear(),U.clear(),H.clear(),Y.clear(),V.clear(),q.clear(),G.clear()},z=function(e){x=e},K=function(){return x},$=function(){return T},J=function(e){return B.includes(e||"")},Z=function(e){var t=e.match(D);if(t&&t.length){var n=(t[1]||"").trim();return J(n)?L[n]:null}return null},X=function(e,t,n){var r=Z(t),o=(n?Y:H).get(e),a=o&&o.format;return r||(J(a)?L[a]:L[N])},Q=function(e){return Z(e)||L[N]},ee=function(e,t){R.set(e,t)},et=function(e,t){M.set(e,t)},en=function(e,t,n){var r,o,a=e.match(D);return null!=a&&a.length&&B.includes((null==a||null===(r=a[1])||void 0===r?void 0:r.trim())||"")?e:(null===(o=(n?Y:H).get(t))||void 0===o?void 0:o.origin)||"{{amount}}"},er=function(e,t){var n=Q(t).format;H.set(e,{format:n,origin:t})},eo=function(e,t){var n=Q(t).format;Y.set(e,{format:n,origin:t})},ea=function(e,t){var n=X(e,t,!1),r=n.format,o=n.decimalSymbol,a=n.groupSymbol;q.set(e,o),G.set(e,a),F.set(e,{format:r,origin:en(t,e,!1)})},ei=function(e,t){var n=X(e,t,!0),r=n.format,o=n.decimalSymbol,a=n.groupSymbol;q.set(e,o),G.set(e,a),U.set(e,{format:r,origin:en(t,e,!0)})},ec=function(e,t){t?(null==t?void 0:t.replace(/^\s+/,"").indexOf("{{"))>0?V.set(e,k.PREFIX):V.set(e,k.SUFFIX):window[window.__sl_console__?"__sl_console__":"console"].error("".concat(e,"无对应的messageWithoutDefaultCurrency配置"))},es=function(e){var t=$().find(function(t){return t.currencyCode===e});if(t){var n=t.messageWithoutDefaultCurrency,r=t.messageWithCurrency,o=t.messageWithoutCurrency,a=t.messageWithDefaultCurrency,i=t.currencyCode,c=t.rate,s=t.currencySymbol;ee(i,void 0===c?2:c),et(i,s),ec(i,n),er(i,n),eo(i,a),ea(i,o),ei(i,r)}else window[window.__sl_console__?"__sl_console__":"console"].error("获取".concat(e,"对应的货币配置失败"))},eu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").replace(j,e)},el=function(e,t,n){var r,o,a,i,c=L[t],s=c.groupSymbol,u=c.decimalSymbol,l=e<0,d=(a=A(l?-e:e,n),0!==n&&u?(r=Math.floor(a),o="".concat(A(a-r,n)).replace(/^0?\.?/,"").padEnd(n,"0")):(r=A(a),o=""),{integerPart:r,fractionPart:o}),p=d.fractionPart,f=(i=d.integerPart,"".concat(i||0).replace(/(\d)(?=(?:\d{3})+$)/g,"$1".concat(s)));return{integer:"".concat(l?"-":"").concat(f),fraction:p,groupSymbol:s,decimalSymbol:u}},ed=function(e,t){var n,r=(null==t?void 0:t.code)||I||"CNY";F.get(r)||es(r);var o=eO(r),a=ew(r),i=eg(r),c=ev(r),s=(F.get(r)||{}).format,u=el(e,J(s)?s:N,2),l=u.integer,d=u.fraction,p=[],f=(null==l?void 0:l.split(o))||[];return f.forEach(function(e,t){p.push({type:"integer",value:e}),t!==f.length-1&&p.push({type:"group",value:o})}),p.push({type:"decimal",value:a}),p.push({type:"fraction",value:null!==(n=null==d?void 0:d.trim())&&void 0!==n?n:""}),"prefix"===c?p.unshift({type:"currency",value:i}):p.push({type:"currency",value:i}),p},ep=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CNY",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E,a=(arguments.length>3?arguments[3]:void 0)||K();return r===o?e:e*(null!==(t=a[o])&&void 0!==t?t:1)/(null!==(n=a[r])&&void 0!==n?n:1)},ef=function(e,t,n){var r=t?U:F,o=t?ey:em,a=n||{},i=a.from,c=void 0===i?I:i,s=a.to,u=void 0===s?E:s,l=a.currencyRates;return r.get(c)||es(c),r.get(u)||es(u),o(ep(e,c,u,l||K()),{code:u})},eh=function(e,t,n){var r,o=t?U:F,a=(null==n?void 0:n.code)||I||"CNY";o.get(a)||es(a);var i=o.get(a)||{},c=i.format,s=i.origin,u=null!==(r=null==n?void 0:n.digits)&&void 0!==r?r:2,l=el(e/Math.pow(10,u),J(c)?c:N,u),d=l.integer,p=l.fraction,f=l.decimalSymbol;return eu(f&&u?"".concat(d).concat(f).concat(p):d,s)},ey=function(e,t){return eh(e,!0,t)},em=function(e,t){return eh(e,!1,t)},eg=function(e){var t;return F.get(e)||es(e),null!==(t=M.get(e))&&void 0!==t?t:""},ev=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"CNY";return F.get(e)||es(e),V.get(e)},eb=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return("number"!=typeof e?Number(e):e)/Math.pow(10,t)},eC=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return A(("number"!=typeof e?Number(e):e)*Math.pow(10,t),0)},ew=function(e){var t;return F.get(e)||es(e),null!==(t=q.get(e))&&void 0!==t?t:""},eO=function(e){var t;return F.get(e)||es(e),null!==(t=G.get(e))&&void 0!==t?t:""};e.convertCalc=ep,e.convertFormat=function(e,t){return ef(e,!0,t)},e.convertFormatWithoutCurrency=function(e,t){return ef(e,!1,t)},e.covertCalc=ep,e.defaultCurrency="CNY",e.defaultCurrencyDigit=2,e.defaultPresentDigit=2,e.format=ey,e.formatCurrency=function(e){return eb(e,2)},e.formatMoneyWithoutCurrency=function(e,t){var n=(null==t?void 0:t.code)||I||"CNY";F.get(n)||es(n);var r=(F.get(n)||{}).format,o=el(e/100,J(r)?r:N,2),a=o.integer,i=o.fraction,c=o.decimalSymbol;return c?"".concat(a).concat(c).concat(i):a},e.formatNumber=eb,e.formatPercent=function(e){return eb(e,2)},e.formatWithoutCurrency=em,e.getConvertPrice=function(e,t){var n=null!=t?t:{},r=n.from,o=n.code,a=n.to,i=n.currencyRates,c=r||I||"CNY";F.get(c)||es(c);var s=a||o||E;F.get(s)||es(s);var u=ed(ep(eb(e),c,s,i||x),{code:s}),l={group:"",integer:"",decimal:"",fraction:"",symbolOrder:"",currencySymbol:""},d=ev(s);return d&&(l.symbolOrder=d),u.forEach(function(e){var t=e.value;"currency"===e.type&&(l.currencySymbol=t),"integer"===e.type&&(l.integer?l.integer="".concat(l.integer).concat(l.group).concat(t):l.integer=t),"group"===e.type&&(l.group=t),"decimal"===e.type&&(l.decimal=t),"fraction"===e.type&&(l.fraction=t)}),l},e.getCurrencyConfig=$,e.getCurrencyRates=K,e.getDecimalSymbolByCode=ew,e.getDefaultToCurrency=function(){return E},e.getDigitsByCode=function(e){return F.get(e)||es(e),R.get(e)},e.getFormatParts=ed,e.getGroupSymbolByCode=eO,e.getStoreCurrency=function(){return I},e.getSymbolByCode=eg,e.getSymbolOrderByCode=ev,e.parseCustomFormat=X,e.parseCustomFormatWithCurrency=ei,e.parseCustomFormatWithoutCurrency=ea,e.parseDefaultFormat=Q,e.parseDefaultFormatWithCurrency=eo,e.parseDefaultFormatWithoutCurrency=er,e.setCurrencyConfig=function(e){var t={};(T=e).forEach(function(e){t[e.currencyCode]=e.exchangeRate}),z(t),"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)&&W()},e.setCurrencyRates=z,e.setDefaultToCurrency=function(e){E=e},e.setStoreCurrency=function(e){I=e},e.unformatCurrency=function(e){return eC(e,2)},e.unformatNumber=eC,e.unformatPercent=function(e){return eC(e,2)},Object.defineProperty(e,"__esModule",{value:!0})}(rw.exports),(rk=rv||(rv={})).PayButtonView="View",rk.PayButtonClick="",rk.InitiateCheckout="InitiateCheckout",rk.AddCustomerInfo="AddCustomerInfo",rk.AddShippingInfo="AddShippingInfo",rk.AddPaymentInfo="AddPaymentInfo",rk.FastCheckout="FastCheckout";var rO=(d(rm={FastCheckout:158},re.ProductDetail,159),d(rm,re.Cart,162),d(rm,re.Checkout,163),rm),r_=(d(rg={Other:-999},rn.BUY_NOW,102),d(rg,rn.MORE_OPTIONS,102),d(rg,rn.PAY_PAL,103),d(rg,rn.APPLE_PAY,180),d(rg,rn.GOOGLE_PAY,181),d(rg,rn.SHOP_BY_FAST_CHECKOUT,182),rg);function rS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rS(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}for(var rk,rI,rE=function(e){window.HdSdk&&window.HdSdk.shopTracker&&window.HdSdk.shopTracker.collect(e)},rx={reportConversionEvent:function(e,t){var n=t.currency,r=t.orderAmount,o=t.productInfos,a=t.shipping_method;rE(this.generateReportData(e,{currency:n,orderAmount:r,productInfos:o,shipping_method:a}))},reportAddPaymentInfo:function(e){var t=e.currency,n=e.orderAmount,r=e.productInfos,o=e.payment_method,a=e.coupon_code,i=e.shipping_method,c=e.basicInfo;rE(rP(rP({},this.generateReportData(rv.AddPaymentInfo,{currency:t,orderAmount:n,productInfos:r,basicInfo:c,shipping_method:i})),{},{payment_method:o,coupon_code:a}))},generateReportData:function(e,t){if(e){var n=this.generateProductParams(e,{productInfos:t.productInfos||[]}),r=t.orderAmount||0,o=rP(rP({page:-999,component:r_.Other,module:rO.FastCheckout,action_type:-999,billing_address_status:1,event_name:e,value:rw.exports.formatNumber(r).toString(),currency:t.currency,referral_code:""},n),{},{payment_method:t.payment_method,coupon_code:"",shipping_method:t.shipping_method});if(e===rv.AddPaymentInfo){var a=sessionStorage.getItem("tradeAttributeInfo");if(a){var i=(JSON.parse(a)||{}).referralCode;o.referral_code=i?i.value:void 0}}else delete o.referral_code,delete o.payment_method,delete o.coupon_code;return e!==rv.AddPaymentInfo&&delete o.billing_address_status,e!==rv.AddShippingInfo&&delete o.shipping_method,o}},generateProductParams:function(e,t){var r=t.productInfos,o=new Set,a=[],i=0;return r.forEach(function(e){i+=e.productNum||0,a.push(e.productSku||""),o.add(e.productSeq||"")}),{content_ids:n(o.values()).join(","),variantion_id:a.join(","),quantity:i.toString()}},reportPayButtonView:function(e,t){rE({event_name:rv.PayButtonView,page:"",module:rO[t],component:r_[e],action_type:101})},reportPayButtonClick:function(e,t){rE({event_name:"",page:"",module:rO[t],component:r_[e],action_type:102})},reportFastCheckout:function(e){rE({event_name:rv.FastCheckout,component:r_[e],fastcheckout_type:e})}},rT=new Uint8Array(16),rA=[],rL=0;rL<256;++rL)rA.push((rL+256).toString(16).slice(1));var rD={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},rj=function(){return Number(Math.random().toString().slice(2)+Date.now()).toString(36)},rN=function(e){var t=document.cookie.split("; "),n={};return t.forEach(function(e){var t=r(e.split("="),2),o=t[0],a=t[1];o&&(n[o]=a||"")}),n[e]||""},rB=function(){return"".concat(Date.now(),"_").concat((function(e,t,n){if(rD.randomUUID&&!t&&!e)return rD.randomUUID();var r=(e=e||{}).random||(e.rng||function(){if(!rI&&!(rI="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return rI(rT)})();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(rA[e[t+0]]+rA[e[t+1]]+rA[e[t+2]]+rA[e[t+3]]+"-"+rA[e[t+4]]+rA[e[t+5]]+"-"+rA[e[t+6]]+rA[e[t+7]]+"-"+rA[e[t+8]]+rA[e[t+9]]+"-"+rA[e[t+10]]+rA[e[t+11]]+rA[e[t+12]]+rA[e[t+13]]+rA[e[t+14]]+rA[e[t+15]]).toLowerCase()}(r)})().replace(/-/g,""))},rR=function(e){return null===e.offsetParent},rM=function(e){var t=document.createElement("style");return t.innerHTML=e.replace(/\/\*(.*?)\*\//g,"").replace(/\s+/g," ").replace(/\s*([{}:;,])\s*/g,"$1"),{style:t,cssInsertBefore:function(e){var n;return null===(n=e.parentNode)||void 0===n?void 0:n.insertBefore(t,e)}}};function rF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var rU=t7(),rH=function(e){n6(o,ri);var t,r=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=n8(o);return e=t?Reflect.construct(n,arguments,n8(this).constructor):n.apply(this,arguments),n9(this,e)});function o(e){i(this,o),d(n4(c=r.call(this,e)),"customHandleClick",null),d(n4(c),"render",(t=a(v.mark(function e(t){var n;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c.logger.info("render"),c.needRender){e.next=3;break}return e.abrupt("return",[]);case 3:return n=c.insertDom(t),c.addListener(),c.renderedList=n,e.abrupt("return",n);case 7:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})),d(n4(c),"setSubscription",function(e){var t;if(c.logger.info("setSubscription",{data:{value:e}}),c.needRender){var r=null===(t=c.container)||void 0===t?void 0:t.querySelectorAll(".".concat(rr.COMMON_ITEM_EXPRESS)),o=rC(c.config.paymentConfig);r&&o&&(n(r).find(function(e){return!rR(e)})?c.render(rn.MORE_OPTIONS):c.render(rn.BUY_NOW),c.setVisible(!0))}}),d(n4(c),"customButton",function(e,t){var r,o;if(c.logger.log("customBuyNow",{data:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rF(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rF(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({buttonName:e},t)}),c.needRender){var a,i,s,u,l,p,f=t.className,h=t.handle;(e!==rn.BUY_NOW||null!==(r=c.buttonElement)&&void 0!==r&&r.className.includes(rr.BUY_NOW))&&(e!==rn.MORE_OPTIONS||null!==(o=c.buttonElement)&&void 0!==o&&o.className.includes(rr.MORE_OPTIONS))&&(f&&(null===(a=c.buttonElement)||void 0===a||(i=a.classList).add.apply(i,n(f.split(" ")))),h&&(null===(s=c.buttonElement)||void 0===s||s.classList.add(rr.BUTTON_CUSTOM),null===(u=c.buttonElement)||void 0===u||u.removeEventListener("click",c.handleClick),c.customHandleClick&&(null===(l=c.buttonElement)||void 0===l||l.removeEventListener("click",c.customHandleClick)),c.customHandleClick=function(){return h(c.handleClick)},null===(p=c.buttonElement)||void 0===p||p.addEventListener("click",c.customHandleClick)))}}),d(n4(c),"insertDom",function(e){var t,n=c.config,r=n.paymentConfig,o=n.props,a=o.layout,i=o.extraBuyNowDomId,s=rb(r),u=rC(r),l=s.includes(rn.BUY_NOW);c.logger.info("insertDom data",{data:{isDynamic:u,hasBuyNow:l}});var d,p,f,h=(d=rr.BUTTON_HIDE,'<button type="button" class="btn btn-primary '.concat(rr.COMMON_ITEM," ").concat(rr.BUY_NOW," ").concat(null!=d?d:"",'" type="button">\n    <span class="').concat(rr.BUY_NOW,'-text">').concat(rU("cart.cart.buy_now"),'</span><span class="loading-icon" /></button>')),y='\n      <div class="'.concat(rr.MORE_OPTIONS," ").concat(rr.BUTTON_HIDE,'">\n        ').concat(rU("products.product_details.more_payment_options"),"\n      </div>\n    ");if(null===(t=c.container)||void 0===t||t.querySelectorAll(".".concat(rr.BUY_NOW,", .").concat(rr.MORE_OPTIONS)).forEach(function(e){return e.remove()}),e===rn.BUY_NOW||!e&&l){if(a===rf.BuyNowRow&&i){c.logger.info("BuyNowRow layout render buy now");var m,g,v=document.getElementById(i);v&&(v.innerHTML=h,c.buttonElement=(null==v?void 0:v.querySelector(".".concat(rr.BUY_NOW)))||null)}else c.logger.info("normal render buy now"),null===(m=c.container)||void 0===m||m.insertAdjacentHTML("afterbegin",h),c.buttonElement=(null===(g=c.container)||void 0===g?void 0:g.querySelector(".".concat(rr.BUY_NOW)))||null;return[rn.BUY_NOW]}return e===rn.MORE_OPTIONS||u?(c.logger.info("render more payment options"),null===(p=c.container)||void 0===p||p.insertAdjacentHTML("beforeend",y),c.buttonElement=(null===(f=c.container)||void 0===f?void 0:f.querySelector(".".concat(rr.MORE_OPTIONS)))||null,[rn.MORE_OPTIONS]):[]}),d(n4(c),"addListener",function(){var e=n4(c).buttonElement;e&&(e.removeEventListener("click",c.handleClick),e.addEventListener("click",c.handleClick))}),d(n4(c),"handleClick",a(v.mark(function e(){var t,n,r,o,a,i,s,u,l;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=c.config).paymentConfig.buttonLocation,r=t.saveAbandonedOrder,a=(o=t.props).isPreview,i=o.toast,rx.reportPayButtonClick(rn.BUY_NOW,n),!a){e.next=6;break}return c.logger.info("预览模式，按钮点击触发toast提示"),i(rU("products.product_details.link_preview_does_not_support")),e.abrupt("return");case 6:if(!c.isDisabled){e.next=10;break}return c.logger.info("按钮禁用",{data:{isDisabled:c.isDisabled}}),i(c.disabledMessage),e.abrupt("return");case 10:if(!c.isLoading){e.next=13;break}return c.logger.info("按钮点击中",{data:{isLoading:c.isLoading}}),e.abrupt("return");case 13:return c.setLoading(!0),e.next=16,r(c.renderedList[0]||rn.BUY_NOW);case 16:if(u=(s=e.sent).canContinue,l=s.url,u){e.next=22;break}return c.setLoading(!1),e.abrupt("return");case 22:l&&(c.logger.info("jump to checkout",{data:l}),window.location.href=l);case 23:case"end":return e.stop()}},e)})));var t,c,s=e.buttonTypes;return c.logger=c.config.props.logger.pipeOwner("NormalButton"),c.needRender=!s||s.includes(rt.Normal),c}return l(o)}();function rY(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return rV(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rV(e,void 0)}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function rV(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function rq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rG(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rq(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rq(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var rW=function(){var e,t,n;function r(e){var t,n,o=this;i(this,r),d(this,"renderList",[]),d(this,"checkAllButtonsInitFail",function(){var e=0===o.renderList.filter(function(e){return e.instance.isVisible}).length;o.logger.info("checkAllButtonsInitFail",{data:{isAllButtonInitFail:e}}),e&&e$(o.configData.onAllButtonsInitFail)&&o.configData.onAllButtonsInitFail()}),this.configData=e,F.set(null===(t=(n=this.configData).loggerFn)||void 0===t?void 0:t.call(n)),this.logger=F.get().pipeOwner("SmartPayment")}return l(r,[{key:"handleElement",value:function(){var e,t,n;e9({styleOptions:t=(e={styleOptions:this.configData.props.styleOptions,domId:this.configData.props.domId}).styleOptions,domId:n=e.domId}),e8({styleOptions:t,domId:n})}},{key:"renderPaymentItem",value:(n=a(v.mark(function e(t){var n,r,o,a,i,c,s=this;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=nR(rG(rG({channelCode:t.channelCode,paymentInfo:t},this.configData),{},{onError:function(e,n,r){e$(s.configData.onError)&&s.configData.onError(e,n,rG(rG({},r),{},{channelCode:t.channelCode,methodCode:t.methodCode}))}}))){e.next=4;break}return e.abrupt("return");case 4:return o=(r=n.validate()).result,a=r.errorTip,o||this.logger.error("render error ".concat(a)),i=n.getConfig(),c=new n.component(rG({},i)),e.next=11,c.render();case 11:this.renderList.push({channelCode:i.channelCode,params:i,instance:c}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),this.logger.error("render error",{error:e.t0});case 17:case"end":return e.stop()}},e,this,[[0,14]])})),function(e){return n.apply(this,arguments)})},{key:"render",value:(t=a(v.mark(function e(){var t,n,r;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.logger.log("render",{data:{config:this.configData}}),this.configData.payments&&Array.isArray(this.configData.payments)||this.logger.error("render error 传值有误[payments]"),e.next=5,ne(this.configData.language||"en");case 5:this.handleElement(),t=rY(this.configData.payments),e.prev=8,t.s();case 10:if((n=t.n()).done){e.next=16;break}return r=n.value,e.next=14,this.renderPaymentItem(r);case 14:e.next=10;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(8),t.e(e.t0);case 21:return e.prev=21,t.f(),e.finish(21);case 24:this.checkAllButtonsInitFail(),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(0),this.logger.error("render error",{error:e.t1});case 30:case"end":return e.stop()}},e,this,[[0,27],[8,18,21,24]])})),function(){return t.apply(this,arguments)})},{key:"rerender",value:(e=a(v.mark(function e(t){var n,r,o,a,i,c,s,u,l,d,p=this;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=this.renderList,this.logger.info("rerender start",{action:en.ReRender,data:{renderList:n.map(function(e){return e.channelCode})}}),r=rY(n),e.prev=4,r.s();case 6:if((o=r.n()).done){e.next=14;break}if(!(a=o.value.instance).loadResourceFail){e.next=12;break}return e.next=12,a.render();case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:i=rY(t),e.prev=23,s=v.mark(function e(){var t,r,o,a,i,s;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.value,r=n.find(function(e){var n,r=(null===(n=e.instance.config)||void 0===n?void 0:n.paymentInfo)||{},o=r.channelCode,a=r.methodCode;return o===t.channelCode&&a===t.methodCode})){e.next=6;break}return e.next=5,p.renderPaymentItem(t);case 5:return e.abrupt("return","continue");case 6:r.instance.initSuccess&&!r.instance.isVisible&&(null===(o=(a=r.instance).showButton)||void 0===o||o.call(a),null===(i=(s=p.configData).afterInit)||void 0===i||i.call(s));case 7:case"end":return e.stop()}},e)}),i.s();case 26:if((c=i.n()).done){e.next=33;break}return e.delegateYield(s(),"t1",28);case 28:if("continue"!==e.t1){e.next=31;break}return e.abrupt("continue",31);case 31:e.next=26;break;case 33:e.next=38;break;case 35:e.prev=35,e.t2=e.catch(23),i.e(e.t2);case 38:return e.prev=38,i.f(),e.finish(38);case 41:u=rY(n),e.prev=42,d=v.mark(function e(){var n,r,o;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=l.value,t.find(function(e){var t,r=(null===(t=n.instance.config)||void 0===t?void 0:t.paymentInfo)||{},o=r.channelCode,a=r.methodCode;return o===e.channelCode&&a===e.methodCode})||null===(r=(o=n.instance).hideButton)||void 0===r||r.call(o);case 3:case"end":return e.stop()}},e)}),u.s();case 45:if((l=u.n()).done){e.next=49;break}return e.delegateYield(d(),"t3",47);case 47:e.next=45;break;case 49:e.next=54;break;case 51:e.prev=51,e.t4=e.catch(42),u.e(e.t4);case 54:return e.prev=54,u.f(),e.finish(54);case 57:this.checkAllButtonsInitFail(),e.next=63;break;case 60:e.prev=60,e.t5=e.catch(0),this.logger.error("rerender error",{action:en.ReRender,error:e.t5});case 63:case"end":return e.stop()}},e,this,[[0,60],[4,16,19,22],[23,35,38,41],[42,51,54,57]])})),function(t){return e.apply(this,arguments)})},{key:"getPaymentMethods",value:function(){return this.renderList.map(function(e){return{channelCode:e.channelCode,params:e.params}})}},{key:"setDisabled",value:function(e){try{this.logger.info("setDisabled start",{data:{disabled:e}}),this.renderList.forEach(function(t){t.instance.setDisabled(e)})}catch(e){this.logger.error("setDisabled error",{error:e})}}}]),r}(),rz=rW=function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":c(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i}([e2],rW);function rK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function r$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rK(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rK(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}rw.exports.setCurrencyConfig(window.Shopline.currencyConfig.currencyDetailList);var rJ,rZ=function(e,t){return t.isSubscription?"".concat(e.channelCode,"_").concat(e.methodCode,"_").concat(t.uniqueId,"_subscription"):"".concat(e.channelCode,"_").concat(e.methodCode,"_").concat(t.uniqueId)},rX=function(e){var t;return(null===(t=e.buttonTypeDataList.find(function(e){return e.buttonType===rt.Express}))||void 0===t?void 0:t.buttonNameDataList.map(function(e){return e.buttonConfigData}))||[]},rQ=function(e){if(e.redirect&&e.fullUri){var t="".concat(window.location.protocol,"//").concat(window.location.host).concat(e.fullUri);return window.location.href=t,!0}return!1},r1=function(e,t){var n=t.expressCheckoutChannelInfo,r=r$({},e);if(n.channelCode===eo.SLpayments){if(n.methodCode===ea.GooglePay){var o=r.transactionInfo,a=r.newTransactionInfo,i=(o||a).currencyCode,c=function(e){var t=r$({},e),n=rw.exports.getGroupSymbolByCode(i);return t.totalPrice=rw.exports.formatMoneyWithoutCurrency(Number(t.totalPrice),{code:i}).replaceAll(n,""),Array.isArray(t.displayItems)&&t.displayItems.length&&(t.displayItems=t.displayItems.map(function(e){return r$(r$({},e),{},{price:rw.exports.formatMoneyWithoutCurrency(Number(e.price),{code:i}).replaceAll(n,"")})})),t},s=function(e){var t=r$({},e);return Array.isArray(t.shippingOptions)&&t.shippingOptions.length&&(t.shippingOptions=t.shippingOptions.map(function(e){return r$(r$({},e),{},{description:"".concat(i,": ").concat(rw.exports.formatWithoutCurrency(Number(e.description),{code:i}))})})),t};return r.newTransactionInfo&&(r.newTransactionInfo=c(r.newTransactionInfo)),r.transactionInfo&&(r.transactionInfo=c(r.transactionInfo)),r.newShippingOptionParameters&&(r.newShippingOptionParameters=s(r.newShippingOptionParameters)),r.shippingOptionParameters&&(r.shippingOptionParameters=s(r.shippingOptionParameters)),r}if(n.methodCode===ea.ApplePay){var u=r.paymentRequest,l=r.newTotal,d=u.currencyCode,p=rw.exports.getGroupSymbolByCode(d),f=function(e){return rw.exports.formatMoneyWithoutCurrency(Number(e),{code:d}).replaceAll(p,"")};return Array.isArray(r.newShippingMethods)&&(r.newShippingMethods=r.newShippingMethods.map(function(e){return r$(r$({},e),{},{amount:f(e.amount)})})),Array.isArray(null==u?void 0:u.shippingMethods)&&(u.shippingMethods=u.shippingMethods.map(function(e){return r$(r$({},e),{},{amount:f(e.amount)})})),l&&(l.amount=f(l.amount)),u.total&&(u.total.amount=f(u.total.amount)),Array.isArray(r.newLineItems)&&(r.newLineItems=r.newLineItems.map(function(e){return r$(r$({},e),{},{amount:f(e.amount)})})),Array.isArray(u.lineItems)&&(u.lineItems=u.lineItems.map(function(e){return r$(r$({},e),{},{amount:f(e.amount)})})),r}}return r},r0=function(e,t){var n=t.expressCheckoutChannelInfo;if(n.channelCode===eo.SLpayments)return function(e){if(e){var t=e.defaultSelectedOptionId,n=e.shippingOptions;if(t&&Array.isArray(n)){var r=n.find(function(e){return e.id===t});if(r)return r.label}}}(e.newShippingOptionParameters||e.shippingOptionParameters);if(n.channelCode===eo.StripeOther&&Array.isArray(e.shippingOptions)){var r=e.shippingOptions.find(function(e){return e.selected});if(r)return r.label}},r2=function(e,t){var n,r=rd[t.methodCode];if(r){var o={type:e,data:{buttonName:r,buttonLocation:t.buttonLocation}},a=new CustomEvent("PayButton::Update",{bubbles:!0,detail:o});document.dispatchEvent(a),null===(n=window.Shopline.event)||void 0===n||n.emit("PayButton::Update",o)}},r3=function(e){var t=rn.PAY_PAL;switch(e){case ea.GooglePay:t=rn.GOOGLE_PAY;break;case ea.ApplePay:t=rn.APPLE_PAY;break;default:t=rn.PAY_PAL}return t},r4=function(){var e={sid:"",createAt:Date.now()};try{var t=window.localStorage.getItem("tracker_sid");if(!t)return e;var n=JSON.parse(t).value;return{sid:n.sid,createAt:n.createAt}}catch(t){return window[window.__sl_console__?"__sl_console__":"console"].error("get session info error: ",t),e}},r5={},r6="%[a-f0-9]{2}",r9=RegExp("("+r6+")|([^%]+?)","gi"),r8=RegExp("("+r6+")+","gi"),r7=function(e){if("string"!=typeof e)throw TypeError("Expected `encodedURI` to be of type `string`, got `"+c(e)+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=r8.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var r=function(e){try{return decodeURIComponent(e)}catch(r){for(var t=e.match(r9)||[],n=1;n<t.length;n++)t=(e=(function e(t,n){try{return[decodeURIComponent(t.join(""))]}catch(e){}if(1===t.length)return t;n=n||1;var r=t.slice(0,n),o=t.slice(n);return Array.prototype.concat.call([],e(r),e(o))})(t,n).join("")).match(r9)||[];return e}}(n[0]);r!==n[0]&&(t[n[0]]=r)}n=r8.exec(e)}t["%C2"]="�";for(var o=Object.keys(t),a=0;a<o.length;a++){var i=o[a];e=e.replace(RegExp(i,"g"),t[i])}return e}(e)}},oe=function(e,t){if("string"!=typeof e||"string"!=typeof t)throw TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];var n=e.indexOf(t);return -1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]},ot=function(e,t){for(var n={},r=Object.keys(e),o=Array.isArray(t),a=0;a<r.length;a++){var i=r[a],c=e[i];(o?-1!==t.indexOf(i):t(i,c,e))&&(n[i]=c)}return n};function on(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}!function(e){var t=Symbol("encodeFragmentIdentifier");function o(e){if("string"!=typeof e||1!==e.length)throw TypeError("arrayFormatSeparator must be single character string")}function a(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())}):encodeURIComponent(e):e}function i(e,t){return t.decode?r7(e):e}function s(e){var t=e.indexOf("#");return -1!==t&&(e=e.slice(0,t)),e}function u(e){var t=(e=s(e)).indexOf("?");return -1===t?"":e.slice(t+1)}function l(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):t.parseBooleans&&null!==e&&("true"===e.toLowerCase()||"false"===e.toLowerCase())&&(e="true"===e.toLowerCase()),e}function p(e,t){o((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);var n=function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return function(e,n,r){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"colon-list-separator":return function(e,n,r){t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"comma":case"separator":return function(t,n,r){var o="string"==typeof n&&n.includes(e.arrayFormatSeparator),a="string"==typeof n&&!o&&i(n,e).includes(e.arrayFormatSeparator);n=a?i(n,e):n;var c=o||a?n.split(e.arrayFormatSeparator).map(function(t){return i(t,e)}):null===n?n:i(n,e);r[t]=c};case"bracket-separator":return function(t,n,r){var o=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),o){var a=null===n?[]:n.split(e.arrayFormatSeparator).map(function(t){return i(t,e)});void 0!==r[t]?r[t]=[].concat(r[t],a):r[t]=a}else r[t]=n?i(n,e):n};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e||!(e=e.trim().replace(/^[?#&]/,"")))return a;var s,u=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return on(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return on(e,void 0)}}(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}(e.split("&"));try{for(u.s();!(s=u.n()).done;){var d=s.value;if(""!==d){var p=r(oe(t.decode?d.replace(/\+/g," "):d,"="),2),f=p[0],h=p[1];h=void 0===h?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?h:i(h,t),n(i(f,t),h,a)}}}catch(e){u.e(e)}finally{u.f()}for(var y=0,m=Object.keys(a);y<m.length;y++){var g=m[y],v=a[g];if("object"===c(v)&&null!==v)for(var b=0,C=Object.keys(v);b<C.length;b++){var w=C[b];v[w]=l(v[w],t)}else a[g]=l(v,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce(function(e,t){var n=a[t];return n&&"object"===c(n)&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"===c(t)?e(Object.keys(t)).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return t[e]}):t}(n):e[t]=n,e},Object.create(null))}e.extract=u,e.parse=p,e.stringify=function(e,t){if(!e)return"";o((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);for(var r=function(e){switch(e.arrayFormat){case"index":return function(t){return function(r,o){var i=r.length;return void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?r:[].concat(n(r),null===o?[[a(t,e),"[",i,"]"].join("")]:[[a(t,e),"[",a(i,e),"]=",a(o,e)].join("")])}};case"bracket":return function(t){return function(r,o){return void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?r:[].concat(n(r),null===o?[[a(t,e),"[]"].join("")]:[[a(t,e),"[]=",a(o,e)].join("")])}};case"colon-list-separator":return function(t){return function(r,o){return void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?r:[].concat(n(r),null===o?[[a(t,e),":list="].join("")]:[[a(t,e),":list=",a(o,e)].join("")])}};case"comma":case"separator":case"bracket-separator":var t="bracket-separator"===e.arrayFormat?"[]=":"=";return function(n){return function(r,o){return void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?r:(o=null===o?"":o,0===r.length?[[a(n,e),t,a(o,e)].join("")]:[[r,a(o,e)].join(e.arrayFormatSeparator)])}};default:return function(t){return function(r,o){return void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?r:[].concat(n(r),null===o?[a(t,e)]:[[a(t,e),"=",a(o,e)].join("")])}}}}(t),i={},c=0,s=Object.keys(e);c<s.length;c++){var u=s[c];t.skipNull&&null==e[u]||t.skipEmptyString&&""===e[u]||(i[u]=e[u])}var l=Object.keys(i);return!1!==t.sort&&l.sort(t.sort),l.map(function(n){var o=e[n];return void 0===o?"":null===o?a(n,t):Array.isArray(o)?0===o.length&&"bracket-separator"===t.arrayFormat?a(n,t)+"[]":o.reduce(r(n),[]).join("&"):a(n,t)+"="+a(o,t)}).filter(function(e){return e.length>0}).join("&")},e.parseUrl=function(e,t){t=Object.assign({decode:!0},t);var n=r(oe(e,"#"),2),o=n[0],a=n[1];return Object.assign({url:o.split("?")[0]||"",query:p(u(e),t)},t&&t.parseFragmentIdentifier&&a?{fragmentIdentifier:i(a,t)}:{})},e.stringifyUrl=function(n,r){r=Object.assign(d({encode:!0,strict:!0},t,!0),r);var o,i,c,u=s(n.url).split("?")[0]||"",l=e.extract(n.url),p=Object.assign(e.parse(l,{sort:!1}),n.query),f=e.stringify(p,r);f&&(f="?".concat(f));var h=(o=n.url,i="",-1!==(c=o.indexOf("#"))&&(i=o.slice(c)),i);return n.fragmentIdentifier&&(h="#".concat(r[t]?a(n.fragmentIdentifier,r):n.fragmentIdentifier)),"".concat(u).concat(f).concat(h)},e.pick=function(n,r,o){o=Object.assign(d({parseFragmentIdentifier:!0},t,!1),o);var a=e.parseUrl(n,o),i=a.url,c=a.query,s=a.fragmentIdentifier;return e.stringifyUrl({url:i,query:ot(c,r),fragmentIdentifier:s},o)},e.exclude=function(t,n,r){var o=Array.isArray(n)?function(e){return!n.includes(e)}:function(e,t){return!n(e,t)};return e.pick(t,o,r)}}(r5);var or,oo=(d(rJ={},re.ProductDetail,"detail"),d(rJ,re.Cart,"cart"),d(rJ,re.Checkout,void 0),rJ);(oa=or||(or={})).InitFail="initFail",oa.UpdateFail="updateFail",oa.NoShippingOption="noShippingOption",oa.InvalidDiscountCode="invalidDiscountCode",oa.DiscountCodeExists="discountCodeExists",oa.CreateFail="createFail",oa.CreateTimeout="createTimeout";var oa,oi,oc,os,ou,ol,od,op={maxCount:3,interval:1e3},of=(oi=a(v.mark(function e(t){var n,r,o,a,i,c,s,u,l,d,p,f;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.products,a=void 0!==(o=t.associateCart)&&o,c=void 0===(i=t.discountCodes)?[]:i,s=t.useMemberPoint,u=t.notSupportSubscriptionCheck,l=window.Shopline.locale,d=rN("userSelectLocale"),p={useRetry:!0,action:ey.SaveAbandonOrder,retryOptions:op},e.next=6,eG.post("/leproxy/api/trade/center/order/abandoned/save",{products:r,associateCart:a,discountCodes:c,orderFrom:"web",languageInfo:{marketLanguage:l,displayLanguage:d},useMemberPoint:s,notSupportSubscriptionCheck:u},p);case 6:if(null!==(n=(f=e.sent).data)&&void 0!==n&&n.success){e.next=9;break}throw f.data;case 9:return e.abrupt("return",f.data.data);case 10:case"end":return e.stop()}},e)})),function(e){return oi.apply(this,arguments)}),oh=(oc=a(v.mark(function e(t){var n,r,o,a;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.notSupportSubscriptionCheck,o={useRetry:!0,action:ey.SaveAbandonOrder,retryOptions:op},e.next=4,eG.post("/leproxy/api/trade/center/checkout/save/base-on-cart-cookie/return-data",{notSupportSubscriptionCheck:r},o);case 4:if(null!==(n=(a=e.sent).data)&&void 0!==n&&n.success){e.next=7;break}throw a.data;case 7:return e.abrupt("return",a.data.data);case 8:case"end":return e.stop()}},e)})),function(e){return oc.apply(this,arguments)}),oy=(os=a(v.mark(function e(t){var n,r,o;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={useRetry:!0,action:ey.ExpressFirstLoad,retryOptions:op},t.expressCheckoutChannelInfo.methodCode===ea.GooglePay&&(r.useRetry=!1),e.next=4,eG.post("/leproxy/api/trade/center/express/checkout/first-load",t,r);case 4:if(null!==(n=(o=e.sent).data)&&void 0!==n&&n.success){e.next=7;break}throw o.data;case 7:return e.abrupt("return",o.data.data);case 8:case"end":return e.stop()}},e)})),function(e){return os.apply(this,arguments)}),om=(ou=a(v.mark(function e(t){var n,r,o;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={useRetry:!0,action:ey.ExpressUpdateDetail,retryOptions:op},e.next=3,eG.post("/leproxy/api/trade/center/express/checkout/detail",t,r);case 3:if(null!==(n=(o=e.sent).data)&&void 0!==n&&n.success){e.next=6;break}throw o.data;case 6:return e.abrupt("return",o.data.data);case 7:case"end":return e.stop()}},e)})),function(e){return ou.apply(this,arguments)}),og=(ol=a(v.mark(function e(t){var n,r;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,eG.post("/leproxy/api/trade/center/express/checkout/create",t);case 2:if(null!==(n=(r=e.sent).data)&&void 0!==n&&n.success){e.next=5;break}throw r.data;case 5:return e.abrupt("return",r.data.data);case 6:case"end":return e.stop()}},e)})),function(e){return ol.apply(this,arguments)});(oK=od||(od={})).DiscountCode="TCTD0122",oK.NoShippingOption="TC_000000_B0019",oK.IllegalAmount="TC_000000_B0046";var ov=["DISCOUNT_CODE_OR_GIFT_CARD_INVALID","DISCOUNT_CODE_INVALID","DISCOUNT_CODE_EXPIRED","DISCOUNT_CODE_USER_INVALID","DISCOUNT_CODE_USE_TIMES_LIMIT","DISCOUNT_CODE_NO_REACH","UN_MATCH_PAYMENT","UN_MATCH_LOGISTICS"],ob=["DISCOUNT_CODE_REPEAT"],oC=function(e){return(e||[]).map(function(e){return{spuId:e.productSeq,skuId:e.productSku,skuItemNo:e.itemNo,title:e.productName,variant:(e.productSkuAttrList||[]).join(","),price:e.finalPrice,quantity:e.productNum,category:e.customCategoryName}})},ow=function(e){var t,n,r,o=e.seq,a=e.amount,i=e.productInfos,c=(t=void 0===o?"":o,(n=JSON.parse(decodeURIComponent(rN("".concat(t,"_fb_data")))||"{}"))&&n.ed?n.ed:rB());null===(r=window.Shopline.Analytics)||void 0===r||r.track({name:"orderStart",payload:{eventId:"initiateCheckout".concat(c),value:a,list:oC(i)}})},oO=function(e){var t,n=e.eventId,r=e.amount,o=e.price,a=e.productInfos,i=e.channelCode;null===(t=window.Shopline.Analytics)||void 0===t||t.track({name:"orderAddPaymentInfo",payload:{eventId:n,value:r,paymentType:i,productPrice:o,list:oC(a)}})},o_=function(e){var t,n=e.shipping_method,r=e.amount,o=e.productInfos;null===(t=window.Shopline.Analytics)||void 0===t||t.track({name:"orderCompleteStep",payload:{checkout_option:n,checkout_step:3,value:r,list:oC(o)},whitelistTransports:["GoogleAnalytics4"]})};function oS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function oP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oS(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ok=t7(),oI=l(function e(t,n){var r,o,c,s=this;i(this,e),d(this,"checkoutUrl",""),d(this,"abandonedInfo",null),d(this,"createOrderParams",{basicInfo:null,otherInfo:null,buyerInfo:null,marketInfo:null,priceInfo:null,productInfos:null,passThrough:""}),d(this,"expressCheckoutChannelInfo",null),d(this,"shippingMethodName",""),d(this,"firstLoadRes",{status:es.Await,promise:null}),d(this,"getConfig",function(){var e=s.config,t=e.domId,n=e.paymentConfig,r=e.props,o=r.style,a=r.layout,i=r.expressOptimizationSwitch,c=s.extra,u=c.uniqueId,l=c.isSubscription,d=rX(n).map(function(e){var t=rZ({channelCode:e.channelCode,methodCode:e.methodCode},{uniqueId:u,isSubscription:l});return oP(oP({},e),{},{currentDomId:t})});return l&&(d=d.filter(function(e){return e.methodCode===ea.Paypal})),s.logger.info("获取快捷支付按钮配置 payments",{data:{payments:d}}),{language:window.Shopline.locale,payments:d,props:{dynamic:n.isSystem,domId:t,styleOptions:{height:o.height,"border-radius":o["border-radius"],layout:a===rf.Checkout?"horizontal":"vertical"},timeout:{switch:!0},isSubscription:l,scriptParams:l?{"data-namespace":"subscriptionDynamicPaypal"}:void 0,expressOptimizationSwitch:i},loggerFn:function(){return s.logger.withOwner("")},beforeCreateOrder:s.beforeCreateOrder,onChannelModalSuccess:s.onChannelModalSuccess,onFormDataChange:s.onFormDataChange,createOrder:s.createOrder,onError:s.onError,onAllButtonsInitFail:s.onAllButtonsInitFail}}),d(this,"updateCreateOrderParams",function(e){var t,n,r,o,a=(null===(t=s.createOrderParams.otherInfo)||void 0===t?void 0:t.clientLang)||(null===(n=e.otherInfo)||void 0===n||null===(r=n.checkoutLanguageInfo)||void 0===r?void 0:r.displayLanguage)||(null===(o=e.otherInfo)||void 0===o?void 0:o.clientLang);s.createOrderParams.basicInfo=e.basicInfo||null,s.createOrderParams.otherInfo=oP(oP({},e.otherInfo),{},{clientLang:a}),s.createOrderParams.buyerInfo=e.buyerInfo||null,s.createOrderParams.marketInfo=e.marketInfo||null,s.createOrderParams.passThrough=e.passThrough||"",e.priceInfo&&(s.createOrderParams.priceInfo=e.priceInfo),e.productInfos&&(s.createOrderParams.productInfos=e.productInfos)}),d(this,"beforeCreateOrder",(r=a(v.mark(function e(t){var n;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(function(){var e=a(v.mark(function e(t){var n,r,o,a,i,c,u,l,d,p,f,h,y,m,g,b,C;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=t||{}).channelCode,o=n.methodCode,a=n.paymentId,c=(i=s.config).saveAbandonedOrder,u=i.paymentConfig,l=i.props.toast,d={valid:!1},s.logger.info("beforeCreateOrder",{data:{channelCode:r,methodCode:o,paymentId:a}}),s.reportButtonClick(o),r2(rl.ButtonClick,{methodCode:o,buttonLocation:u.buttonLocation}),e.prev=6,s.firstLoadRes.status=es.Pending,e.next=10,c(r3(o));case 10:if(f=(p=e.sent).canContinue,h=p.abandonedInfo,y=p.url,f&&h){e.next=17;break}return s.logger.info("save abandon order process terminated",{data:{abandonedInfo:h,url:y}}),e.abrupt("return",d);case 17:if(s.checkoutUrl=y||"",m={abandonedOrderInfo:h,returnUrl:y||""},r!==eo.SLpayments&&r!==eo.StripeOther||o!==ea.ApplePay&&o!==ea.GooglePay){e.next=40;break}return s.abandonedInfo=h,s.expressCheckoutChannelInfo={channelCode:r,methodCode:o,paymentId:a||"",storeWebsiteUrl:window.location.origin},g={abandonedOrderInfo:{seq:h.seq,checkoutToken:h.checkoutToken,abandonedOrderType:"SETTLE",orderFrom:"MAIN_SITE"},expressCheckoutChannelInfo:s.expressCheckoutChannelInfo,otherInfo:{buyScence:oo[u.buttonLocation]}},s.logger.info("快捷支付请求firstLoad接口",{data:oP({},g)}),e.next=27,oy(g);case 27:if(b=e.sent,s.logger.info("快捷支付firstLoad接口返回",{data:oP({},b)}),!b){e.next=38;break}if(!rQ(b)){e.next=33;break}return s.logger.log("需要跳转"),e.abrupt("return",d);case 33:s.updateCreateOrderParams(b),(C=oP({},b)).payChannelData=r1(C.payChannelData,{expressCheckoutChannelInfo:s.expressCheckoutChannelInfo}),s.shippingMethodName=r0(C.payChannelData,{expressCheckoutChannelInfo:s.expressCheckoutChannelInfo})||"",m.paymentConfig=C;case 38:s.logger.info("快捷支付firstLoad接口返回",{data:oP({},b)}),s.firstLoadRes.status=es.Done;case 40:return s.logger.info("beforeCreateOrder返回值",{data:oP({},m)}),e.abrupt("return",m);case 44:return e.prev=44,e.t0=e.catch(6),s.firstLoadRes.status=es.Fail,window[window.__sl_console__?"__sl_console__":"console"].error("beforeCreateOrder error: ",e.t0),s.logger.error("beforeCreateOrder执行出错",{error:e.t0}),e.t0.code===od.NoShippingOption?l(ok("cart.error.noshipping")):l(ok("cart.error.default")),e.abrupt("return",d);case 51:case"end":return e.stop()}},e,null,[[6,44]])}));return function(t){return e.apply(this,arguments)}})()(t),s.firstLoadRes.promise=n,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)})),d(this,"onChannelModalSuccess",function(e){var t=s.config.paymentConfig.buttonLocation;if(r2(rl.ModalOpen,{methodCode:e.methodCode,buttonLocation:t}),e.methodCode!==ea.Paypal)try{var n,r=s.createOrderParams,o=r.priceInfo,a=r.productInfos,i=(null==o?void 0:o.originalSettleSumAmount)||(null==o?void 0:o.orderAmount),c=e.settleCurrency;ow({seq:null===(n=s.abandonedInfo)||void 0===n?void 0:n.seq,amount:i,productInfos:a}),rx.reportConversionEvent(rv.InitiateCheckout,{currency:c,orderAmount:i,productInfos:a})}catch(e){s.logger.error("开始结账事件上报出错",{error:e})}}),d(this,"onFormDataChange",(o=a(v.mark(function e(t,n){var r,o,i,c,u,l;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o={code:or.UpdateFail,message:ok("cart.error.renew")},s.logger.log("onFormDataChange",{data:{firstLoadRes:s.firstLoadRes}}),d(r={},es.Await,function(){}),d(r,es.Done,a(v.mark(function e(){return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))),d(r,es.Fail,function(){}),d(r,es.Pending,a(v.mark(function e(){return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.firstLoadRes.promise;case 2:case"end":return e.stop()}},e)}))),i=r[s.firstLoadRes.status],e.next=6,i();case 6:return c={abandonedOrderInfo:s.abandonedInfo,expressCheckoutChannelInfo:s.expressCheckoutChannelInfo,basicInfo:oP(oP({},s.createOrderParams.basicInfo),{},{action:n}),otherInfo:s.createOrderParams.otherInfo,buyerInfo:s.createOrderParams.buyerInfo,payChannelData:t,passThrough:s.createOrderParams.passThrough},s.logger.info("快捷支付请求弃单更新参数",{data:oP({},c)}),e.next=10,om(c).catch(function(e){return s.logger.error("快捷支付弃单更新失败",{error:e}),e.code===od.NoShippingOption&&(o.message=ok("cart.error.noshipping")),e.code===od.DiscountCode&&ov.includes(e.msg)&&(o.message=ok("transaction.discount.code_error")),e.code===od.DiscountCode&&ob.includes(e.msg)&&(o.message=ok("cart.couponCode.existCode")),{error:o}});case 10:if(u=e.sent,s.logger.info("快捷支付弃单更新返回值",{data:oP({},u)}),s.isValidReturn(u)){e.next=14;break}return e.abrupt("return",u);case 14:if(!rQ(u)){e.next=17;break}return s.logger.log("需要跳转"),e.abrupt("return",{error:{code:or.UpdateFail,message:ok("cart.error.renew")}});case 17:if(s.updateCreateOrderParams(u),!s.expressCheckoutChannelInfo){e.next=22;break}return l=r1(u.payChannelData,{expressCheckoutChannelInfo:s.expressCheckoutChannelInfo}),s.shippingMethodName=r0(l,{expressCheckoutChannelInfo:s.expressCheckoutChannelInfo})||"",e.abrupt("return",l);case 22:return e.abrupt("return",u.payChannelData);case 23:case"end":return e.stop()}},e)})),function(e,t){return o.apply(this,arguments)})),d(this,"createOrder",(c=a(v.mark(function e(t,n){var r,o,a,i,c,u,l,d,p,f,h,y,m,g,b,C,w,O,_,S,P,k,I,E,x,T,A,L,D,j,N;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.payChannelData,a=n.token,i="",window.__DF__&&"function"==typeof window.__DF__.getToken&&(i=window.__DF__.getToken()),u=(c=r4()).sid,l=c.createAt,d="",window.HdSdk&&window.HdSdk.shopTracker&&"function"==typeof window.HdSdk.shopTracker.getDataId&&(d=window.HdSdk.shopTracker.getDataId()),p="addPaymentInfo".concat(rB()),f={abandonedOrderInfo:s.abandonedInfo,expressCheckoutChannelInfo:s.expressCheckoutChannelInfo,basicInfo:s.createOrderParams.basicInfo,otherInfo:oP(oP({},s.createOrderParams.otherInfo),{},{dfpToken:i}),buyerInfo:s.createOrderParams.buyerInfo,marketInfo:s.createOrderParams.marketInfo,passThrough:s.createOrderParams.passThrough,payChannelData:o,instrumentOption:a,sessionInfo:{sessionId:u,sessionCreateTime:l},dataReportReq:{eventName:"AddPaymentInfo",dataId:d,eventTime:Date.now(),eventId:p,currency:t.settleCurrency,payAmount:null===(r=s.createOrderParams.priceInfo)||void 0===r?void 0:r.originalSettleSumAmount},clientInfo:n3()},h={error:{code:or.CreateFail,message:ok("cart.error.order")}},s.logger.info("快捷支付请求下单",{data:oP({},f)}),e.next=12,og(f).catch(function(e){if(s.logger.error("快捷支付下单失败",{error:e}),e.code===od.IllegalAmount){var t=window.Shopline.storeId,n="".concat(window.location.protocol,"//").concat(window.location.host,"/").concat(t,"/checkouts/").concat(f.abandonedOrderInfo.checkoutToken);s.logger.info("下单金额不一致，跳转结算页",{data:{url:n}}),window.location.href=n}return h});case 12:if(y=e.sent,s.logger.info("快捷支付请求下单返回值",{data:oP({},y)}),s.isValidReturn(y)){e.next=16;break}return e.abrupt("return",y);case 16:if(!rQ(y)){e.next=19;break}return s.logger.info("需要跳转"),e.abrupt("return",h);case 19:try{C=(b=s.createOrderParams).basicInfo,w=b.otherInfo,O=b.priceInfo,_=b.productInfos,o_({amount:null==O?void 0:O.originalSettleSumAmount,productInfos:_,shipping_method:s.shippingMethodName}),oO({eventId:p,amount:null==O?void 0:O.originalSettleSumAmount,price:null==O?void 0:O.productSumAmount,productInfos:_,channelCode:null===(m=s.expressCheckoutChannelInfo)||void 0===m?void 0:m.channelCode}),S=(null==O?void 0:O.originalSettleSumAmount)||(null==O?void 0:O.orderAmount),P=t.settleCurrency||"",k={payment_method:null===(g=s.expressCheckoutChannelInfo)||void 0===g?void 0:g.channelCode,shipping_method:s.shippingMethodName,coupon_code:null==C?void 0:C.discountCode,currency:P,orderAmount:S,productInfos:y.productInfos||[],basicInfo:C,otherInfo:w},rx.reportConversionEvent(rv.AddCustomerInfo,k),rx.reportConversionEvent(rv.AddShippingInfo,k),rx.reportAddPaymentInfo(k)}catch(e){s.logger.error("完成订单事件上报出错",{error:e})}return e.prev=20,x=y.orderMark,T=y.orderSeq,A=y.transactionId,L=y.paySeq,D=y.nextAction,j={orderMark:x,orderSeq:T,transactionId:A,paySeq:L,abOrderSeq:null===(I=s.abandonedInfo)||void 0===I?void 0:I.seq,abOrderMark:null===(E=s.abandonedInfo)||void 0===E?void 0:E.mark},sessionStorage.setItem("processing_data",JSON.stringify(j)),N=JSON.parse(D),e.abrupt("return",{nextAction:N});case 28:return e.prev=28,e.t0=e.catch(20),s.logger.error("快捷支付下单，解析数据失败",{error:e.t0,data:y}),e.abrupt("return",h);case 32:case"end":return e.stop()}},e,null,[[20,28]])})),function(e,t){return c.apply(this,arguments)})),d(this,"onError",function(e,t,n){var r=s.config.props.toast;if("createExpected"===t){var o=r5.exclude(s.checkoutUrl,["spb"]);return s.logger.warn("下单异常，跳到结算页",{data:{url:o}}),void(window.location.href=o)}s.logger.error("快捷支付流程出错",{error:e,data:{type:t,extData:n}}),t===en.PullUpChannel&&r(ok("cart.error.default"))}),d(this,"onAllButtonsInitFail",function(){rC(s.config.paymentConfig)&&(s.logger.info("所有快捷支付按钮渲染失败，渲染兜底buy now按钮"),s.extra.onAllButtonsInitFail())}),d(this,"isValidReturn",function(e){return!(!e||e.error)}),d(this,"reportButtonClick",function(e){var t=s.config.paymentConfig.buttonLocation,n=rd[e]||"";n?rx.reportPayButtonClick(n,t):window[window.__sl_console__?"__sl_console__":"console"].warn("快捷支付按钮点击上报，未知的按钮支付方式: ".concat(e))}),this.config=t,this.extra=n,this.logger=this.config.props.logger.pipeOwner("ExpressConfig")});function oE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ox(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function oT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ox(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ox(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var oA=t7(),oL=function(e){n6(r,ri);var t,n=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=n8(r);return e=t?Reflect.construct(n,arguments,n8(this).constructor):n.apply(this,arguments),n9(this,e)});function r(e){i(this,r),d(n4(c=n.call(this,e)),"expressInstance",null),d(n4(c),"subscriptionExpressInstance",null),d(n4(c),"isVisible",!1),d(n4(c),"isSubscription",!1),d(n4(c),"isAllButtonsInitFail",!1),d(n4(c),"render",a(v.mark(function e(){var t,n,r,o;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c.logger.info("render"),c.needRender){e.next=3;break}return e.abrupt("return",[]);case 3:if(n=(t=c.config.props).isPreview,r=t.isSubscription,o=t.isVisible,c.isVisible=o,c.isSubscription=!!r,c.insertButtonContainer(c.configList),n&&(c.logger.info("预览模式，渲染按钮遮罩层，阻断下单"),c.addMaskListener()),!r){e.next=14;break}return c.logger.info("订阅模式，渲染订阅和普通按钮"),e.next=12,Promise.all([c.renderSceneButton(!0),c.renderSceneButton(!1)]);case 12:e.next=17;break;case 14:return c.logger.info("普通模式，渲染普通按钮"),e.next=17,c.renderSceneButton(!1);case 17:if(!c.isAllButtonsInitFail){e.next=19;break}return e.abrupt("return",Promise.reject(Error("all button init failed.")));case 19:return e.abrupt("return",c.getRenderedList());case 20:case"end":return e.stop()}},e)}))),d(n4(c),"rerender",(t=a(v.mark(function e(t){var n,r,o,a,i,s,u;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:var l,d;if(c.logger.info("rerender"),n=c.configList,r=rX(t),l=n,d=r,l.map(function(e){return"".concat(e.channelCode,"_").concat(e.methodCode)}).sort().join(",")!==d.map(function(e){return"".concat(e.channelCode,"_").concat(e.methodCode)}).sort().join(",")||c.renderedList.length!==r.length){e.next=6;break}return c.logger.info("same paymentConfig, no need to rerender"),e.abrupt("return");case 6:if(o=function(e){return rZ({channelCode:e.channelCode,methodCode:e.methodCode},{uniqueId:c.uniqueId,isSubscription:c.isSubscription})},(a=r.filter(function(e){if(n.find(function(t){return t.channelCode===e.channelCode&&t.methodCode===e.methodCode}))return!1;var t,r=o(e);return null===(t=c.container)||void 0===t||!t.querySelector("#".concat(r))})).length&&c.insertButtonContainer(a),i=r.map(function(e){var t=o(e);return oT(oT({},e),{},{currentDomId:t})}),!c.isSubscription){e.next=15;break}return e.next=13,null===(s=c.subscriptionExpressInstance)||void 0===s?void 0:s.rerender(i.filter(function(e){return e.methodCode===ea.Paypal}));case 13:e.next=17;break;case 15:return e.next=17,null===(u=c.expressInstance)||void 0===u?void 0:u.rerender(i);case 17:c.setVisible(!0),c.configList=r;case 19:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})),d(n4(c),"setDisabled",function(e){var t,n;c.logger.info("setDisabled",{data:e}),c.needRender&&(null===(t=c.expressInstance)||void 0===t||t.setDisabled(e),null===(n=c.subscriptionExpressInstance)||void 0===n||n.setDisabled(e))}),d(n4(c),"setVisible",function(e){var t,n;if(c.logger.info("setVisible",{data:e}),c.needRender){c.isVisible=e,c.setPaypalBgVisible(!1);var r,o=rC(c.config.paymentConfig),a=null===(t=c.container)||void 0===t?void 0:t.querySelectorAll(".".concat(rr.COMMON_ITEM_EXPRESS,":not(.").concat(rr.BUTTON_SUBSCRIPTION,")"));o&&(a=c.getDynamicButtonElements()),c.isSubscription&&(c.logger.info("订阅模式：只控制paypal按钮"),a=null===(r=c.container)||void 0===r?void 0:r.querySelectorAll(".".concat(rr.COMMON_ITEM_EXPRESS,".").concat(rr.BUTTON_SUBSCRIPTION))),null===(n=a)||void 0===n||n.forEach(function(t){e?null==t||t.classList.remove(rr.BUTTON_HIDE):null==t||t.classList.add(rr.BUTTON_HIDE)}),c.setPaypalBgVisible(!0)}}),d(n4(c),"setSubscription",function(e){var t,n,r;if(c.logger.info("setSubscription",{data:e}),c.needRender&&(c.isSubscription=e,c.setPaypalBgVisible(!1),c.isVisible)){var o,a=rC(c.config.paymentConfig),i=null===(t=c.container)||void 0===t?void 0:t.querySelectorAll(".".concat(rr.COMMON_ITEM_EXPRESS,".").concat(rr.BUTTON_SUBSCRIPTION)),s=null===(n=c.container)||void 0===n?void 0:n.querySelectorAll(".".concat(rr.COMMON_ITEM_EXPRESS,":not(.").concat(rr.BUTTON_SUBSCRIPTION,")"));if(a&&(s=c.getDynamicButtonElements()),e)return null==i||i.forEach(function(e){null==e||e.classList.remove(rr.BUTTON_HIDE)}),null===(o=s)||void 0===o||o.forEach(function(e){null==e||e.classList.add(rr.BUTTON_HIDE)}),void(c.subscriptionExpressInstance||c.renderSceneButton(!0));null===(r=s)||void 0===r||r.forEach(function(e){null==e||e.classList.remove(rr.BUTTON_HIDE)}),null==i||i.forEach(function(e){null==e||e.classList.add(rr.BUTTON_HIDE)}),c.expressInstance||c.renderSceneButton(!1),c.setPaypalBgVisible(!0)}}),d(n4(c),"insertButtonContainer",function(e){var t,n=c.config,r=n.paymentConfig,o=n.props,a=o.isPreview,i=o.style,s=o.isSubscription,u=function(e,t){return'\n      <div\n        class="'.concat(rr.COMMON_ITEM," ").concat(rr.COMMON_ITEM_EXPRESS," pay-button-").concat(e.methodCode," ").concat(t?rr.BUTTON_SUBSCRIPTION:""," ").concat(s!==t?rr.BUTTON_HIDE:""," ").concat(rr.BUTTON_HIDE,'"\n        id="').concat(rZ(e,{uniqueId:c.uniqueId,isSubscription:t}),'"\n      >').concat(a?'<div class="'.concat(rr.BUTTON_MASK,'"></div>'):"").concat(e.methodCode===ea.Paypal&&0===i["border-radius"]?'<div class="'.concat(rr.PAY_PAL_BG_BEFORE,'"></div><div class="').concat(rr.PAY_PAL_BG_AFTER,'"></div>'):"","</div>\n    ")},l=rb(r).includes(rn.PAY_PAL),d=e.map(function(e){return u(e)}).join("\n");l&&(d+=u({channelCode:eo.Paypal,methodCode:ea.Paypal},!0)),null===(t=c.container)||void 0===t||t.insertAdjacentHTML("beforeend",d)}),d(n4(c),"getExpressPaymentConfig",function(e){return new oI(c.config,{uniqueId:c.uniqueId,onAllButtonsInitFail:function(){return c.isAllButtonsInitFail=!0},isSubscription:e}).getConfig()}),d(n4(c),"addMaskListener",function(){var e,t=c.config.props.toast,n=null===(e=c.container)||void 0===e?void 0:e.querySelectorAll(".".concat(rr.COMMON_ITEM_EXPRESS));null==n||n.forEach(function(e){e.addEventListener("click",function(){t(oA("products.product_details.link_preview_does_not_support"))})})}),d(n4(c),"renderSceneButton",(o=a(v.mark(function e(t){var n,r;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.logger.info("renderSceneButton",{data:t}),n=c.getExpressPaymentConfig(t),c.logger.info("expressPaymentConfig",{data:oT({},n)}),r=new rz(n),e.next=6,r.render();case 6:t?c.subscriptionExpressInstance=r:c.expressInstance=r;case 7:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})),d(n4(c),"getDynamicButtonElements",function(){c.logger.info("动态结算模式：只控制一种渠道的按钮 paypal/gp/ap");var e,t=void 0,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return oE(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oE(e,void 0)}}(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}(rh);try{for(n.s();!(e=n.n()).done;){var r,o,a=e.value,i=rr[a],s=null===(o=c.container)||void 0===o?void 0:o.querySelector(".".concat(i,":not(.").concat(rr.BUTTON_SUBSCRIPTION,")"));if(s&&!s.className.includes("smart-payment-hide")){c.logger.info("控制支付方式: ".concat(a)),t=null===(r=c.container)||void 0===r?void 0:r.querySelectorAll(".".concat(i,":not(.").concat(rr.BUTTON_SUBSCRIPTION,")"));break}}}catch(e){n.e(e)}finally{n.f()}return t}),d(n4(c),"setPaypalBgVisible",function(e){var t,n=null===(t=c.container)||void 0===t?void 0:t.querySelectorAll(".".concat(rr.PAY_PAL_BG_BEFORE,", .").concat(rr.PAY_PAL_BG_AFTER));e?setTimeout(function(){null==n||n.forEach(function(e){e.style.opacity="1"})},200):null==n||n.forEach(function(e){e.style.opacity="0"})});var t,o,c,s=e.buttonTypes;return c.logger=c.config.props.logger.pipeOwner("ExpressButton"),c.needRender=!s||s.includes(rt.Express),c.configList=rX(e.paymentConfig),c.uniqueId=rj(),c}return l(r,[{key:"getRenderedList",value:function(){if(!this.isVisible||!this.needRender)return[];var e=this.expressInstance;return this.isSubscription&&(e=this.subscriptionExpressInstance),e&&e.renderList.filter(function(e){return e.instance.initSuccess&&e.instance.isVisible}).map(function(e){return e.instance.name})||[]}}]),r}(),oD=function(e){var t,n=e.buttonTypeDataList.find(function(e){return e.buttonType===rt.Fast});if(!n)return"";var r=n.buttonNameDataList.find(function(e){return e.buttonName===rn.SHOP_BY_FAST_CHECKOUT});return r&&(null===(t=r.buttonConfigData.configData)||void 0===t?void 0:t.checkoutUrl)||""},oj=t7(),oN='<svg width="68" height="18" viewBox="0 0 68 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M14.3554 0.772522L14.3313 0.488281H11.2835L11.2668 0.781076C11.2627 0.852932 11.2607 0.926892 11.2607 1.0029V14.5641H14.3657V8.86666C14.4287 8.35695 14.6465 7.95264 15.0213 7.63644L15.0234 7.63464L15.0255 7.6328C15.4044 7.30127 15.8744 7.13003 16.4563 7.13003C16.8955 7.13003 17.2325 7.22397 17.4873 7.39011L17.4938 7.39433L17.5005 7.39823C17.7749 7.55832 17.9804 7.78526 18.1202 8.08814C18.2633 8.39812 18.34 8.77287 18.34 9.22071V14.5641H21.4243V9.24141C21.4243 8.23355 21.2225 7.33936 20.8076 6.56883C20.3967 5.80576 19.8351 5.20518 19.1236 4.7748C18.4085 4.3284 17.5992 4.10787 16.7047 4.10787C16.0374 4.10787 15.4469 4.25649 14.9475 4.56832C14.7377 4.69697 14.5435 4.83297 14.3657 4.97654V1.0236C14.3657 0.937544 14.3623 0.853814 14.3554 0.772522Z" fill="#052855"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M25.4418 4.03229C26.1167 3.73912 26.8347 3.5932 27.5927 3.5932C28.6108 3.5932 29.542 3.84101 30.3789 4.33978C31.2108 4.82179 31.8762 5.48035 32.3719 6.31141C32.8722 7.15015 33.1195 8.09606 33.1195 9.14074C33.1195 9.96627 32.9673 10.7276 32.6578 11.4202L32.6573 11.4213L32.6568 11.4225C32.3507 12.0929 31.9342 12.678 31.4076 13.1752L31.406 13.1768L31.4043 13.1784C30.8803 13.6587 30.2898 14.0306 29.6342 14.293C28.9905 14.5562 28.3231 14.6883 27.6341 14.6883C26.9319 14.6883 26.245 14.5564 25.5752 14.2943L25.5713 14.2928L25.5675 14.2912C24.9128 14.0148 24.3169 13.6293 23.7809 13.1367L23.7793 13.1353L23.7777 13.1338C23.2524 12.6376 22.8298 12.0543 22.5102 11.3861L22.509 11.3836L22.5079 11.3811C22.198 10.7023 22.0452 9.96097 22.0452 9.16144C22.0452 8.3899 22.191 7.66441 22.4849 6.98836C22.7762 6.31833 23.1777 5.72684 23.6886 5.21593C24.1991 4.70539 24.784 4.31025 25.4418 4.03229ZM27.572 6.65676C27.1143 6.65676 26.7078 6.76736 26.3449 6.98511L26.3416 6.9871L26.3382 6.989C25.9745 7.19508 25.6826 7.48553 25.4609 7.86695C25.2559 8.22928 25.1501 8.64431 25.1501 9.12004C25.1501 9.6505 25.2694 10.0955 25.4965 10.4669C25.7309 10.8364 26.0298 11.1228 26.395 11.3309C26.7783 11.5277 27.1763 11.6247 27.5927 11.6247C27.995 11.6247 28.3791 11.5279 28.7491 11.3309C29.1274 11.1231 29.4326 10.8307 29.667 10.4482L29.6689 10.4451L29.6709 10.4421C29.9102 10.0712 30.0353 9.62772 30.0353 9.09934C30.0353 8.61079 29.9231 8.19116 29.7069 7.83081L29.7049 7.82749L29.703 7.82414C29.4961 7.45903 29.2123 7.17519 28.8472 6.9683C28.4857 6.76348 28.0637 6.65676 27.572 6.65676Z" fill="#052855"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M33.7459 8.26328H33.7403V17.2702H36.7832V13.5593C36.8987 13.618 37.0167 13.6728 37.137 13.7236C37.8118 14.0168 38.5298 14.1627 39.2878 14.1627C40.3059 14.1627 41.2371 13.9149 42.074 13.4161C42.9059 12.9341 43.5713 12.2756 44.0671 11.4445C44.5674 10.6058 44.8147 9.65985 44.8147 8.61517C44.8147 7.78964 44.6624 7.02827 44.353 6.33573L44.3525 6.33459L44.352 6.33345C44.0459 5.66302 43.6293 5.07796 43.1028 4.58068L43.1011 4.57909L43.0994 4.57753C42.5755 4.09726 41.985 3.7253 41.3294 3.46289C40.6856 3.19971 40.0182 3.06764 39.3292 3.06764C38.627 3.06764 37.9401 3.19949 37.2703 3.46158L37.2665 3.46308L37.2627 3.46468C36.6079 3.74115 36.0121 4.12657 35.476 4.61919L35.4744 4.62062L35.4729 4.62208C34.9475 5.11827 34.525 5.70164 34.2054 6.36983L34.2042 6.37233L34.203 6.37485C33.9412 6.94852 33.7912 7.56669 33.7512 8.22799C33.7504 8.23174 33.7498 8.2349 33.7494 8.23729L33.7488 8.24116L33.7487 8.24134C33.7475 8.249 33.7467 8.25541 33.7463 8.25929L33.7459 8.26328ZM37.1916 7.28898C37.426 6.91948 37.725 6.63309 38.0902 6.42503C38.4735 6.22821 38.8715 6.1312 39.2878 6.1312C39.6901 6.1312 40.0743 6.22802 40.4442 6.42501C40.8225 6.63281 41.1277 6.9252 41.3622 7.30774L41.3641 7.3108L41.366 7.31382C41.6053 7.68474 41.7304 8.12819 41.7304 8.65657C41.7304 9.14512 41.6183 9.56475 41.4021 9.92511L41.4001 9.92842L41.3982 9.93178C41.1913 10.2969 40.9075 10.5807 40.5424 10.7876C40.1809 10.9924 39.7588 11.0991 39.2672 11.0991C38.8095 11.0991 38.4029 10.9886 38.04 10.7708L38.0367 10.7688L38.0333 10.7669C37.6697 10.5608 37.3778 10.2704 37.156 9.88896C36.951 9.52663 36.8453 9.1116 36.8453 8.63587C36.8453 8.10542 36.9645 7.66038 37.1916 7.28898Z" fill="#052855"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M48.4788 0.731349H45.436V8.98816C45.436 9.63584 45.6305 10.289 45.8987 10.8766L45.8999 10.8791L45.9011 10.8816C46.2206 11.5498 46.6432 12.1332 47.1686 12.6294L47.1701 12.6308L47.1717 12.6322C47.7078 13.1249 48.3036 13.5103 48.9584 13.7868L48.9622 13.7884L48.966 13.7899C49.6358 14.0519 50.3227 14.1838 51.0249 14.1838C51.7139 14.1838 52.3813 14.0517 53.0251 13.7885C53.6807 13.5261 54.2712 13.1542 54.7951 12.6739L54.7968 12.6723L54.7985 12.6708C55.325 12.1735 55.7416 11.5884 56.0476 10.918L56.0481 10.9168L56.0487 10.9157C56.3581 10.2232 56.5104 9.46179 56.5104 8.63626C56.5104 7.59159 56.263 6.64568 55.7627 5.80694C55.267 4.97588 54.6016 4.31733 53.7697 3.83532C52.9328 3.33654 52.0016 3.08873 50.9835 3.08873C50.2255 3.08873 49.5075 3.23465 48.8327 3.52781C48.7123 3.57866 48.5944 3.63345 48.4788 3.69218V0.731349ZM49.7357 6.48064C50.0986 6.26289 50.5051 6.15229 50.9628 6.15229C51.4545 6.15229 51.8766 6.259 52.238 6.46383C52.6031 6.67072 52.887 6.95456 53.0939 7.31966L53.0958 7.32302L53.0977 7.32633C53.314 7.68669 53.4261 8.10632 53.4261 8.59487C53.4261 9.12325 53.301 9.56669 53.0617 9.93762L53.0597 9.94064L53.0579 9.9437C52.8234 10.3262 52.5182 10.6186 52.1399 10.8264C51.7699 11.0234 51.3858 11.1202 50.9835 11.1202C50.5672 11.1202 50.1691 11.0232 49.7858 10.8264C49.4207 10.6184 49.1217 10.332 48.8873 9.96246C48.6602 9.59106 48.541 9.14602 48.541 8.61557C48.541 8.13984 48.6467 7.72481 48.8517 7.36248C49.0735 6.98105 49.3653 6.69061 49.729 6.48453L49.7324 6.48263L49.7357 6.48064Z" fill="#052855"/>\n<path d="M56.2303 15.1868L56.3274 15.0898L54.6696 13.432L54.5726 13.529C54.1048 13.9968 53.5494 14.3679 52.9382 14.621C52.327 14.8742 51.6719 15.0045 51.0104 15.0045C50.3488 15.0045 49.6937 14.8742 49.0825 14.621C48.4713 14.3679 47.916 13.9968 47.4482 13.529L47.3511 13.432L45.6934 15.0898L45.7904 15.1868C46.4759 15.8723 47.2897 16.4161 48.1853 16.7871C49.081 17.158 50.0409 17.349 51.0104 17.349C51.9798 17.349 52.9398 17.158 53.8354 16.7871C54.731 16.4161 55.5448 15.8723 56.2303 15.1868Z" fill="#052855"/>\n<path d="M56.2101 3.96665H59.2163L61.9071 9.98946L64.6136 3.96665H67.6248L61.5697 17.2792H58.5541L60.3986 13.3416L56.2101 3.96665Z" fill="#052855"/>\n<path d="M3.03671 1.04181C3.69296 0.702008 4.43508 0.53557 5.2564 0.53557C5.774 0.53557 6.24259 0.585665 6.65971 0.689121C7.07665 0.777637 7.4409 0.899338 7.74776 1.05804C8.04854 1.19592 8.30366 1.34427 8.50743 1.5054C8.69941 1.63749 8.85568 1.76297 8.96249 1.88132C9.10051 2.0124 9.23762 2.16318 9.37706 2.34031C9.81301 2.89408 10.0908 3.60793 10.1819 4.40262L10.217 4.7084H7.39709L7.34038 4.50901C7.33619 4.49427 7.33183 4.47997 7.32732 4.4661L7.32448 4.45736L7.32223 4.44846C7.20991 4.00354 6.92075 3.65909 6.49182 3.45493L6.48403 3.45123L6.47649 3.44704C6.3431 3.37294 6.19646 3.31545 6.03549 3.27533L6.03385 3.27492L6.03221 3.27449C5.82951 3.22131 5.56668 3.19185 5.23802 3.19185C5.0208 3.19185 4.80967 3.22427 4.60364 3.28913L4.59908 3.29057L4.59447 3.29184C4.40825 3.34342 4.25463 3.42385 4.12843 3.53031L4.12355 3.53443L4.11848 3.53832C3.99314 3.63444 3.89079 3.75449 3.81102 3.90155C3.74657 4.04195 3.71129 4.20689 3.71129 4.40165C3.71129 4.66354 3.7798 4.859 3.90033 5.00816C4.0521 5.16745 4.26069 5.31014 4.53538 5.43116C4.83087 5.5488 5.16385 5.66147 5.5349 5.76887C5.91659 5.87935 6.30434 5.99594 6.69815 6.11863L6.70062 6.1194L6.70307 6.12022C7.11768 6.25801 7.5258 6.42078 7.9274 6.60846C8.34285 6.80262 8.71492 7.04943 9.04217 7.34916C9.3803 7.64647 9.64687 8.02121 9.84443 8.46721C10.0484 8.91539 10.1442 9.45101 10.1442 10.0639C10.1442 10.7711 10.0086 11.402 9.72789 11.9485C9.45148 12.4865 9.07411 12.9296 8.59649 13.2736C8.1287 13.6104 7.60941 13.8562 7.04052 14.0112C6.47758 14.1768 5.90713 14.2598 5.32992 14.2598C4.75639 14.2598 4.22726 14.19 3.74478 14.047L3.74378 14.0467L3.74279 14.0464C3.56682 13.9927 3.39763 13.9333 3.23535 13.868L3.22469 13.8911L2.97547 13.7761C2.40551 13.513 1.74507 13.1129 1.22848 12.4567C0.691295 11.7743 0.386719 10.9129 0.386719 9.87693V9.60244H3.20241V9.87693C3.20241 9.92922 3.20403 9.97851 3.20705 10.025L3.20844 10.0463L3.2065 10.0677C3.20371 10.0982 3.2023 10.1291 3.2023 10.1603C3.2023 10.7928 3.82094 11.4104 4.78746 11.5557L4.79397 11.5567L4.80041 11.558C4.95298 11.5884 5.10489 11.6036 5.2564 11.6036C5.70989 11.6036 6.09378 11.5457 6.41303 11.4366C6.727 11.3172 6.9561 11.15 7.11522 10.9417L7.11767 10.9385L7.12022 10.9354C7.28063 10.7378 7.37128 10.4733 7.37128 10.1189C7.37128 9.85231 7.28969 9.65672 7.13951 9.50699L7.1338 9.5013L7.12843 9.49528C6.96362 9.31042 6.73485 9.14812 6.43178 9.01383L6.42796 9.01214L6.4242 9.01033C6.10892 8.85898 5.74944 8.72353 5.34458 8.60481L5.33989 8.60343L5.33525 8.60189C4.92876 8.4668 4.51638 8.31957 4.09813 8.16021C3.7962 8.05964 3.49484 7.94056 3.19407 7.80312L3.18985 7.80119L3.18569 7.79912C2.87931 7.64639 2.59127 7.47416 2.32184 7.28228L2.31924 7.28044L2.31669 7.27853C2.05266 7.0811 1.81549 6.85107 1.60531 6.58913L1.60062 6.58329L1.59626 6.5772C1.39496 6.29623 1.23605 5.97801 1.11796 5.6248C0.996191 5.26061 0.938373 4.84524 0.938373 4.38333C0.938373 3.64028 1.12203 2.97647 1.49689 2.40199C1.86828 1.82062 2.38431 1.36742 3.03671 1.04181Z" fill="#052855"/>\n</svg>\n',oB='<button class="btn '.concat(rr.SHOP_BY_FAST_CHECKOUT,"-item ").concat(rr.SHOP_BY_FAST_CHECKOUT,'-securey">\n  <svg width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M10.4851 3.19066C8.89661 3.19066 7.60892 4.47835 7.60892 6.06679V6.98466H13.3612V6.06679C13.3612 4.47835 12.0735 3.19066 10.4851 3.19066ZM6.01787 6.06679V6.98466H5.5895C4.23763 6.98466 3.14172 8.08056 3.14172 9.43243V15.5519C3.14172 16.9037 4.23763 17.9996 5.5895 17.9996H15.3806C16.7324 17.9996 17.8284 16.9037 17.8284 15.5519V9.43243C17.8284 8.08056 16.7324 6.98466 15.3806 6.98466H14.9522V6.06679C14.9522 3.59964 12.9522 1.59961 10.4851 1.59961C8.0179 1.59961 6.01787 3.59964 6.01787 6.06679ZM5.5895 8.57571H15.3806C15.8537 8.57571 16.2373 8.95927 16.2373 9.43243V15.5519C16.2373 16.025 15.8537 16.4086 15.3806 16.4086H5.5895C5.11634 16.4086 4.73278 16.025 4.73278 15.5519V9.43243C4.73278 8.95927 5.11634 8.57571 5.5895 8.57571ZM11.2194 12.7853C11.6584 12.5313 11.9538 12.0567 11.9538 11.513C11.9538 10.7019 11.2962 10.0444 10.4851 10.0444C9.67399 10.0444 9.01645 10.7019 9.01645 11.513C9.01645 12.0566 9.31176 12.5312 9.75071 12.7852V14.4504C9.75071 14.8559 10.0795 15.1847 10.485 15.1847C10.8906 15.1847 11.2194 14.8559 11.2194 14.4504V12.7853Z" fill="#052855"/>\n  </svg>\n  <span>').concat(oj("unvisiable.shopby.button.show"),"</span>\n</button>"),oR=function(e){n6(r,ri);var t,n=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=n8(r);return e=t?Reflect.construct(n,arguments,n8(this).constructor):n.apply(this,arguments),n9(this,e)});function r(e){i(this,r),d(n4(o=n.call(this,e)),"isCheckout",!1),d(n4(o),"render",a(v.mark(function e(){var t;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o.logger.info("render"),o.needRender){e.next=3;break}return e.abrupt("return",[]);case 3:return t=o.insertDom(),o.addListener(),o.isCheckout||o.createAnimateInterval(),o.renderedList=t,e.abrupt("return",t);case 8:case"end":return e.stop()}},e)}))),d(n4(o),"insertDom",function(){var e,t,n=rb(o.config.paymentConfig).includes(rn.SHOP_BY_FAST_CHECKOUT);if(o.logger.info("insertDom hasShopby",{data:n}),!n)return[];var r='<div class="'.concat(rr.COMMON_ITEM," ").concat(rr.BUTTON_HIDE," ").concat(rr.SHOP_BY_FAST_CHECKOUT,'">\n      <div class="').concat(rr.SHOP_BY_FAST_CHECKOUT,'-group">\n        ').concat(oB,'\n        <button class="btn ').concat(rr.SHOP_BY_FAST_CHECKOUT,'-item shopby-text-btn">\n          ').concat(oN,'\n          <span>Checkout</span>\n        </button>\n      </div>\n      <span class="loading-icon" />\n    </div>');return o.isCheckout&&(r='<div class="'.concat(rr.COMMON_ITEM," ").concat(rr.BUTTON_HIDE," ").concat(rr.SHOP_BY_FAST_CHECKOUT,' checkout">\n        <div class="').concat(rr.SHOP_BY_FAST_CHECKOUT,'-group">\n          <button class="btn ').concat(rr.SHOP_BY_FAST_CHECKOUT,'-item shopby-text-btn">\n            ').concat(oN,'\n          </button>\n        </div>\n        <span class="loading-icon" />\n      </div>')),null===(e=o.container)||void 0===e||e.insertAdjacentHTML("beforeend",r),o.buttonElement=(null===(t=o.container)||void 0===t?void 0:t.querySelector(".".concat(rr.SHOP_BY_FAST_CHECKOUT)))||null,[rn.SHOP_BY_FAST_CHECKOUT]}),d(n4(o),"addListener",function(){var e=n4(o).buttonElement;e&&(e.removeEventListener("click",o.handleClick),e.addEventListener("click",o.handleClick))}),d(n4(o),"handleClick",(t=a(v.mark(function e(t){var n,r,a,i,c,s,u,l,d,p,f,h,y,m,g,b,C,w,O,_,S;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c=(i=o.config).paymentConfig.buttonLocation,s=i.saveAbandonedOrder,l=(u=i.props).isPreview,d=u.toast,rx.reportPayButtonClick(rn.SHOP_BY_FAST_CHECKOUT,c),!l){e.next=7;break}return o.logger.info("预览模式，按钮点击触发toast提示"),d(oj("products.product_details.link_preview_does_not_support")),e.abrupt("return");case 7:if(!o.isDisabled&&!o.isLoading){e.next=10;break}return o.logger.info("按钮不可点击",{data:{isDisabled:o.isDisabled,isLoading:o.isLoading}}),e.abrupt("return");case 10:return o.setLoading(!0),e.next=13,s(rn.SHOP_BY_FAST_CHECKOUT);case 13:if(f=(p=e.sent).canContinue,h=p.abandonedInfo,f){e.next=19;break}return o.setLoading(!1),e.abrupt("return");case 19:if(y=oD(o.config.paymentConfig),m=rN("localization")||(null===(n=window.__PRELOAD_STATE__)||void 0===n||null===(r=n.request)||void 0===r||null===(a=r.cookie)||void 0===a?void 0:a.localization),o.isCheckout&&(m=null===(g=window.__PRELOAD_STATE__)||void 0===g||null===(b=g.tradeCheckout)||void 0===b||null===(C=b.marketInfo)||void 0===C?void 0:C.marketRegionCountryCode),h&&y&&m){e.next=25;break}return o.logger.error("跳转fc页面失败，跳转参数异常",{data:{abandonedInfo:h,domain:y,country:m},error:Error()}),e.abrupt("return");case 25:w=window.Shopline.storeId,O="".concat(y,"/checkouts/").concat(w,"/").concat(h.checkoutToken),_="?mark=".concat(h.mark,"&clientLang=").concat(window.Shopline.locale,"&country=").concat(m,"&domain=").concat(window.origin),S="".concat(O).concat(_),o.logger.info("跳转fc页面",{data:S}),window.location.href=S;case 31:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}));var t,o,c=e.buttonTypes;return o.logger=o.config.props.logger.pipeOwner("FastButton"),o.needRender=!c||c.includes(rt.Fast),o.isCheckout=o.config.paymentConfig.buttonLocation===re.Checkout,o}return l(r,[{key:"isButtonInViewPort",value:function(){if(!this.buttonElement)return!1;var e=window.innerWidth||document.documentElement.clientWidth,t=window.innerHeight||document.documentElement.clientHeight,n=this.buttonElement.getBoundingClientRect(),r=n.top,o=n.right,a=n.bottom,i=n.left;return r>=0&&i>=0&&o<=e&&a<=t}},{key:"createAnimateInterval",value:function(){this.timer=setInterval(this.addAnimateClass.bind(this),1e3)}},{key:"addAnimateClass",value:function(){var e,t=null===(e=this.buttonElement)||void 0===e?void 0:e.querySelector(".".concat(rr.SHOP_BY_FAST_CHECKOUT,"-group"));this.isButtonInViewPort()&&t&&(t.classList.add("shopby-button-slide"),this.timer&&window.clearInterval(this.timer))}}]),r}(),oM=l(function e(t){var n=this;i(this,e),d(this,"needRender",!0),d(this,"show",function(){var e;if(n.needRender){var t=n.config.props,r=t.layout,o=t.extraBuyNowDomId,a=rb(n.config.paymentConfig),i=rC(n.config.paymentConfig),c=a.includes(rn.SHOP_BY_FAST_CHECKOUT),s=a.includes(rn.BUY_NOW),u=1;i?u=c?2:1:c&&s?u=2:(c||s)&&(u=1),n.logger.info("渲染骨架屏",{data:u});var l='<div class="'.concat(rr.COMMON_ITEM," ").concat(rr.BUTTON_SKELETON,'"></div>');if(r===rf.BuyNowRow&&s&&o){var d=document.getElementById(o);null==d||d.insertAdjacentHTML("beforeend",l),u--}null===(e=n.container)||void 0===e||e.insertAdjacentHTML("beforeend",Array(u).fill('<div class="'.concat(rr.COMMON_ITEM," ").concat(rr.BUTTON_SKELETON,'"></div>')).join(""))}}),d(this,"hide",function(){var e;if(n.needRender){var t=n.config.props,r=t.layout,o=t.extraBuyNowDomId,a=null===(e=n.container)||void 0===e?void 0:e.querySelectorAll(".".concat(rr.BUTTON_SKELETON));if(null==a||a.forEach(function(e){e.remove()}),r===rf.BuyNowRow&&o){var i,c=document.getElementById(o);null==c||null===(i=c.querySelector(".".concat(rr.BUTTON_SKELETON)))||void 0===i||i.remove()}}}),this.config=t,this.logger=this.config.props.logger;var r=this.config,o=r.domId,a=r.paymentConfig.buttonLocation;this.container=document.getElementById(o),this.needRender=a!==re.Cart}),oF="pay-button-common-style-sheet-id",oU=function(e){var t,n,r,o,a=e.domId,i=e.props.layout,c=document.getElementById(a);c&&(c.dataset.payButtonLayout=i),function(){if(!document.getElementById(oF)){var e=document.createElement("style");e.setAttribute("id",oF),e.innerHTML="\n  /* ----- 骨架屏 ----- */\n  @keyframes skeleton {\n    0% {\n      background-position: 100% 50%;\n    }\n    100% {\n      background-position: 0 50%;\n    }\n  }\n  .".concat(rr.BUTTON_SKELETON," {\n    background: linear-gradient(\n      90deg,\n      hsla(0, 0%, 74.5%, 0.2) 25%,\n      hsla(0, 0%, 50.6%, 0.24) 37%,\n      hsla(0, 0%, 74.5%, 0.2) 63%\n    );\n    background-size: 400% 100%;\n    animation: skeleton 2s linear infinite;\n  }\n\n  /* ----- 按钮loading ----- */\n  @keyframes rotate {\n    from {\n      transform: rotate(0deg);\n    }\n    to {\n      transform: rotate(359deg);\n    }\n  }\n  .").concat(rr.BUTTON_LOADING," .loading-icon {\n    display: inline-block;\n    position: absolute;\n    border: 2px solid white;\n    top: calc(50% - 8px);\n    left: calc(50% - 8px);\n    width: 16px;\n    height: 16px;\n    border-radius: 16px;\n    clip-path: polygon(0% 0%, 100% 0%, 100% 70%, 0% 70%);\n    animation: rotate 1s linear infinite;\n  }\n  \n  /* ----- 按钮遮罩 ----- */\n  .").concat(rr.BUTTON_MASK," {\n    cursor: pointer;\n    position: absolute;\n    left: 0;\n    top: 0;\n    height: 100%;\n    width: 100%;\n    z-index: 101;\n  }\n\n  /* ----- 按钮公共 ----- */\n  .").concat(rr.BUTTON_HIDE," {\n    display: none !important;\n  }\n  .").concat(rr.COMMON_ITEM," {\n    position: relative;\n    overflow: hidden;\n  }\n\n  /* ----- buy now ----- */\n  .").concat(rr.BUY_NOW," {\n    line-height: 1;\n  }\n  .").concat(rr.BUY_NOW,".").concat(rr.BUTTON_LOADING," .").concat(rr.BUY_NOW,"-text{\n      opacity: 0;\n  }\n\n  /* ----- more options ----- */\n  .").concat(rr.MORE_OPTIONS," {\n    color: #000000;\n    cursor: pointer;\n    font-family: Helvetica Neue;\n    font-size: 14px;\n    font-weight: 500;\n    margin-top: 15px;\n    text-align: center;\n    text-decoration: underline;\n  }\n\n  /* ----- paypal ----- */\n  .").concat(rr.PAY_PAL," {\n    line-height: 0;\n  }\n  .").concat(rr.PAY_PAL," .").concat(rr.PAY_PAL_BG_BEFORE,",\n  .").concat(rr.PAY_PAL," .").concat(rr.PAY_PAL_BG_AFTER," {\n    position: absolute;\n    left: 0;\n    width: 100%;\n    height: calc(50% - 6px);\n    background-color: #ffc439;\n    opacity: 0;\n  }\n  .").concat(rr.PAY_PAL," .").concat(rr.PAY_PAL_BG_BEFORE," {\n    top: 0;\n  }\n  .").concat(rr.PAY_PAL," .").concat(rr.PAY_PAL_BG_AFTER," {\n    bottom: 0;\n  }\n\n  /* ----- shop by ----- */\n  @keyframes shopby-button-slide {\n    0% {\n      transform: translateX(50%);\n    }\n    25% {\n      transform: translateX(0%);\n    }\n    80% {\n      transform: translateX(0%);\n    }\n    100% {\n      transform: translateX(-50%);\n    }\n  }\n  .shopby-button-slide {\n    animation: shopby-button-slide 1.5s;\n    animation-fill-mode: forwards;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT," {\n    background-color: #60F5B2;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT,".").concat(rr.BUTTON_DISABLED," {\n    cursor: not-allowed;\n    opacity: .3;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT,".").concat(rr.BUTTON_DISABLED," button {\n    cursor: not-allowed;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT," .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-group {\n    height: 100%;\n    width: 200%;\n    display: flex;\n    transform: translateX(50%);\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT,".checkout .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-group {\n    width: 100%;\n    height: 100%;\n    transform: none;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT," .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-group .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-item {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex: 1;\n    font-family: PingFang SC;\n    background-color: #60f5b2;\n    border: none;\n    cursor: pointer;\n    color: #052855;\n    margin: 0;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT," .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-group .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-item:hover {\n    background-color: #60e1b2;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT," .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-group .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-item:active, .").concat(rr.SHOP_BY_FAST_CHECKOUT," .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-group .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-item:focus {\n    background-color: #60ffb2;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT," .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-group .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-item svg {\n    margin-right: 6px;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT," .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-group .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-item span {\n    font-style: normal;\n    font-weight: 600;\n    line-height: normal;\n    letter-spacing: -0.02em;\n    font-size: 16px;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT," .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-group .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-securey {\n    background: #3dee9f;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT," .").concat(rr.SHOP_BY_FAST_CHECKOUT,"-group ").concat(rr.SHOP_BY_FAST_CHECKOUT,"-securey span {\n    font-weight: 600;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT,".").concat(rr.BUTTON_LOADING," {\n    opacity: 0.3;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT,".").concat(rr.BUTTON_LOADING," .loading-icon {\n    border-color: #052855;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT,".").concat(rr.BUTTON_LOADING," > div {\n    visibility: hidden;\n  }\n\n  /* ----- 布局 ----- */\n  .").concat(rr.BUY_NOW," {\n    order: 1;\n  }\n  .").concat(rr.PAY_PAL," {\n    order: 2;\n  }\n  .").concat(rr.GOOGLE_PAY," {\n    order: 3;\n  }\n  .").concat(rr.APPLE_PAY," {\n    order: 4;\n  }\n  .").concat(rr.SHOP_BY_FAST_CHECKOUT," {\n    order: 5;\n  }\n  .").concat(rr.MORE_OPTIONS,' {\n    order: 6;\n  }\n  [data-pay-button-layout="').concat(rf.Column,'"],\n  [data-pay-button-layout="').concat(rf.BuyNowRow,'"] {\n    display: flex;\n    flex-direction: column;\n    margin: -5px 0;\n  }\n  [data-pay-button-layout="').concat(rf.Column,'"] .').concat(rr.COMMON_ITEM,',\n  [data-pay-button-layout="').concat(rf.BuyNowRow,'"] .').concat(rr.COMMON_ITEM,' {\n    margin: 5px 0;\n    flex-shrink: 0;\n    flex-grow: 0;\n  }\n  [data-pay-button-layout="').concat(rf.Row,'"] {\n    display: flex;\n  }\n  [data-pay-button-layout="').concat(rf.Row,'"] > .').concat(rr.COMMON_ITEM,' {\n    margin-top: 0;\n    margin-right: 12px;\n  }\n  [data-pay-button-layout="').concat(rf.Checkout,'"] {\n    display: flex;\n    flex-wrap: wrap;\n    margin: -7px -6px;\n  }\n  [data-pay-button-layout="').concat(rf.Checkout,'"] .').concat(rr.COMMON_ITEM,' {\n    margin: 7px 6px;\n  }\n  [data-pay-button-layout="').concat(rf.Checkout,'"] .').concat(rr.COMMON_ITEM,":not(.").concat(rr.PAY_PAL,") {\n    flex-basis: 1px;\n    flex-grow: 1;\n    padding: 0;\n  }\n  "),document.body.appendChild(e)}}(),t=e.domId,n=e.props.extraBuyNowDomId,r=document.getElementById(t),(o=document.createElement("style")).innerHTML="\n  /* ----- 按钮公共 ----- */\n  #".concat(t," .").concat(rr.COMMON_ITEM," ").concat(n?",#".concat(n," .").concat(rr.COMMON_ITEM):""," {\n    height: ").concat(e.props.style.height,"px;\n    width: ").concat(e.props.style.width?"".concat(e.props.style.width,"px"):"100%",";\n    border-radius: ").concat(e.props.style["border-radius"],"px;\n  }\n\n  /* ----- paypal ----- */\n  #").concat(t," .").concat(rr.PAY_PAL," {\n    min-height: ").concat(e.props.style.height,"px;\n    height: auto;\n    border-radius: 0px;\n    z-index: 1;\n  }\n  "),null==r||r.appendChild(o)},oH=function(){function e(t){i(this,e),d(this,"renderedButtonCount",0),this.config=t,this.container=this.getContainer(),this.logger=t.props.logger.pipeOwner("Collapse")}return l(e,[{key:"getContainer",value:function(){if(!this.container){var e=document.getElementById(this.config.domId);if(!e)throw Error("Please check if the DOM node in the configuration is valid.");this.container=e}return this.container}},{key:"init",value:function(e){var t=this.config,n=t.displayButtonCount,r=t.props,o=r.layout,a=r.extraBuyNowDomId;if(!rC(t.paymentConfig)){this.renderedButtonCount=e;var i=o===rf.BuyNowRow&&a;if(i&&(this.renderedButtonCount=e-1),n)return this.renderedButtonCount>(i?1:2)&&this.renderedButtonCount>n?(this.addContainerAnimation(n),void this.createCollapseButton(n)):void 0}}},{key:"update",value:function(e){e!==this.renderedButtonCount&&(this.logger.info("update",{data:{renderedButtonCount:e}}),this.remove(),this.computedStyleCache=null,this.init(e))}},{key:"remove",value:function(){this.config.displayButtonCount&&(this.container.classList.add("remove"),this.removeCollapseButton())}},{key:"addContainerAnimation",value:function(e){var t=this.config.domId,n=this.computeStyle(e).collapseHeight;this.container.classList.remove("remove");var r=rM("\n      #".concat(t," {\n        height: ").concat(n,"px;\n        overflow: hidden;\n        transition: height 0.3s ease;\n      }\n\n      #").concat(t,".remove {\n        height: auto;\n      }\n    ")),o=r.style,a=r.cssInsertBefore;this.container.contains(o)||a(this.container)}},{key:"createCollapseButton",value:function(e){if(!this.collapseButton){var t=t7(),n=this.container,r=n.parentNode;r||this.logger.log("Cannot find the parent node, affecting the mounting of the collapse button",{data:{container:n}});var o=this.computeStyle(e),a=o.buttonHeight,i=o.containerHeight,c=o.collapseHeight;o.buttonMargin;var s=document.createElement("button");s.id="more-payment-".concat(rj(),"-button"),s.className=rr.BUTTON_COLLAPSE,s.innerHTML="".concat(t("sdk.button.show")).concat('<svg id="arrowIcon" class="flip-vertical" width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0.899486 3.44971L4.94974 7.49996L9 3.44971" stroke="#29252C" stroke-width="1.5" stroke-linecap="round"/></svg>');var u=rM("\n      #".concat(s.id," {\n        height: ").concat(a,"px;\n        min-height: ").concat(a,"px;\n        width: 100%;\n        text-align: center;\n        background: transparent;\n        line-height: ").concat(a,"px;\n        margin-bottom: 0;\n        border: none;\n        font-weight: 500;\n        font-size: 14px;\n        color: #29252C;\n      }\n\n      #").concat(s.id,":active {\n        -webkit-tap-highlight-color: transparent;\n        -webkit-tap-highlight-color: rgba(0,0,0,0);\n      }\n\n      #").concat(s.id," svg {\n        margin-left: 10px;\n      }\n\n      #").concat(s.id," svg.flip-vertical {\n        transform: scaleY(-1);\n      }\n    ")),l=u.style,d=u.cssInsertBefore;null==r||r.insertBefore(s,n.nextSibling),d(s);var p=null==r?void 0:r.querySelector("#arrowIcon");s.addEventListener("click",function(){if(1>=Math.abs(Number.parseInt(n.style.height)-i))return n.style.height="".concat(c,"px"),void(null==p||p.classList.add("flip-vertical"));n.style.height="".concat(i,"px"),null==p||p.classList.remove("flip-vertical")}),l.id="collapse-button-style",this.collapseButton=s}}},{key:"removeCollapseButton",value:function(){var e,t;null===(e=this.collapseButton)||void 0===e||e.remove(),this.collapseButton=null,null===(t=this.container.querySelector("#collapse-button-style"))||void 0===t||t.remove()}},{key:"computeStyle",value:function(e){if(this.computedStyleCache)return this.logger.info("computeStyle cache",{data:{style:this.computedStyleCache}}),this.computedStyleCache;var t=this.config.props.style,n=this.container.querySelectorAll(".".concat(rr.COMMON_ITEM)),r=n[n.length-1];r||this.logger.warn("Unable to calculate container height accurately, will return offsetHeight.",{data:{container:this.container}});var o=(null==r?void 0:r.offsetHeight)||t.height,a=r?2*parseInt(window.getComputedStyle(r).marginTop):this.container.offsetHeight,i=(o+a)*this.renderedButtonCount,c={buttonHeight:o,containerHeight:i,buttonMargin:a,collapseHeight:i-(o+a)*(this.renderedButtonCount-e)};return this.computedStyleCache=c,this.logger.info("computeStyle",{data:{style:c}}),c}}]),e}(),oY=function(){var e;function t(){i(this,t),d(this,"queue",[]),d(this,"running",!1)}return l(t,[{key:"enqueue",value:function(e,t){this.queue.push(e),this.running||this.run(t)}},{key:"run",value:(e=a(v.mark(function e(t){var n;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.running=!0;case 1:if(!(this.queue.length>0)){e.next=9;break}if(n=this.queue.shift(),e.t0=n,!e.t0){e.next=7;break}return e.next=7,n();case 7:e.next=1;break;case 9:null==t||t(),this.running=!1;case 11:case"end":return e.stop()}},e,this)})),function(t){return e.apply(this,arguments)})}]),t}();function oV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function oq(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oV(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oV(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var oG=function(){function e(t){var o,c,s,u,l,p=this;i(this,e),d(this,"renderPromise",null),d(this,"rerenderAsyncQueue",new oY),d(this,"isVisible",!0),d(this,"render",a(v.mark(function e(){var t,n;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(p.logger.info("支付按钮渲染"),t=p.config.domId,p.container){e.next=5;break}return p.logger.error("pay button can not find container",{data:p.container}),e.abrupt("return");case 5:if("true"!==p.container.dataset.rendered){e.next=8;break}return p.logger.warn("同一容器重复渲染支付按钮",{data:t}),e.abrupt("return");case 8:return p.container.dataset.rendered="true",n=function(){var e=a(v.mark(function e(){var t;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne(window.Shopline.locale||"en");case 2:return oU(p.config),p.isVisible&&p.skeleton.show(),t=!0,e.next=7,p.expressButton.render().catch(function(e){p.logger.error("快捷支付按钮渲染失败",{error:e}),t=!1});case 7:return e.next=9,p.fastButton.render().catch(function(e){p.logger.error("快速结账按钮渲染失败",{error:e})});case 9:if(t){e.next=14;break}return e.next=12,p.normalButton.render(rn.BUY_NOW).catch(function(e){p.logger.error("普通支付按钮渲染失败",{error:e})});case 12:e.next=16;break;case 14:return e.next=16,p.normalButton.render().catch(function(e){p.logger.error("普通支付按钮渲染失败",{error:e})});case 16:p.collapse.init(p.getRenderedButtons().length),p.injectRenderedButtonsToContainer(),p.skeleton.hide(),p.isVisible&&p.setVisible(!0),p.logger.info("隐藏骨架屏，显示支付按钮");case 21:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),p.renderPromise=n(),e.next=13,p.renderPromise;case 13:case"end":return e.stop()}},e)}))),d(this,"rerender",(o=a(v.mark(function e(t,n){var r;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p.logger.info("rerender",{data:{paymentConfig:t}}),e.next=3,p.renderPromise;case 3:r=function(){var e=a(v.mark(function e(){return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.expressButton.rerender(t);case 2:p.injectRenderedButtonsToContainer();case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),p.rerenderAsyncQueue.enqueue(r,null==n?void 0:n.afterRerender);case 5:case"end":return e.stop()}},e)})),function(e,t){return o.apply(this,arguments)})),d(this,"setDisabled",(c=a(v.mark(function e(t,n){return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p.logger.info("setDisabled",{data:{value:t,options:n}}),e.next=3,p.renderPromise;case 3:p.normalButton.setDisabled(t,n),p.expressButton.setDisabled(t),p.fastButton.setDisabled(t,n);case 6:case"end":return e.stop()}},e)})),function(e,t){return c.apply(this,arguments)})),d(this,"setVisible",(s=a(v.mark(function e(t,n){return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p.logger.info("setVisible",{data:{value:t,options:n}}),p.isVisible=t,e.next=4,p.renderPromise;case 4:p.expressButton.setVisible(t),p.normalButton.setVisible(t),p.fastButton.setVisible(t),t&&p.reportButtonView(),p.collapse.update(p.getRenderedButtons().length),p.injectRenderedButtonsToContainer();case 10:case"end":return e.stop()}},e)})),function(e,t){return s.apply(this,arguments)})),d(this,"setSubscription",(u=a(v.mark(function e(t){return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p.logger.info("setSubscription",{data:{value:t}}),e.next=3,p.renderPromise;case 3:p.expressButton.setSubscription(t),p.normalButton.setSubscription(t),p.collapse.update(p.getRenderedButtons().length),p.injectRenderedButtonsToContainer();case 7:case"end":return e.stop()}},e)})),function(e){return u.apply(this,arguments)})),d(this,"customButtons",(l=a(v.mark(function e(t){var o,a,i,c,s,u,l,d,f;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p.logger.log("自定义支付按钮customButtons",{data:oq({},t)}),e.next=3,p.renderPromise;case 3:o=0,a=Object.entries(t);case 4:if(!(o<a.length)){e.next=15;break}if(s=(c=r(a[o],2))[0],l=(u=c[1]).className,d=null===(i=p.container)||void 0===i?void 0:i.querySelector(".".concat(rr[s])),![rn.BUY_NOW,rn.MORE_OPTIONS].includes(s)){e.next=11;break}return p.normalButton.customButton(s,u),e.abrupt("continue",12);case 11:l&&d&&(f=d.classList).add.apply(f,n(l.split(" ")));case 12:o++,e.next=4;break;case 15:case"end":return e.stop()}},e)})),function(e){return l.apply(this,arguments)})),d(this,"getButtonElement",function(e){var t,n=rr[e];return null===(t=p.container)||void 0===t?void 0:t.querySelectorAll(".".concat(n))}),d(this,"preProcessConfig",function(e){var t,n=e.props.style,r=ro.height;"number"==typeof(null==n?void 0:n.height)&&(r=n.height<40?40:n.height>55?55:n.height);var o="number"==typeof(null==n?void 0:n.width)?n.width:ro.width,a="number"==typeof(null==n?void 0:n["border-radius"])?n["border-radius"]:ro["border-radius"];return oq(oq({},e),{},{props:oq(oq({},e.props),{},{isVisible:!1!==e.props.isVisible,layout:null!==(t=e.props.layout)&&void 0!==t?t:rf.Column,logger:e.props.logger.pipeOwner("@sl/pay-button"),style:{width:o,height:r,"border-radius":a}})})}),d(this,"reportedButtonViewList",[]),d(this,"reportButtonView",function(){var e,t=p.config.paymentConfig.buttonLocation,n=null===(e=p.container)||void 0===e?void 0:e.querySelectorAll(".".concat(rr.COMMON_ITEM,", .").concat(rr.MORE_OPTIONS));null==n||n.forEach(function(e){var n=e.className.includes(rr.BUY_NOW)?rn.BUY_NOW:e.className.includes(rr.MORE_OPTIONS)?rn.MORE_OPTIONS:e.className.includes(rr.PAY_PAL)?rn.PAY_PAL:e.className.includes(rr.GOOGLE_PAY)?rn.GOOGLE_PAY:e.className.includes(rr.APPLE_PAY)?rn.APPLE_PAY:e.className.includes(rr.SHOP_BY_FAST_CHECKOUT)?rn.SHOP_BY_FAST_CHECKOUT:void 0;rR(e)||!n||p.reportedButtonViewList.includes(n)||(p.reportedButtonViewList.push(n),rx.reportPayButtonView(n,t))})});var f=this.preProcessConfig(t),h=f.domId,y=f.props.isVisible;this.config=f,this.container=document.getElementById(h),this.logger=f.props.logger.pipeOwner("PayButton"),this.logger.info("支付按钮实例化参数",{data:oq({},t)}),this.isVisible=y,this.skeleton=new oM(f),this.normalButton=new rH(f),this.expressButton=new oL(f),this.fastButton=new oR(f),this.collapse=new oH(f)}return l(e,[{key:"getRenderedButtons",value:function(){var e=[].concat(n(this.expressButton.getRenderedList()),n(this.normalButton.getRenderedList()),n(this.fastButton.getRenderedList()));return this.config.paymentConfig.buttonLocation===re.Cart&&e.push(rn.CHECKOUT),e}},{key:"injectRenderedButtonsToContainer",value:function(){var e;null===(e=this.container)||void 0===e||e.setAttribute("data-inject-rendered-buttons",this.getRenderedButtons().join(","))}}]),e}();function oW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function oz(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oW(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oW(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var oK,o$,oJ,oZ,oX={skipNull:!0,skipEmptyString:!0},oQ={SignIn:(o$="/user/signIn",window.Shopline&&window.Shopline.redirectTo&&window.Shopline.redirectTo(o$)||o$),Checkout:"/trade/checkout",Checkouts:"/checkouts"},o1=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.query,r=t.fragmentIdentifier,o=t.fullQuery,a=r5.parseUrl(window.location.href,oz(oz({},oX),{},{parseFragmentIdentifier:!0})),i=void 0===o||o?oz(oz({},a.query||{}),n||{}):oz({},n),c=r5.stringifyUrl({url:e,query:i,fragmentIdentifier:r||a.fragmentIdentifier},oX),s="".concat(window.location.protocol,"//").concat(window.location.host).concat(c);return oz(oz({originUrl:e},a),{},{query:i,url:c,wholeUrl:s})};(p=oJ||(oJ={})).AMOUNT_EXCEEDS_LIMIT="TCTDEXCEEDED_MAX_AMOUNT_LIMIT",p.ABANDONED_RISK_CONTROL="TRD_123768_B1409",(f=oZ||(oZ={})).PRODUCT_VERIFY="product_verify",f.SAVE_ORDER="save_order";var o0=function(){var e;return window.Shopline.themeTypeVersion>=2.1?window.__tradeSettleConfig__:null===(e=window.__PRELOAD_STATE__)||void 0===e?void 0:e.tradeSettleConfig};function o2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o3(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o2(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o2(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var o4=t7(),o5=function(e,t){var n=t.logger,r=t.query,o=t.associateCart,a=o0(),i=(null==a?void 0:a.loginType)||"",c=!!rN("osudb_uid"),s="ONLY_LOGIN"===i,u=!c&&s;null==n||n.info("checkout/save 登录状态",{data:{isLogin:c,needLogin:s,redirectToSignIn:u}});var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.query,r=t.associateCart,o=t.abandonedOrderMark,a="".concat(window.location.protocol,"//").concat(window.location.host),i=e.storeId,c=e.checkoutToken,s=e.seq;return o1(c?"".concat(a,"/").concat(i).concat(oQ.Checkouts,"/").concat(c):"".concat(a).concat(oQ.Checkout,"/").concat(s),{query:oz(oz({buyScence:r?"cart":"detail"},void 0===n?{}:n),{},{mark:void 0===o?"":o}),fullQuery:!1}).url}({storeId:window.Shopline.storeId,checkoutToken:e.checkoutToken,seq:e.seq},{query:o3(o3({},r),{},{spb:u?null:null==r?void 0:r.spb}),associateCart:o});if(u){var d="".concat(window.location.protocol,"//").concat(window.location.host),p=o1("".concat(d).concat(oQ.SignIn),{query:{redirectUrl:l},fullQuery:!1}).url;return null==n||n.info("checkout/save 需要登录",{data:{url:p,abandonedInfo:e,needLogin:!0}}),{url:p,abandonedInfo:e,needLogin:!0}}return null==n||n.info("checkout/save 正常返回",{data:{url:l,abandonedInfo:e,needLogin:!1}}),{url:l,abandonedInfo:e,needLogin:!1}},o6=function(e,t){var n=t.logger,r=t.toast,o=e||{},a=o.code,i=o.statusCode,c=o.message,s=null!=a?a:i;switch(null==n||n.error("[成单请求报错]".concat(void 0!==s?"[code: ".concat(s):"").concat(c?"[msg: ".concat(c,"]"):""),{error:e,data:{extra:t,from:"STANDARD_BUTTON"}}),a){case oJ.AMOUNT_EXCEEDS_LIMIT:r(o4("cart.checkout.max_amount_limit"));break;case oJ.ABANDONED_RISK_CONTROL:r(o4("general.abandon.Order.risk"));break;default:r(o4("cart.error.order"))}return Promise.resolve({errorType:oZ.SAVE_ORDER})},o9=(h=a(v.mark(function e(t){var n,r,o,a,i,c,s,u,l,d;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.products,o=void 0!==(r=t.associateCart)&&r,a=t.discountCodes,i=t.useMemberPoint,t.query,t.toast,c=t.logger,u=void 0!==(s=t.notSupportSubscriptionCheck)&&s,e.prev=1,l=[],"function"!=typeof n){e.next=9;break}return e.next=6,n();case 6:l=e.sent,e.next=10;break;case 9:l=n;case 10:if(l){e.next=13;break}return null==c||c.log("业务方传入商品非法",{data:{products:l,getProducts:n}}),e.abrupt("return",Promise.resolve({errorType:oZ.PRODUCT_VERIFY}));case 13:return null==c||c.info("checkout/save 保存弃单",{data:{products:l,associateCart:o,discountCodes:a}}),e.next=16,of({products:l,associateCart:o,discountCodes:a,useMemberPoint:i,notSupportSubscriptionCheck:u});case 16:return d=e.sent,null==c||c.info("checkout/save 保存弃单返回值",{data:d}),e.abrupt("return",o5(d,t));case 21:return e.prev=21,e.t0=e.catch(1),e.abrupt("return",o6(e.t0,t));case 24:case"end":return e.stop()}},e,null,[[1,21]])})),function(e){return h.apply(this,arguments)});a(v.mark(function e(t){var n,r,o,a;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.logger,o=void 0!==(r=t.notSupportSubscriptionCheck)&&r,e.next=4,oh({notSupportSubscriptionCheck:o});case 4:return a=e.sent,null==n||n.info("cart save abandoned order response",{data:o3({},a)}),e.abrupt("return",o5(a,t));case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",o6(e.t0,t));case 12:case"end":return e.stop()}},e,null,[[0,9]])})),window["@sl/pay-button"]={SmartPayment:rz,PayMode:er,Paypal:nZ,mergeParams:eX,getClientInfo:n3,ChannelCode:eo,SystemCode:ei,save:o9,checkoutHiidoReportV2:rx,default:oG}}();
